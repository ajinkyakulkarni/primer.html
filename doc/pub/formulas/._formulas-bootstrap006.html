<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Computing with formulas">
<meta name="keywords" content="directory,run Python program,execute Python program,terminal window,console (terminal) window,directory,comments,non-English characters,formatting text and numbers,printf syntax,string,triple-quoted strings,format string syntax,newline character (line break),line break,source code,application,statements,expression,syntax,whitespace,blanks,whitespace,input (data),output (data),user (of a program),operating system (OS),Windows,Mac OS X,Unix,Linux,objects,round-off errors,interactive sessions standard Python shell,type conversion,check an object's type,rounding float to integer,interactive sessions IPython,IPython,run Python program,execute Python program,IPython running Python programs,IPython start-up file,IPython executing operating system commands,IPython command history,complex numbers,Gaussian function">

<title>Computing with formulas</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>

</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(u' The first programming encounter: a formula ',
               1,
               u'sec:formula:1',
               u'sec:formula:1'),
              (u' Using a program as a calculator ',
               2,
               u'sec:formula:1st',
               u'sec:formula:1st'),
              (u' About programs and programming ', 2, None, '___sec2'),
              (u' Tools for writing programs ', 2, None, '___sec3'),
              (u' Writing and running your first Python program ',
               2,
               None,
               '___sec4'),
              (u' Warning about typing program text ', 2, None, '___sec5'),
              (u' Verifying the result ', 2, None, '___sec6'),
              (u' Using variables ',
               2,
               u'sec:formula:variables',
               u'sec:formula:variables'),
              (u' Names of variables ', 2, None, '___sec8'),
              (u' Reserved words in Python ',
               2,
               u'sec:formula:keywords',
               u'sec:formula:keywords'),
              (u' Comments ', 2, None, '___sec10'),
              (u' Remark ', 3, None, '___sec11'),
              (u' Formatting text and numbers ',
               2,
               u'sec:formula:format',
               u'sec:formula:format'),
              (u' Printf syntax ', 3, None, '___sec13'),
              (u' Format string syntax ', 3, None, '___sec14'),
              (u' The newline character ', 3, None, '___sec15'),
              (u' Computer science glossary ',
               1,
               u'sec:formula:glossary',
               u'sec:formula:glossary'),
              (u' Another formula: Celsius-Fahrenheit conversion ',
               1,
               u'sec:formula:c2f',
               u'sec:formula:c2f'),
              (u' Potential error: integer division ',
               2,
               u'sec:formula:intdiv',
               u'sec:formula:intdiv'),
              (u' Straightforward coding of the formula ',
               3,
               None,
               '___sec19'),
              (u' Verifying the results ', 3, None, '___sec20'),
              (u' Float and integer division ', 3, None, '___sec21'),
              (u' Objects in Python ', 2, None, '___sec22'),
              (u' Avoiding integer division ',
               2,
               u'sec:formula:c2f:correct',
               u'sec:formula:c2f:correct'),
              (u' Locating potential integer division ', 3, None, '___sec24'),
              (u' Remark ', 3, None, '___sec25'),
              (u' Arithmetic operators and precedence ',
               2,
               u'sec:formula:operators',
               u'sec:formula:operators'),
              (u' Evaluating standard mathematical functions ',
               1,
               u'sec:formula:stdmath',
               u'sec:formula:stdmath'),
              (u' Example: Using the square root function ',
               2,
               u'sec:formula:sqrt',
               u'sec:formula:sqrt'),
              (u' Problem ', 3, None, '___sec29'),
              (u' The program ', 3, None, '___sec30'),
              (u' Two ways of importing a module ', 3, None, '___sec31'),
              (u' Import with new names ', 3, None, '___sec32'),
              (u' Example: Computing with $\\sinh x$ ', 2, None, '___sec33'),
              (u' A first glimpse of round-off errors ',
               2,
               u'sec:formula:roundoff',
               u'sec:formula:roundoff'),
              (u' Interactive computing ',
               1,
               u'sec:formula:pyshell',
               u'sec:formula:pyshell'),
              (u' Using the Python shell ', 2, None, '___sec36'),
              (u' Type conversion ',
               2,
               u'sec:formulas:typeconversion',
               u'sec:formulas:typeconversion'),
              (u' IPython ',
               2,
               u'sec:formula:ipython',
               u'sec:formula:ipython'),
              (u' Running programs ', 3, None, '___sec39'),
              (u' Quick recovery of previous output ', 3, None, '___sec40'),
              (u' Tab completion ', 3, None, '___sec41'),
              (u' Recovering previous commands ', 3, None, '___sec42'),
              (u' Running Unix/Windows commands ', 3, None, '___sec43'),
              (u' Notebooks ', 3, None, '___sec44'),
              (u' Complex numbers ',
               1,
               u'sec:formula:complex',
               u'sec:formula:complex'),
              (u' Complex arithmetics in Python ', 2, None, '___sec46'),
              (u' Complex functions in Python ', 2, None, '___sec47'),
              (u' Unified treatment of complex and real functions ',
               2,
               u'formulas:unified:complex:real',
               u'formulas:unified:complex:real'),
              (u' Symbolic computing ',
               1,
               u'sec:formula:sympy',
               u'sec:formula:sympy'),
              (u' Basic differentiation and integration ',
               2,
               u'sec:formula:sympy:diffint',
               u'sec:formula:sympy:diffint'),
              (u' Equation solving and Taylor series ', 2, None, '___sec51'),
              (u' Summary ',
               1,
               u'sec:formula:summary',
               u'sec:formula:summary'),
              (u' Chapter topics ', 2, None, '___sec53'),
              (u' Programs must be accurate! ', 3, None, '___sec54'),
              (u' Variables ', 3, None, '___sec55'),
              (u' Comment lines ', 3, None, '___sec56'),
              (u' Object types ', 3, None, '___sec57'),
              (u' Operators ', 3, None, '___sec58'),
              (u' Common mathematical functions ', 3, None, '___sec59'),
              (u' Print ', 3, None, '___sec60'),
              (u' Complex numbers ', 3, None, '___sec61'),
              (u' Terminology ', 3, None, '___sec62'),
              (u' Example: Trajectory of a ball ', 2, None, '___sec63'),
              (u' Problem ', 3, None, '___sec64'),
              (u' Solution ', 3, None, '___sec65'),
              (u' About typesetting conventions in this book ',
               2,
               None,
               '___sec66'),
              (u' Style guide for Python code ', 3, None, '___sec67'),
              (u' Exercises ', 1, u'sec:formula:exer', u'sec:formula:exer'),
              (u' What does it mean to solve an exercise? ',
               3,
               None,
               '___sec69'),
              (u' Exercise 1: Compute 1+1 ',
               2,
               u'sec:formula:ex0',
               u'sec:formula:ex0'),
              (u' Exercise 2: Write a Hello World program ',
               2,
               u'sec:formula:ex5',
               u'sec:formula:ex5'),
              (u' Exercise 3: Derive and compute a formula ',
               2,
               u'sec:formula:ex16',
               u'sec:formula:ex16'),
              (u' Exercise 4: Convert from meters to British length units ',
               2,
               u'sec:formula:ex9',
               u'sec:formula:ex9'),
              (u' Exercise 5: Compute the mass of various substances ',
               2,
               u'sec:formula:exex3',
               u'sec:formula:exex3'),
              (u' Exercise 6: Compute the growth of money in a bank ',
               2,
               u'sec:formula:ex3',
               u'sec:formula:ex3'),
              (u' Exercise 7: Find error(s) in a program ',
               2,
               u'sec:formula:ex12',
               u'sec:formula:ex12'),
              (u' Exercise 8: Type in program text ',
               2,
               u'sec:formula:exex1',
               u'sec:formula:exex1'),
              (u' Exercise 9: Type in programs and debug them ',
               2,
               u'sec:formula:exex2a',
               u'sec:formula:exex2a'),
              (u' Exercise 10: Evaluate a Gaussian function ',
               2,
               u'sec:formula:ex7',
               u'sec:formula:ex7'),
              (u' Remarks ', 3, None, '___sec80'),
              (u' Exercise 11: Compute the air resistance on a football ',
               2,
               u'sec:formula:ex11',
               u'sec:formula:ex11'),
              (u' Exercise 12: How to cook the perfect egg ',
               2,
               u'sec:formula:ex14',
               u'sec:formula:ex14'),
              (u' Exercise 13: Derive the trajectory of a ball ',
               2,
               u'sec:formula:ex13',
               u'sec:formula:ex13'),
              (u' Exercise 14: Find errors in the coding of formulas ',
               2,
               u'sec:formula:ex1',
               u'sec:formula:ex1'),
              (u' Exercise 15: Explain why a program does not work ',
               2,
               u'sec:formula:ex15',
               u'sec:formula:ex15'),
              (u' Exercise 16: Find errors in Python statements ',
               2,
               u'sec:formula:ex2',
               u'sec:formula:ex2'),
              (u' Exercise 17: Find errors in the coding of a formula ',
               2,
               u'sec:formula:ex4',
               u'sec:formula:ex4'),
              (u' References ', 1, None, '___sec88')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="formulas-bootstrap.html">Computing with formulas</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap001.html#sec:formula:1" style="font-size: 80%;">The first programming encounter: a formula</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap002.html#sec:formula:glossary" style="font-size: 80%;">Computer science glossary</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap003.html#sec:formula:c2f" style="font-size: 80%;">Another formula: Celsius-Fahrenheit conversion</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap004.html#sec:formula:stdmath" style="font-size: 80%;">Evaluating standard mathematical functions</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap005.html#sec:formula:pyshell" style="font-size: 80%;">Interactive computing</a></li>
     <!-- navigation toc: --> <li><a href="#sec:formula:complex" style="font-size: 80%;">Complex numbers</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap007.html#sec:formula:sympy" style="font-size: 80%;">Symbolic computing</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap008.html#sec:formula:summary" style="font-size: 80%;">Summary</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap009.html#sec:formula:exer" style="font-size: 80%;">Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._formulas-bootstrap009.html#___sec88" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0006"></a>
<!-- !split -->

<h1 id="sec:formula:complex">Complex numbers<a name="sec:formula:complex"></a></h1>

Suppose \( x^2=2 \). Then most of us are able to find out that
\( x=\sqrt{2} \) is a solution to the equation. The more mathematically
interested reader will also remark that \( x=-\sqrt{2} \) is another
solution.  But faced with the equation \( x^2=-2 \), very few are able to
find a proper solution without any previous knowledge of <em>complex
numbers</em>.  Such numbers have many applications in science, and it is
therefore important to be able to use such numbers in our programs.

<p>
On the following pages we extend the previous material on computing
with real numbers to complex numbers. The text is optional, and
readers without knowledge of complex numbers can safely drop this
section and jump to the section <a href="._formulas-bootstrap008.html#sec:formula:summary">Summary</a>.

<p>
A complex number is a pair of real numbers \( a \) and \( b \), most often
written as \( a+bi \), or \( a+ib \), where \( i \) is called the imaginary unit
and acts as a label for the second term.  Mathematically,
\( i=\sqrt{-1} \).  An important feature of complex numbers is definitely
the ability to compute square roots of negative numbers.  For example,
\( \sqrt{-2}=\sqrt{2}i \) (i.e., \( \sqrt{2}\sqrt{-1} \)).  The solutions of
\( x^2=-2 \) are thus \( x_1=+\sqrt{2}i \) and \( x_2=-\sqrt{2}i \).

<p>
There are rules for addition, subtraction, multiplication, and
division between two complex numbers. There are also rules for raising
a complex number to a real power, as well as rules for computing \( \sin
z \), \( \cos z \), \( \tan z \), \( e^z \), \( \ln z \), \( \sinh z \), \( \cosh z \), \( \tanh
z \), etc. for a complex number \( z = a+ib \).  We assume in the following
that you are familiar with the mathematics of complex numbers, at
least to the degree encountered in the program examples.

$$
\begin{equation*} \hbox{let } u=a+bi\hbox{ and }v=c+di\end{equation*}
$$


<p>
The following rules reflect complex arithmetics:

$$
\begin{align*}
u &= v\quad\Rightarrow\quad a=c, \ b=d\\ 
-u &= -a -bi\\ 
u^* &\equiv a - bi\quad\hbox{(complex conjugate)}\\ 
u+ v &= (a+c) + (b+d)i\\ 
u - v &= (a-c) + (b-d)i\\ 
uv &= (ac - bd) + (bc+ad)i\\ 
u/v &= \frac{ac +bd}{c^2 + d^2} + \frac{bc-ad}{c^2+d^2}i\\ 
|u| &= \sqrt{a^2 + b^2}\\ 
e^{iq} &= \cos q + i\sin q
\end{align*}
$$

<h2 id="___sec46">Complex arithmetics in Python <a name="___sec46"></a></h2>

Python supports computation with complex numbers. The imaginary unit
is written as <code>j</code> in Python, instead of \( i \) as in mathematics.  A
complex number \( 2-3i \) is therefore expressed as <code>(2-3j)</code> in Python.
We remark that the number \( i \) is written as <code>1j</code>, not just <code>j</code>.  Below
is a sample session involving definition of complex numbers and some
simple arithmetics:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> <span style="color: #666666">2.5</span> <span style="color: #666666">+</span> <span style="color: #666666">3j</span>       <span style="color: #408080; font-style: italic"># create a complex number</span>
<span style="color: #666666">&gt;&gt;&gt;</span> v <span style="color: #666666">=</span> <span style="color: #666666">2</span>              <span style="color: #408080; font-style: italic"># this is an int</span>
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">=</span> u <span style="color: #666666">+</span> v          <span style="color: #408080; font-style: italic"># complex + int</span>
<span style="color: #666666">&gt;&gt;&gt;</span> w
(<span style="color: #666666">4.5+3j</span>)

<span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> <span style="color: #666666">-2</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> a <span style="color: #666666">+</span> b<span style="color: #666666">*1j</span>       <span style="color: #408080; font-style: italic"># create a complex number from two floats</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> <span style="color: #008000">complex</span>(a, b)  <span style="color: #408080; font-style: italic"># alternative creation</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s
(<span style="color: #666666">-2+0.5j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">*</span>w                <span style="color: #408080; font-style: italic"># complex*complex</span>
(<span style="color: #666666">-10.5-3.75j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">/</span>w                <span style="color: #408080; font-style: italic"># complex/complex</span>
(<span style="color: #666666">-0.25641025641025639+0.28205128205128205j</span>)
</pre></div>
<p>
A <code>complex</code> object <code>s</code> has functionality for extracting
the real and imaginary
parts as well as computing the complex conjugate:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">.</span>real
<span style="color: #666666">-2.0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">.</span>imag
<span style="color: #666666">0.5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s<span style="color: #666666">.</span>conjugate()
(<span style="color: #666666">-2-0.5j</span>)
</pre></div>

<h2 id="___sec47">Complex functions in Python <a name="___sec47"></a></h2>

Taking the sine of a complex number does not work:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> sin
<span style="color: #666666">&gt;&gt;&gt;</span> r <span style="color: #666666">=</span> sin(w)
Traceback (most recent call last):
  File <span style="color: #BA2121">&quot;&lt;input&gt;&quot;</span>, line <span style="color: #666666">1</span>, <span style="color: #AA22FF; font-weight: bold">in</span> ?
<span style="color: #D2413A; font-weight: bold">TypeError</span>: can<span style="color: #BA2121">&#39;t convert complex to float; use abs(z)</span>
</pre></div>
<p>
The reason is that the <code>sin</code> function from the <code>math</code> module only
works with real (<code>float</code>) arguments, not complex.  A similar module,
<code>cmath</code>, defines functions that take a complex number as argument and
return a complex number as result.  As an example of using the <code>cmath</code>
module, we can demonstrate that the relation \( \sin(ai)=i\sinh a \)
holds:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">cmath</span> <span style="color: #008000; font-weight: bold">import</span> sin, sinh
<span style="color: #666666">&gt;&gt;&gt;</span> r1 <span style="color: #666666">=</span> sin(<span style="color: #666666">8j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> r1
<span style="color: #666666">1490.4788257895502j</span>
<span style="color: #666666">&gt;&gt;&gt;</span> r2 <span style="color: #666666">=</span> <span style="color: #666666">1j*</span>sinh(<span style="color: #666666">8</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> r2
<span style="color: #666666">1490.4788257895502j</span>
</pre></div>
<p>
Another relation, \( e^{iq} = \cos q + i\sin q \), is exemplified next:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> q <span style="color: #666666">=</span> <span style="color: #666666">8</span>     <span style="color: #408080; font-style: italic"># some arbitrary number</span>
<span style="color: #666666">&gt;&gt;&gt;</span> exp(<span style="color: #666666">1j*</span>q)
(<span style="color: #666666">-0.14550003380861354+0.98935824662338179j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> cos(q) <span style="color: #666666">+</span> <span style="color: #666666">1j*</span>sin(q)
(<span style="color: #666666">-0.14550003380861354+0.98935824662338179j</span>)
</pre></div>

<h2 id="formulas:unified:complex:real">Unified treatment of complex and real functions<a name="formulas:unified:complex:real"></a></h2>

The <code>cmath</code> functions always return complex numbers. It would be nice
to have functions that return a <code>float</code> object if the result is a real
number and a <code>complex</code> object if the result is a complex number.  The
Numerical Python package has such versions of the basic mathematical
functions known from <code>math</code> and <code>cmath</code>. By taking a

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy.lib.scimath</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
</pre></div>
<p>
one obtains access to these flexible versions of mathematical functions.
The functions also get imported by any of the statements

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scipy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
</pre></div>
<p>
A session will illustrate
what we obtain.
Let us first use the <code>sqrt</code> function in the
<code>math</code> module:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> sqrt
<span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">4</span>)     <span style="color: #408080; font-style: italic"># float</span>
<span style="color: #666666">2.0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">-1</span>)    <span style="color: #408080; font-style: italic"># illegal</span>
Traceback (most recent call last):
  File <span style="color: #BA2121">&quot;&lt;input&gt;&quot;</span>, line <span style="color: #666666">1</span>, <span style="color: #AA22FF; font-weight: bold">in</span> ?
<span style="color: #D2413A; font-weight: bold">ValueError</span>: math domain error
</pre></div>
<p>
If we now import <code>sqrt</code> from <code>cmath</code>,

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">cmath</span> <span style="color: #008000; font-weight: bold">import</span> sqrt
</pre></div>
<p>
the previous <code>sqrt</code> function is overwritten by the new one.
More precisely, the name <code>sqrt</code> was previously bound to a function
<code>sqrt</code> from the <code>math</code> module, but is now bound to another
function <code>sqrt</code> from the <code>cmath</code> module. In this case, any
square root results in a <code>complex</code> object:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">4</span>)     <span style="color: #408080; font-style: italic"># complex</span>
(<span style="color: #666666">2+0j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">-1</span>)    <span style="color: #408080; font-style: italic"># complex</span>
<span style="color: #666666">1j</span>
</pre></div>
<p>
If we now take

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy.lib.scimath</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
</pre></div>
<p>
we import (among other things) a new <code>sqrt</code> function. This function
is slower than the versions from <code>math</code> and <code>cmath</code>, but it
has more flexibility since the returned object is <code>float</code> if that is
mathematically possible, otherwise a <code>complex</code> is returned:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">4</span>)     <span style="color: #408080; font-style: italic"># float</span>
<span style="color: #666666">2.0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> sqrt(<span style="color: #666666">-1</span>)    <span style="color: #408080; font-style: italic"># complex</span>
<span style="color: #666666">1j</span>
</pre></div>
<p>
As a further illustration of the need for flexible treatment of both
complex and real numbers, we may code the formulas for the roots of a
quadratic function \( f(x)=ax^2 + bx + c \):

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> <span style="color: #666666">1</span>; b <span style="color: #666666">=</span> <span style="color: #666666">2</span>; c <span style="color: #666666">=</span> <span style="color: #666666">100</span>   <span style="color: #408080; font-style: italic"># polynomial coefficients</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy.lib.scimath</span> <span style="color: #008000; font-weight: bold">import</span> sqrt
<span style="color: #666666">&gt;&gt;&gt;</span> r1 <span style="color: #666666">=</span> (<span style="color: #666666">-</span>b <span style="color: #666666">+</span> sqrt(b<span style="color: #666666">**2</span> <span style="color: #666666">-</span> <span style="color: #666666">4*</span>a<span style="color: #666666">*</span>c))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a)
<span style="color: #666666">&gt;&gt;&gt;</span> r2 <span style="color: #666666">=</span> (<span style="color: #666666">-</span>b <span style="color: #666666">-</span> sqrt(b<span style="color: #666666">**2</span> <span style="color: #666666">-</span> <span style="color: #666666">4*</span>a<span style="color: #666666">*</span>c))<span style="color: #666666">/</span>(<span style="color: #666666">2*</span>a)
<span style="color: #666666">&gt;&gt;&gt;</span> r1
(<span style="color: #666666">-1+9.94987437107j</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> r2
(<span style="color: #666666">-1-9.94987437107j</span>)
</pre></div>
<p>
Using the up arrow, we may go back to the definitions of the
coefficients and change them so the roots become real numbers:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> <span style="color: #666666">1</span>; b <span style="color: #666666">=</span> <span style="color: #666666">4</span>; c <span style="color: #666666">=</span> <span style="color: #666666">1</span>   <span style="color: #408080; font-style: italic"># polynomial coefficients</span>
</pre></div>
<p>
Going back to the computations of <code>r1</code> and <code>r2</code> and performing
them again, we get

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> r1
<span style="color: #666666">-0.267949192431</span>
<span style="color: #666666">&gt;&gt;&gt;</span> r2
<span style="color: #666666">-3.73205080757</span>
</pre></div>
<p>
That is, the two results are <code>float</code> objects. Had we applied
<code>sqrt</code> from <code>cmath</code>, <code>r1</code> and <code>r2</code> would always be
<code>complex</code> objects, while <code>sqrt</code> from the <code>math</code> module
would not handle the first (complex) case.

<p>
<!-- Later in the document we will usually perform an import of <code>scitools.std</code>, -->
<!-- which automatically imports everything from <code>scipy</code> and hence -->
<!-- gives is the versions of -->
<!-- <code>sin</code>, <code>cos</code>, etc., which work with real and complex -->
<!-- numbers as arguments and return the simplest possible type of object. -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._formulas-bootstrap005.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._formulas-bootstrap007.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

