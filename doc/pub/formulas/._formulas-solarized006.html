<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Computing with formulas">
<meta name="keywords" content="directory,run Python program,execute Python program,terminal window,console (terminal) window,directory,comments,non-English characters,formatting text and numbers,printf syntax,string,triple-quoted strings,format string syntax,newline character (line break),line break,source code,application,statements,expression,syntax,whitespace,blanks,whitespace,input (data),output (data),user (of a program),operating system (OS),Windows,Mac OS X,Unix,Linux,objects,round-off errors,interactive sessions standard Python shell,type conversion,check an object's type,rounding float to integer,interactive sessions IPython,IPython,run Python program,execute Python program,IPython running Python programs,IPython start-up file,IPython executing operating system commands,IPython command history,complex numbers,Gaussian function">

<title>Computing with formulas</title>


<link href="https://raw.githubusercontent.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://raw.github.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(u' The first programming encounter: a formula ',
               1,
               u'sec:formula:1',
               u'sec:formula:1'),
              (u' Using a program as a calculator ',
               2,
               u'sec:formula:1st',
               u'sec:formula:1st'),
              (u' About programs and programming ', 2, None, '___sec2'),
              (u' Tools for writing programs ', 2, None, '___sec3'),
              (u' Writing and running your first Python program ',
               2,
               None,
               '___sec4'),
              (u' Warning about typing program text ', 2, None, '___sec5'),
              (u' Verifying the result ', 2, None, '___sec6'),
              (u' Using variables ',
               2,
               u'sec:formula:variables',
               u'sec:formula:variables'),
              (u' Names of variables ', 2, None, '___sec8'),
              (u' Reserved words in Python ',
               2,
               u'sec:formula:keywords',
               u'sec:formula:keywords'),
              (u' Comments ', 2, None, '___sec10'),
              (u' Remark ', 3, None, '___sec11'),
              (u' Formatting text and numbers ',
               2,
               u'sec:formula:format',
               u'sec:formula:format'),
              (u' Printf syntax ', 3, None, '___sec13'),
              (u' Format string syntax ', 3, None, '___sec14'),
              (u' The newline character ', 3, None, '___sec15'),
              (u' Computer science glossary ',
               1,
               u'sec:formula:glossary',
               u'sec:formula:glossary'),
              (u' Another formula: Celsius-Fahrenheit conversion ',
               1,
               u'sec:formula:c2f',
               u'sec:formula:c2f'),
              (u' Potential error: integer division ',
               2,
               u'sec:formula:intdiv',
               u'sec:formula:intdiv'),
              (u' Straightforward coding of the formula ',
               3,
               None,
               '___sec19'),
              (u' Verifying the results ', 3, None, '___sec20'),
              (u' Float and integer division ', 3, None, '___sec21'),
              (u' Objects in Python ', 2, None, '___sec22'),
              (u' Avoiding integer division ',
               2,
               u'sec:formula:c2f:correct',
               u'sec:formula:c2f:correct'),
              (u' Locating potential integer division ', 3, None, '___sec24'),
              (u' Remark ', 3, None, '___sec25'),
              (u' Arithmetic operators and precedence ',
               2,
               u'sec:formula:operators',
               u'sec:formula:operators'),
              (u' Evaluating standard mathematical functions ',
               1,
               u'sec:formula:stdmath',
               u'sec:formula:stdmath'),
              (u' Example: Using the square root function ',
               2,
               u'sec:formula:sqrt',
               u'sec:formula:sqrt'),
              (u' Problem ', 3, None, '___sec29'),
              (u' The program ', 3, None, '___sec30'),
              (u' Two ways of importing a module ', 3, None, '___sec31'),
              (u' Import with new names ', 3, None, '___sec32'),
              (u' Example: Computing with $\\sinh x$ ', 2, None, '___sec33'),
              (u' A first glimpse of round-off errors ',
               2,
               u'sec:formula:roundoff',
               u'sec:formula:roundoff'),
              (u' Interactive computing ',
               1,
               u'sec:formula:pyshell',
               u'sec:formula:pyshell'),
              (u' Using the Python shell ', 2, None, '___sec36'),
              (u' Type conversion ',
               2,
               u'sec:formulas:typeconversion',
               u'sec:formulas:typeconversion'),
              (u' IPython ',
               2,
               u'sec:formula:ipython',
               u'sec:formula:ipython'),
              (u' Running programs ', 3, None, '___sec39'),
              (u' Quick recovery of previous output ', 3, None, '___sec40'),
              (u' Tab completion ', 3, None, '___sec41'),
              (u' Recovering previous commands ', 3, None, '___sec42'),
              (u' Running Unix/Windows commands ', 3, None, '___sec43'),
              (u' Notebooks ', 3, None, '___sec44'),
              (u' Complex numbers ',
               1,
               u'sec:formula:complex',
               u'sec:formula:complex'),
              (u' Complex arithmetics in Python ', 2, None, '___sec46'),
              (u' Complex functions in Python ', 2, None, '___sec47'),
              (u' Unified treatment of complex and real functions ',
               2,
               u'formulas:unified:complex:real',
               u'formulas:unified:complex:real'),
              (u' Symbolic computing ',
               1,
               u'sec:formula:sympy',
               u'sec:formula:sympy'),
              (u' Basic differentiation and integration ',
               2,
               u'sec:formula:sympy:diffint',
               u'sec:formula:sympy:diffint'),
              (u' Equation solving and Taylor series ', 2, None, '___sec51'),
              (u' Summary ',
               1,
               u'sec:formula:summary',
               u'sec:formula:summary'),
              (u' Chapter topics ', 2, None, '___sec53'),
              (u' Programs must be accurate! ', 3, None, '___sec54'),
              (u' Variables ', 3, None, '___sec55'),
              (u' Comment lines ', 3, None, '___sec56'),
              (u' Object types ', 3, None, '___sec57'),
              (u' Operators ', 3, None, '___sec58'),
              (u' Common mathematical functions ', 3, None, '___sec59'),
              (u' Print ', 3, None, '___sec60'),
              (u' Complex numbers ', 3, None, '___sec61'),
              (u' Terminology ', 3, None, '___sec62'),
              (u' Example: Trajectory of a ball ', 2, None, '___sec63'),
              (u' Problem ', 3, None, '___sec64'),
              (u' Solution ', 3, None, '___sec65'),
              (u' About typesetting conventions in this book ',
               2,
               None,
               '___sec66'),
              (u' Style guide for Python code ', 3, None, '___sec67'),
              (u' Exercises ', 1, u'sec:formula:exer', u'sec:formula:exer'),
              (u' What does it mean to solve an exercise? ',
               3,
               None,
               '___sec69'),
              (u' Exercise 1: Compute 1+1 ',
               2,
               u'sec:formula:ex0',
               u'sec:formula:ex0'),
              (u' Exercise 2: Write a Hello World program ',
               2,
               u'sec:formula:ex5',
               u'sec:formula:ex5'),
              (u' Exercise 3: Derive and compute a formula ',
               2,
               u'sec:formula:ex16',
               u'sec:formula:ex16'),
              (u' Exercise 4: Convert from meters to British length units ',
               2,
               u'sec:formula:ex9',
               u'sec:formula:ex9'),
              (u' Exercise 5: Compute the mass of various substances ',
               2,
               u'sec:formula:exex3',
               u'sec:formula:exex3'),
              (u' Exercise 6: Compute the growth of money in a bank ',
               2,
               u'sec:formula:ex3',
               u'sec:formula:ex3'),
              (u' Exercise 7: Find error(s) in a program ',
               2,
               u'sec:formula:ex12',
               u'sec:formula:ex12'),
              (u' Exercise 8: Type in program text ',
               2,
               u'sec:formula:exex1',
               u'sec:formula:exex1'),
              (u' Exercise 9: Type in programs and debug them ',
               2,
               u'sec:formula:exex2a',
               u'sec:formula:exex2a'),
              (u' Exercise 10: Evaluate a Gaussian function ',
               2,
               u'sec:formula:ex7',
               u'sec:formula:ex7'),
              (u' Remarks ', 3, None, '___sec80'),
              (u' Exercise 11: Compute the air resistance on a football ',
               2,
               u'sec:formula:ex11',
               u'sec:formula:ex11'),
              (u' Exercise 12: How to cook the perfect egg ',
               2,
               u'sec:formula:ex14',
               u'sec:formula:ex14'),
              (u' Exercise 13: Derive the trajectory of a ball ',
               2,
               u'sec:formula:ex13',
               u'sec:formula:ex13'),
              (u' Exercise 14: Find errors in the coding of formulas ',
               2,
               u'sec:formula:ex1',
               u'sec:formula:ex1'),
              (u' Exercise 15: Explain why a program does not work ',
               2,
               u'sec:formula:ex15',
               u'sec:formula:ex15'),
              (u' Exercise 16: Find errors in Python statements ',
               2,
               u'sec:formula:ex2',
               u'sec:formula:ex2'),
              (u' Exercise 17: Find errors in the coding of a formula ',
               2,
               u'sec:formula:ex4',
               u'sec:formula:ex4'),
              (u' References ', 1, None, '___sec88')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<a name="part0006"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._formulas-solarized005.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._formulas-solarized007.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1>Complex numbers <a name="sec:formula:complex"></a></h1>

<p>
Suppose \( x^2=2 \). Then most of us are able to find out that
\( x=\sqrt{2} \) is a solution to the equation. The more mathematically
interested reader will also remark that \( x=-\sqrt{2} \) is another
solution.  But faced with the equation \( x^2=-2 \), very few are able to
find a proper solution without any previous knowledge of <em>complex
numbers</em>.  Such numbers have many applications in science, and it is
therefore important to be able to use such numbers in our programs.

<p>
On the following pages we extend the previous material on computing
with real numbers to complex numbers. The text is optional, and
readers without knowledge of complex numbers can safely drop this
section and jump to the section <a href="._formulas-solarized008.html#sec:formula:summary">Summary</a>.

<p>
A complex number is a pair of real numbers \( a \) and \( b \), most often
written as \( a+bi \), or \( a+ib \), where \( i \) is called the imaginary unit
and acts as a label for the second term.  Mathematically,
\( i=\sqrt{-1} \).  An important feature of complex numbers is definitely
the ability to compute square roots of negative numbers.  For example,
\( \sqrt{-2}=\sqrt{2}i \) (i.e., \( \sqrt{2}\sqrt{-1} \)).  The solutions of
\( x^2=-2 \) are thus \( x_1=+\sqrt{2}i \) and \( x_2=-\sqrt{2}i \).

<p>
There are rules for addition, subtraction, multiplication, and
division between two complex numbers. There are also rules for raising
a complex number to a real power, as well as rules for computing \( \sin
z \), \( \cos z \), \( \tan z \), \( e^z \), \( \ln z \), \( \sinh z \), \( \cosh z \), \( \tanh
z \), etc. for a complex number \( z = a+ib \).  We assume in the following
that you are familiar with the mathematics of complex numbers, at
least to the degree encountered in the program examples.

$$
\begin{equation*} \hbox{let } u=a+bi\hbox{ and }v=c+di\end{equation*}
$$


<p>
The following rules reflect complex arithmetics:

$$
\begin{align*}
u &= v\quad\Rightarrow\quad a=c, \ b=d\\ 
-u &= -a -bi\\ 
u^* &\equiv a - bi\quad\hbox{(complex conjugate)}\\ 
u+ v &= (a+c) + (b+d)i\\ 
u - v &= (a-c) + (b-d)i\\ 
uv &= (ac - bd) + (bc+ad)i\\ 
u/v &= \frac{ac +bd}{c^2 + d^2} + \frac{bc-ad}{c^2+d^2}i\\ 
|u| &= \sqrt{a^2 + b^2}\\ 
e^{iq} &= \cos q + i\sin q
\end{align*}
$$

<h2>Complex arithmetics in Python  <a name="___sec46"></a></h2>

<p>
Python supports computation with complex numbers. The imaginary unit
is written as <code>j</code> in Python, instead of \( i \) as in mathematics.  A
complex number \( 2-3i \) is therefore expressed as <code>(2-3j)</code> in Python.
We remark that the number \( i \) is written as <code>1j</code>, not just <code>j</code>.  Below
is a sample session involving definition of complex numbers and some
simple arithmetics:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; u = 2.5 + 3j       # create a complex number
&gt;&gt;&gt; v = 2              # this is an int
&gt;&gt;&gt; w = u + v          # complex + int
&gt;&gt;&gt; w
(4.5+3j)

&gt;&gt;&gt; a = -2
&gt;&gt;&gt; b = 0.5
&gt;&gt;&gt; s = a + b*1j       # create a complex number from two floats
&gt;&gt;&gt; s = complex(a, b)  # alternative creation
&gt;&gt;&gt; s
(-2+0.5j)
&gt;&gt;&gt; s*w                # complex*complex
(-10.5-3.75j)
&gt;&gt;&gt; s/w                # complex/complex
(-0.25641025641025639+0.28205128205128205j)
</code></pre>
<!-- end verbatim block -->
A <code>complex</code> object <code>s</code> has functionality for extracting
the real and imaginary
parts as well as computing the complex conjugate:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; s.real
-2.0
&gt;&gt;&gt; s.imag
0.5
&gt;&gt;&gt; s.conjugate()
(-2-0.5j)
</code></pre>
<!-- end verbatim block -->

<h2>Complex functions in Python  <a name="___sec47"></a></h2>

<p>
Taking the sine of a complex number does not work:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; from math import sin
&gt;&gt;&gt; r = sin(w)
Traceback (most recent call last):
  File &quot;&lt;input&gt;&quot;, line 1, in ?
TypeError: can't convert complex to float; use abs(z)
</code></pre>
<!-- end verbatim block -->
The reason is that the <code>sin</code> function from the <code>math</code> module only
works with real (<code>float</code>) arguments, not complex.  A similar module,
<code>cmath</code>, defines functions that take a complex number as argument and
return a complex number as result.  As an example of using the <code>cmath</code>
module, we can demonstrate that the relation \( \sin(ai)=i\sinh a \)
holds:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; from cmath import sin, sinh
&gt;&gt;&gt; r1 = sin(8j)
&gt;&gt;&gt; r1
1490.4788257895502j
&gt;&gt;&gt; r2 = 1j*sinh(8)
&gt;&gt;&gt; r2
1490.4788257895502j
</code></pre>
<!-- end verbatim block -->
Another relation, \( e^{iq} = \cos q + i\sin q \), is exemplified next:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; q = 8     # some arbitrary number
&gt;&gt;&gt; exp(1j*q)
(-0.14550003380861354+0.98935824662338179j)
&gt;&gt;&gt; cos(q) + 1j*sin(q)
(-0.14550003380861354+0.98935824662338179j)
</code></pre>
<!-- end verbatim block -->

<h2>Unified treatment of complex and real functions <a name="formulas:unified:complex:real"></a></h2>

<p>
The <code>cmath</code> functions always return complex numbers. It would be nice
to have functions that return a <code>float</code> object if the result is a real
number and a <code>complex</code> object if the result is a complex number.  The
Numerical Python package has such versions of the basic mathematical
functions known from <code>math</code> and <code>cmath</code>. By taking a

<p>
<!-- begin verbatim block  pycod-->
<pre><code>from numpy.lib.scimath import *
</code></pre>
<!-- end verbatim block -->
one obtains access to these flexible versions of mathematical functions.
The functions also get imported by any of the statements

<p>
<!-- begin verbatim block  pycod-->
<pre><code>from scipy import *
from scitools.std import *
</code></pre>
<!-- end verbatim block -->

<p>
A session will illustrate
what we obtain.
Let us first use the <code>sqrt</code> function in the
<code>math</code> module:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; from math import sqrt
&gt;&gt;&gt; sqrt(4)     # float
2.0
&gt;&gt;&gt; sqrt(-1)    # illegal
Traceback (most recent call last):
  File &quot;&lt;input&gt;&quot;, line 1, in ?
ValueError: math domain error
</code></pre>
<!-- end verbatim block -->
If we now import <code>sqrt</code> from <code>cmath</code>,

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; from cmath import sqrt
</code></pre>
<!-- end verbatim block -->
the previous <code>sqrt</code> function is overwritten by the new one.
More precisely, the name <code>sqrt</code> was previously bound to a function
<code>sqrt</code> from the <code>math</code> module, but is now bound to another
function <code>sqrt</code> from the <code>cmath</code> module. In this case, any
square root results in a <code>complex</code> object:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; sqrt(4)     # complex
(2+0j)
&gt;&gt;&gt; sqrt(-1)    # complex
1j
</code></pre>
<!-- end verbatim block -->
If we now take

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; from numpy.lib.scimath import *
</code></pre>
<!-- end verbatim block -->
we import (among other things) a new <code>sqrt</code> function. This function
is slower than the versions from <code>math</code> and <code>cmath</code>, but it
has more flexibility since the returned object is <code>float</code> if that is
mathematically possible, otherwise a <code>complex</code> is returned:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; sqrt(4)     # float
2.0
&gt;&gt;&gt; sqrt(-1)    # complex
1j
</code></pre>
<!-- end verbatim block -->

<p>
As a further illustration of the need for flexible treatment of both
complex and real numbers, we may code the formulas for the roots of a
quadratic function \( f(x)=ax^2 + bx + c \):

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; a = 1; b = 2; c = 100   # polynomial coefficients
&gt;&gt;&gt; from numpy.lib.scimath import sqrt
&gt;&gt;&gt; r1 = (-b + sqrt(b**2 - 4*a*c))/(2*a)
&gt;&gt;&gt; r2 = (-b - sqrt(b**2 - 4*a*c))/(2*a)
&gt;&gt;&gt; r1
(-1+9.94987437107j)
&gt;&gt;&gt; r2
(-1-9.94987437107j)
</code></pre>
<!-- end verbatim block -->
Using the up arrow, we may go back to the definitions of the
coefficients and change them so the roots become real numbers:

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; a = 1; b = 4; c = 1   # polynomial coefficients
</code></pre>
<!-- end verbatim block -->
Going back to the computations of <code>r1</code> and <code>r2</code> and performing
them again, we get

<p>
<!-- begin verbatim block  pyshell-->
<pre><code>&gt;&gt;&gt; r1
-0.267949192431
&gt;&gt;&gt; r2
-3.73205080757
</code></pre>
<!-- end verbatim block -->
That is, the two results are <code>float</code> objects. Had we applied
<code>sqrt</code> from <code>cmath</code>, <code>r1</code> and <code>r2</code> would always be
<code>complex</code> objects, while <code>sqrt</code> from the <code>math</code> module
would not handle the first (complex) case.

<p>
<!-- Later in the document we will usually perform an import of <code>scitools.std</code>, -->
<!-- which automatically imports everything from <code>scipy</code> and hence -->
<!-- gives is the versions of -->
<!-- <code>sin</code>, <code>cos</code>, etc., which work with real and complex -->
<!-- numbers as arguments and return the simplest possible type of object. -->

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._formulas-solarized005.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._formulas-solarized007.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

