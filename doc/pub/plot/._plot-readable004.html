<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Array computing and curve plotting">
<meta name="keywords" content="vectors,vector computing,scalar (math quantity),heterogeneous lists,Numerical Python,NumPy,array (datatype),array computing,vectorization,array slicing,subarrays,allocate,vectorization,scalar code,curve plotting,plotting,making graphs,backend (Easyviz),backend (Easyviz),remove files (in Python),delete files (in Python),boolean indexing,boolean indexing,in-place array arithmetics,check an object's type,shape (of an array),array shape,matrix,shape (of an array),array shape,least squares approximation,Trapezoidal rule for integration,Lagrange's interpolation formula,interpolation,Midpoint rule for integration,Trapezoidal rule for integration">

<title>Array computing and curve plotting</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Vectors ', 1, None, '___sec0'),
              (' The vector concept ', 2, None, '___sec1'),
              (' Mathematical operations on vectors ',
               2,
               'sec:plot:vectors',
               'sec:plot:vectors'),
              (' Vector arithmetics and vector functions ',
               2,
               'sec:plot:arraycomp',
               'sec:plot:arraycomp'),
              (' Arrays in Python programs ', 1, None, '___sec4'),
              (' Using lists for collecting function data ',
               2,
               'sec:plot:listdata',
               'sec:plot:listdata'),
              (' Basics of numerical Python arrays ',
               2,
               'sec:plot:array:basics',
               'sec:plot:array:basics'),
              (' Computing coordinates and function values ',
               2,
               None,
               '___sec7'),
              (' Vectorization ',
               2,
               'sec:plot:vectorization',
               'sec:plot:vectorization'),
              (' Curve plotting ',
               1,
               'sec:plot:curveplots',
               'sec:plot:curveplots'),
              (' Matplotlib; pylab ', 2, 'sec:plot:pylab', 'sec:plot:pylab'),
              (' A basic plot ', 3, None, '___sec11'),
              (' Decorating the plot ', 3, None, '___sec12'),
              (' Plotting multiple curves ', 3, None, '___sec13'),
              (' Placing several plots in one figure ', 3, None, '___sec14'),
              (' Matplotlib; pyplot ',
               2,
               'sec:plot:pyplot',
               'sec:plot:pyplot'),
              (' SciTools and Easyviz ',
               2,
               'sec:plot:SciTools',
               'sec:plot:SciTools'),
              (' Importing SciTools and Easyviz ', 3, None, '___sec17'),
              (' A basic plot ', 3, None, '___sec18'),
              (' Decorating the plot ', 3, None, '___sec19'),
              (' Plotting multiple curves ', 3, None, '___sec20'),
              (' Changing backend ', 3, None, '___sec21'),
              (' Placing several plots in one figure ', 3, None, '___sec22'),
              (' Making animations ', 2, 'easyviz:movie', 'easyviz:movie'),
              (' Example ', 3, None, '___sec24'),
              (' Animation in Easyviz ', 3, None, '___sec25'),
              (' Basic animation in Matplotlib ', 3, None, '___sec26'),
              (' Using FuncAnimation in Matplotlib ', 3, None, '___sec27'),
              (' Making videos ', 2, 'sec:plot:video', 'sec:plot:video'),
              (' Animated GIF file ', 3, None, '___sec29'),
              (' MP4, Ogg, WebM, and Flash videos ', 3, None, '___sec30'),
              (' Curve plots in pure text ', 2, None, '___sec31'),
              (' Plotting difficulties ',
               1,
               'sec:plot:difficulties',
               'sec:plot:difficulties'),
              (' Piecewisely defined functions ',
               2,
               'sec:plot:pwisefunc',
               'sec:plot:pwisefunc'),
              (' Example: The Heaviside function ', 3, None, '___sec34'),
              (' Example: A hat function ', 3, None, '___sec35'),
              (' Rapidly varying functions ',
               2,
               'sec:plot:sin1x',
               'sec:plot:sin1x'),
              (' More advanced vectorization of functions ',
               1,
               'sec:plot:if:vectorize',
               'sec:plot:if:vectorize'),
              (' Vectorization of StringFunction objects ',
               2,
               'sec:plot:StringFunction:vectorize',
               'sec:plot:StringFunction:vectorize'),
              (' Vectorization of the Heaviside function ',
               2,
               'sec:vec:Heaviside',
               'sec:vec:Heaviside'),
              (' Loop ', 3, None, '___sec40'),
              (' Automatic vectorization ', 3, None, '___sec41'),
              (' Mixing boolean and floating-point calculations ',
               3,
               None,
               '___sec42'),
              (' Manual vectorization ', 3, None, '___sec43'),
              (' Vectorization of a hat function ',
               2,
               'sec:vec:hatfunc',
               'sec:vec:hatfunc'),
              (' More on numerical Python arrays ',
               1,
               'sec:plot:numpy:more',
               'sec:plot:numpy:more'),
              (' Copying arrays ', 2, None, '___sec46'),
              (' In-place arithmetics ', 2, None, '___sec47'),
              (' Allocating arrays ', 2, None, '___sec48'),
              (' Generalized indexing ',
               2,
               'sec:plot:generalized:index',
               'sec:plot:generalized:index'),
              (' Testing for the array type ', 2, None, '___sec50'),
              (' Example: Vectorizing a constant function ',
               3,
               None,
               '___sec51'),
              (' Compact syntax for array generation ', 2, None, '___sec52'),
              (' Shape manipulation ', 2, None, '___sec53'),
              (' Higher-dimensional arrays ',
               1,
               'sec:plot:2Darrays',
               'sec:plot:2Darrays'),
              (' Matrices and arrays ', 2, None, '___sec55'),
              (' Two-dimensional numerical Python arrays ',
               2,
               'sec:plot:2D:arrays',
               'sec:plot:2D:arrays'),
              (' Array computing ',
               2,
               'sec:plot:array2comp',
               'sec:plot:array2comp'),
              (' Remark ', 3, None, '___sec58'),
              (' Two-dimensional arrays and functions of two variables ',
               2,
               None,
               '___sec59'),
              (' Matrix objects ',
               2,
               'sec:plot:numpy:matrix',
               'sec:plot:numpy:matrix'),
              (' Summary ', 1, None, '___sec61'),
              (' Chapter topics ', 2, None, '___sec62'),
              (' Array computing ', 3, None, '___sec63'),
              (' Plotting curves ', 3, None, '___sec64'),
              (' Making movies ', 3, None, '___sec65'),
              (' Terminology ', 3, None, '___sec66'),
              (' Example: Animating a function ',
               2,
               'sec:plot:summarizing',
               'sec:plot:summarizing'),
              (' Problem ', 3, None, '___sec68'),
              (' Solution ', 3, None, '___sec69'),
              (' Scaling ', 3, None, '___sec70'),
              (' Exercises ', 1, 'sec:plot:exer', 'sec:plot:exer'),
              (' Exercise 1: Fill lists with function values ',
               2,
               'sec:plot:ex1',
               'sec:plot:ex1'),
              (' Exercise 2: Fill arrays; loop version ',
               2,
               'sec:plot:ex2',
               'sec:plot:ex2'),
              (' Exercise 3: Fill arrays; vectorized version ',
               2,
               'sec:plot:ex2b',
               'sec:plot:ex2b'),
              (' Exercise 4: Plot a function ',
               2,
               'sec:plot:ex2c',
               'sec:plot:ex2c'),
              (' Exercise 5: Apply a function to a vector ',
               2,
               'sec:plot:math:ex1',
               'sec:plot:math:ex1'),
              (' Exercise 6: Simulate by hand a vectorized expression ',
               2,
               'sec:plot:ex3',
               'sec:plot:ex3'),
              (' Exercise 7: Demonstrate array slicing ',
               2,
               'sec:plot:ex15d',
               'sec:plot:ex15d'),
              (' Exercise 8: Plot a formula ',
               2,
               'sec:plot:ex15',
               'sec:plot:ex15'),
              (' Exercise 9: Plot a formula for several parameters ',
               2,
               'sec:plot:ex15b',
               'sec:plot:ex15b'),
              (' Exercise 10: Specify the extent of the axes in a plot ',
               2,
               'sec:plot:ex15ba',
               'sec:plot:ex15ba'),
              (' Exercise 11: Plot exact and inexact Fahrenheit-Celsius conversion formulas ',
               2,
               'sec:plot:ex15c',
               'sec:plot:ex15c'),
              (' Exercise 12: Plot the trajectory of a ball ',
               2,
               'sec:plot:ex5',
               'sec:plot:ex5'),
              (' Exercise 13: Plot data in a two-column file ',
               2,
               'sec:files:ex12',
               'sec:files:ex12'),
              (' Remarks ', 3, None, '___sec85'),
              (' Exercise 14: Plot data from a file ',
               2,
               'sec:files:ex12c',
               'sec:files:ex12c'),
              (' Exercise 15: Fit a polynomial to data points ',
               2,
               'sec:files:ex12c2',
               'sec:files:ex12c2'),
              (' Exercise 16: Fit a polynomial to experimental data ',
               2,
               'sec:files:ex19',
               'sec:files:ex19'),
              (' Exercise 17: Read acceleration data and find velocities ',
               2,
               'sec:files:ex22',
               'sec:files:ex22'),
              (' Exercise 18: Read acceleration data and plot velocities ',
               2,
               'sec:files:ex23',
               'sec:files:ex23'),
              (" Exercise 19: Plot a trip's path and velocity from GPS coordinates ",
               2,
               'sec:files:ex24',
               'sec:files:ex24'),
              (' Exercise 20: Vectorize the Midpoint rule for integration ',
               2,
               'sec:class:exer:sum',
               'sec:class:exer:sum'),
              (' Remarks ', 3, None, '___sec93'),
              (" Exercise 21: Implement Lagrange's interpolation formula ",
               2,
               'sec:class:ex27a',
               'sec:class:ex27a'),
              (" Exercise 22: Plot Lagrange's interpolating polynomial ",
               2,
               'sec:class:ex27b',
               'sec:class:ex27b'),
              (" Exercise 23: Investigate the behavior of Lagrange's interpolating polynomials ",
               2,
               'sec:class:ex27c',
               'sec:class:ex27c'),
              (' Remarks ', 3, None, '___sec97'),
              (' Exercise 24: Plot a wave packet ',
               2,
               'sec:plot:ex5d',
               'sec:plot:ex5d'),
              (' Exercise 25: Judge a plot ',
               2,
               'sec:plot:ex7',
               'sec:plot:ex7'),
              (' Exercise 26: Plot the viscosity of water ',
               2,
               'sec:plot:ex13c',
               'sec:plot:ex13c'),
              (' Exercise 27: Explore a complicated function graphically ',
               2,
               'sec:plot:ex16',
               'sec:plot:ex16'),
              (' Exercise 28: Plot Taylor polynomial approximations to $\\sin x$ ',
               2,
               'sec:plot:ex5b',
               'sec:plot:ex5b'),
              (' Exercise 29: Animate a wave packet ',
               2,
               'sec:plot:ex5e',
               'sec:plot:ex5e'),
              (' Exercise 30: Animate two-scale temperature variations ',
               2,
               'sec:plot:ex18',
               'sec:plot:ex18'),
              (' Remarks ', 3, None, '___sec105'),
              (' Exercise 31: Use non-uniformly distributed coordinates for visualization ',
               2,
               'sec:plot:ex19',
               'sec:plot:ex19'),
              (" Exercise 32: Animate a planet's orbit ",
               2,
               'sec:plot:ex5g',
               'sec:plot:ex5g'),
              (' Exercise 33: Animate the evolution of Taylor polynomials ',
               2,
               'sec:plot:ex17',
               'sec:plot:ex17'),
              (' Exercise 34: Plot the velocity profile for pipeflow ',
               2,
               'sec:plot:ex4',
               'sec:plot:ex4'),
              (' Exercise 35: Plot sum-of-sines approximations to a function ',
               2,
               'sec:plot:ex8',
               'sec:plot:ex8'),
              (' Exercise 36: Animate the evolution of a sum-of-sine approximation to a function ',
               2,
               'sec:plot:ex8m',
               'sec:plot:ex8m'),
              (' Exercise 37: Plot functions from the command line ',
               2,
               'sec:plot:ex14',
               'sec:plot:ex14'),
              (' Exercise 38: Improve command-line input ',
               2,
               'sec:plot:ex14b',
               'sec:plot:ex14b'),
              (' Exercise 39: Demonstrate energy concepts from physics ',
               2,
               'sec:plot:ex20',
               'sec:plot:ex20'),
              (' Exercise 40: Plot a w-like function ',
               2,
               'sec:plot:math:ex9',
               'sec:plot:math:ex9'),
              (' Exercise 41: Visualize approximations in the Midpoint integration rule ',
               2,
               'sec:plot:ex:vizmidpoint',
               'sec:plot:ex:vizmidpoint'),
              (' Exercise 42: Visualize approximations in the Trapezoidal integration rule ',
               2,
               'sec:plot:ex:viztrapezoidal',
               'sec:plot:ex:viztrapezoidal'),
              (' Exercise 43: Experience overflow in a function ',
               2,
               'sec:plot:ex13',
               'sec:plot:ex13'),
              (' Remarks ', 3, None, '___sec119'),
              (' Exercise 44: Apply a function to a rank 2 array ',
               2,
               'sec:plot:math:ex2',
               'sec:plot:math:ex2'),
              (' Exercise 45: Explain why array computations fail ',
               2,
               'sec:plot:ex11',
               'sec:plot:ex11'),
              (' References ', 1, None, '___sec122')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="plot-readable.html">Array computing and curve plotting</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._plot-readable001.html#___sec0" style="font-size: 80%;">Vectors</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#___sec4" style="font-size: 80%;">Arrays in Python programs</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:curveplots" style="font-size: 80%;">Curve plotting</a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:difficulties" style="font-size: 80%;">Plotting difficulties</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#sec:plot:if:vectorize" style="font-size: 80%;">More advanced vectorization of functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable006.html#sec:plot:numpy:more" style="font-size: 80%;">More on numerical Python arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#sec:plot:2Darrays" style="font-size: 80%;">Higher-dimensional arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec61" style="font-size: 80%;">Summary</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:exer" style="font-size: 80%;">Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec122" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0004"></a>
<!-- !split -->

<h1 id="sec:plot:difficulties">Plotting difficulties<a name="sec:plot:difficulties"></a></h1>

<p>
The previous examples on plotting functions demonstrate how easy it is
to make graphs. Nevertheless, the shown techniques might easily fail
to plot some functions correctly unless we are careful.  Next we
address two types of difficult functions: piecewisely defined
functions and rapidly varying functions.

<h2 id="sec:plot:pwisefunc">Piecewisely defined functions<a name="sec:plot:pwisefunc"></a></h2>

<p>
A piecewisely defined function has different function definitions in
different intervals along the \( x \) axis. The resulting function, made
up of pieces, may have discontinuities in the function value or in
derivatives. We have to be very careful when plotting such functions,
as the next two examples will show. The problem is that the plotting
mechanism draws straight lines between coordinates on the function's
curve, and these straight lines may not yield a satisfactory
visualization of the function.  The first example has a discontinuity
in the function itself at one point, while the other example has a
discontinuity in the derivative at three points.

<h3 id="___sec34">Example: The Heaviside function <a name="___sec34"></a></h3>

<p>
Let us plot the Heaviside function

$$
\begin{equation*}
H(x) = \left\lbrace\begin{array}{ll}
0, & x < 0\\ 
1, & x\geq 0
\end{array}\right.
\end{equation*}
$$

The most natural way to proceed is first to define the function as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>)
</pre></div>
<p>
The standard plotting procedure where we define a coordinate array <code>x</code>
and call <code>y = H(x)</code> will not work for array arguments <code>x</code>, of reasons
to be explained in the section <a href="._plot-readable005.html#sec:vec:Heaviside">Vectorization of the Heaviside function</a>.  However, we may
use techniques from that chapter to create a function <code>Hv(x)</code> that
works for array arguments.  Even with such a function we face
difficulties with plotting it.

<p>
Since the Heaviside function consists of two flat lines, one may think
that we do not need many points along the \( x \) axis to describe the
curve.  Let us try with nine points:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-10</span>, <span style="color: #666666">10</span>, <span style="color: #666666">9</span>)
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> plot
plot(x, Hv(x), axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>
<p>
However, so few \( x \) points are not able to describe the jump from 0 to
1 at \( x=0 \), as shown by the solid line in Figure
<a href="#fig:plot:Heaviside">8</a>a.  Using more points, say 50 between \( -10 \) and
\( 10 \),

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x2 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-10</span>, <span style="color: #666666">10</span>, <span style="color: #666666">50</span>)
plot(x, Hv(x), <span style="color: #BA2121">&#39;r&#39;</span>, x2, Hv(x2), <span style="color: #BA2121">&#39;b&#39;</span>,
     legend<span style="color: #666666">=</span>(<span style="color: #BA2121">&#39;5 points&#39;</span>, <span style="color: #BA2121">&#39;50 points&#39;</span>),
     axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>
<p>
makes the curve look better. However, the step is still not strictly
vertical.  More points will improve the situation. Nevertheless, the
best is to draw two flat lines directly: from \( (-10,0) \) to \( (0,0) \),
then to \( (0,1) \) and then to \( (10,1) \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">plot([<span style="color: #666666">-10</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">10</span>], [<span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1</span>],
     axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>
<p>
The result is shown in Figure <a href="#fig:plot:Heaviside">8</a>b.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  Plot of the Heaviside function using 9 equally spaced \( x \) points (left) and with a double point at \( x=0 \) (right). <a name="fig:plot:Heaviside"></a> </p></center>
<p><img src="fig-plot/Heaviside.png" align="bottom" width=600></p>
</center>

<p>
Some will argue that the plot of \( H(x) \) should not contain the vertical
line from \( (0,0) \) to \( (0,1) \), but only two horizontal lines. To make
such a plot, we must draw two distinct curves, one for each horizontal
line:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">plot([<span style="color: #666666">-10</span>,<span style="color: #666666">0</span>], [<span style="color: #666666">0</span>,<span style="color: #666666">0</span>], <span style="color: #BA2121">&#39;r-&#39;</span>, [<span style="color: #666666">0</span>,<span style="color: #666666">10</span>], [<span style="color: #666666">1</span>,<span style="color: #666666">1</span>], <span style="color: #BA2121">&#39;r-&#39;</span>,
     axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>
<p>
Observe that we must specify the same line style for both lines
(curves), otherwise they would by default get different colors on the
screen or different line types in a hardcopy of the plot.  We remark,
however, that discontinuous functions like \( H(x) \) are often visualized
with vertical lines at the jumps, as we do in Figure
<a href="#fig:plot:Heaviside">8</a>b.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 9:  Plot of a hat function. The solid line shows the exact function, while the dashed line arises from using inappropriate points along the \( x \) axis. <a name="fig:plot:Hat"></a> </p></center>
<p><img src="fig-plot/Hat1.png" align="bottom" width=400></p>
</center>

<h3 id="___sec35">Example: A hat function <a name="___sec35"></a></h3>

<p>
Let us plot the hat function \( N(x) \), shown as the solid line in Figure
<a href="#fig:plot:Hat">9</a>. This function is a piecewise linear function. The
implementation of \( N(x) \) must use <code>if</code> tests to locate where we are
along the \( x \) axis and then evaluate the right linear piece of \( N(x) \).
A straightforward implementation with plain <code>if</code> tests does not work
with array arguments <code>x</code>, but the section <a href="._plot-readable005.html#sec:vec:hatfunc">Vectorization of a hat function</a> explains
how to make a vectorized version <code>Nv(x)</code> that works for array
arguments as well.  Anyway, both the scalar and the vectorized
versions face challenges when it comes to plotting.

<p>
A first approach to plotting could be

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-2</span>, <span style="color: #666666">4</span>, <span style="color: #666666">6</span>)
plot(x, Nv(x), <span style="color: #BA2121">&#39;r&#39;</span>, axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>
<p>
This results in the dashed line in Figure <a href="#fig:plot:Hat">9</a>.
What is the problem? The problem lies in the computation of the
<code>x</code> vector, which does not contain the points \( x=1 \) and \( x=2 \)
where the function makes significant changes. The result is that
the hat is flattened. Making an <code>x</code> vector with all
critical points in the function definitions, \( x=0,1,2 \), provides
the necessary remedy, either

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-2</span>, <span style="color: #666666">4</span>, <span style="color: #666666">7</span>)
</pre></div>
<p>
or the simple

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x <span style="color: #666666">=</span> [<span style="color: #666666">-2</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">4</span>]
</pre></div>
<p>
Any of these <code>x</code> alternatives and a <code>plot(x, Nv(x))</code>
will result in the solid line in Figure <a href="#fig:plot:Hat">9</a>,
which is the correct visualization of the \( N(x) \) function.

<p>
As in the case of the Heaviside function, it is perhaps best
to drop using vectorized evaluations and just draw straight
lines between the critical points of the function (since the
function is linear):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">x <span style="color: #666666">=</span> [<span style="color: #666666">-2</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">4</span>]
y <span style="color: #666666">=</span> [N(xi) <span style="color: #008000; font-weight: bold">for</span> xi <span style="color: #AA22FF; font-weight: bold">in</span> x]
plot(x, y, <span style="color: #BA2121">&#39;r&#39;</span>, axis<span style="color: #666666">=</span>[x[<span style="color: #666666">0</span>], x[<span style="color: #666666">-1</span>], <span style="color: #666666">-0.1</span>, <span style="color: #666666">1.1</span>])
</pre></div>

<h2 id="sec:plot:sin1x">Rapidly varying functions<a name="sec:plot:sin1x"></a></h2>

<p>
Let us now visualize the function
\( f(x) = \sin (1/x) \), using 10 and 1000 points:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> sin(<span style="color: #666666">1.0/</span>x)

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> linspace, plot
x1 <span style="color: #666666">=</span> linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">10</span>)
x2 <span style="color: #666666">=</span> linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1000</span>)
plot(x1, f(x1), label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> points&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">len</span>(x))
plot(x2, f(x2), label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> points&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">len</span>(x))
</pre></div>
<p>
The two plots are shown in Figure <a href="#fig:plot:sin1overx">10</a>.
Using only 10 points gives a completely wrong picture of this
function, because the function oscillates faster and faster as we
approach the origin. With 1000 points we get an impression of these
oscillations, but the accuracy of the plot in the vicinity of the
origin is still poor. A plot with 100000 points has better
accuracy, in principle, but the extremely fast oscillations near
the origin just drowns in black ink (you can try it out yourself).

<p>
Another problem with the \( f(x)=\sin (1/x) \) function is that it is easy
to define an <code>x</code> vector containing \( x=0 \), such that we get division
by zero. Mathematically, the \( f(x) \) function has a singularity at \( x=0 \):
it is difficult to define \( f(0) \), so one should exclude this point from
the function definition and work with a domain \( x\in [-1,-\epsilon]\cup
[\epsilon,1] \), with \( \epsilon \) chosen small.

<p>
The lesson learned from these examples is clear. You must investigate
the function to be visualized and make sure that you use an
appropriate set of \( x \) coordinates along the curve.  A relevant first
step is to double the number of \( x \) coordinates and check if this
changes the plot.  If not, you probably have an adequate set of \( x \)
coordinates.

<p>
<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 10:  Plot of the function \( \sin(1/x) \) with 10 points (left) and 1000 points (right). <a name="fig:plot:sin1overx"></a> </p></center>
<p><img src="fig-plot/sin1overx.png" align="bottom" width=400></p>
</center>

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._plot-readable003.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._plot-readable005.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

