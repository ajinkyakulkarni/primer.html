<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Array computing and curve plotting">
<meta name="keywords" content="vectors,vector computing,scalar (math quantity),heterogeneous lists,Numerical Python,NumPy,array (datatype),array computing,vectorization,array slicing,subarrays,allocate,vectorization,scalar code,curve plotting,plotting,making graphs,backend (Easyviz),backend (Easyviz),remove files (in Python),delete files (in Python),boolean indexing,boolean indexing,in-place array arithmetics,check an object's type,shape (of an array),array shape,matrix,shape (of an array),array shape,eigenvalues,eigenvectors,inverse,determinant,rank of a matrix,least squares approximation,Trapezoidal rule for integration,Lagrange's interpolation formula,interpolation,Midpoint rule for integration,Trapezoidal rule for integration">

<title>Array computing and curve plotting</title>

<!-- Bootstrap style: bootstrap_simula -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_simula.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap_simula */
  margin:-50px 0 0; /* negative fixed header height */
}

body { font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Vectors', 1, None, '___sec0'),
              ('The vector concept', 2, None, '___sec1'),
              ('Mathematical operations on vectors',
               2,
               'sec:plot:vectors',
               'sec:plot:vectors'),
              ('Vector arithmetics and vector functions',
               2,
               'sec:plot:arraycomp',
               'sec:plot:arraycomp'),
              ('Arrays in Python programs', 1, None, '___sec4'),
              ('Using lists for collecting function data',
               2,
               'sec:plot:listdata',
               'sec:plot:listdata'),
              ('Basics of numerical Python arrays',
               2,
               'sec:plot:array:basics',
               'sec:plot:array:basics'),
              ('Computing coordinates and function values',
               2,
               None,
               '___sec7'),
              ('Vectorization',
               2,
               'sec:plot:vectorization',
               'sec:plot:vectorization'),
              ('Curve plotting',
               1,
               'sec:plot:curveplots',
               'sec:plot:curveplots'),
              ('MATLAB-style plotting with Matplotlib',
               2,
               'sec:plot:pylab',
               'sec:plot:pylab'),
              ('A basic plot', 3, None, '___sec11'),
              ('Decorating the plot', 3, None, '___sec12'),
              ('Plotting multiple curves', 3, None, '___sec13'),
              ('Placing several plots in one figure', 3, None, '___sec14'),
              ('Matplotlib; pyplot prefix',
               2,
               'sec:plot:pyplot',
               'sec:plot:pyplot'),
              ('SciTools and Easyviz',
               2,
               'sec:plot:SciTools',
               'sec:plot:SciTools'),
              ('Importing SciTools and Easyviz', 3, None, '___sec17'),
              ('A basic plot', 3, None, '___sec18'),
              ('Decorating the plot', 3, None, '___sec19'),
              ('Plotting multiple curves', 3, None, '___sec20'),
              ('Changing backend', 3, None, '___sec21'),
              ('Placing several plots in one figure', 3, None, '___sec22'),
              ('Other plotting alternatives', 3, None, '___sec23'),
              ('Making animations', 2, 'easyviz:movie', 'easyviz:movie'),
              ('Example', 3, None, '___sec25'),
              ('Animation in Easyviz', 3, None, '___sec26'),
              ('Basic animation in Matplotlib', 3, None, '___sec27'),
              ('Using FuncAnimation in Matplotlib', 3, None, '___sec28'),
              ('Making videos', 2, 'sec:plot:video', 'sec:plot:video'),
              ('Animated GIF file', 3, None, '___sec30'),
              ('MP4, Ogg, WebM, and Flash videos', 3, None, '___sec31'),
              ('Curve plots in pure text', 2, None, '___sec32'),
              ('Plotting difficulties',
               1,
               'sec:plot:difficulties',
               'sec:plot:difficulties'),
              ('Piecewisely defined functions',
               2,
               'sec:plot:pwisefunc',
               'sec:plot:pwisefunc'),
              ('Example: The Heaviside function', 3, None, '___sec35'),
              ('Example: A hat function', 3, None, '___sec36'),
              ('Rapidly varying functions',
               2,
               'sec:plot:sin1x',
               'sec:plot:sin1x'),
              ('More advanced vectorization of functions',
               1,
               'sec:plot:if:vectorize',
               'sec:plot:if:vectorize'),
              ('Vectorization of StringFunction objects',
               2,
               'sec:plot:StringFunction:vectorize',
               'sec:plot:StringFunction:vectorize'),
              ('Vectorization of the Heaviside function',
               2,
               'sec:vec:Heaviside',
               'sec:vec:Heaviside'),
              ('Loop', 3, None, '___sec41'),
              ('Automatic vectorization', 3, None, '___sec42'),
              ('Mixing boolean and floating-point calculations',
               3,
               None,
               '___sec43'),
              ('Manual vectorization', 3, None, '___sec44'),
              ('Vectorization of a hat function',
               2,
               'sec:vec:hatfunc',
               'sec:vec:hatfunc'),
              ('More on numerical Python arrays',
               1,
               'sec:plot:numpy:more',
               'sec:plot:numpy:more'),
              ('Copying arrays', 2, None, '___sec47'),
              ('In-place arithmetics',
               2,
               'sec:plot:numpy:inplace',
               'sec:plot:numpy:inplace'),
              ('Allocating arrays', 2, None, '___sec49'),
              ('Generalized indexing',
               2,
               'sec:plot:generalized:index',
               'sec:plot:generalized:index'),
              ('Testing for the array type', 2, None, '___sec51'),
              ('Example: Vectorizing a constant function',
               3,
               None,
               '___sec52'),
              ('Compact syntax for array generation', 2, None, '___sec53'),
              ('Shape manipulation', 2, None, '___sec54'),
              ('High-performance computing with arrays',
               1,
               'sec:hpc',
               'sec:hpc'),
              ('Example: `axpy`', 3, None, '___sec56'),
              ('Scalar implementation',
               2,
               'sec:hpc:scalar',
               'sec:hpc:scalar'),
              ('Vectorized implementation', 2, 'sec:hpc:vec', 'sec:hpc:vec'),
              ('Memory-saving implementation',
               2,
               'sec:hpc:vec:inplace',
               'sec:hpc:vec:inplace'),
              ('Analysis of memory usage',
               2,
               'sec:hpc:vec:memory_profiler',
               'sec:hpc:vec:memory_profiler'),
              ('Analysis of the CPU time',
               2,
               'sec:hpc:vec:line_profiler',
               'sec:hpc:vec:line_profiler'),
              ('Higher-dimensional arrays',
               1,
               'sec:plot:2Darrays',
               'sec:plot:2Darrays'),
              ('Matrices and arrays', 2, None, '___sec63'),
              ('Two-dimensional numerical Python arrays',
               2,
               'sec:plot:2D:arrays',
               'sec:plot:2D:arrays'),
              ('Array computing',
               2,
               'sec:plot:array2comp',
               'sec:plot:array2comp'),
              ('Remark', 3, None, '___sec66'),
              ('Matrix objects',
               2,
               'sec:plot:numpy:matrix',
               'sec:plot:numpy:matrix'),
              ('Some common linear algebra operations', 1, None, '___sec68'),
              ('Inverse, determinant, and eigenvalues', 2, None, '___sec69'),
              ('Products', 2, None, '___sec70'),
              ('Norms', 2, None, '___sec71'),
              ('Sum and extreme values', 2, None, '___sec72'),
              ('Indexing', 2, None, '___sec73'),
              ('Transpose and upper/lower triangular parts',
               2,
               None,
               '___sec74'),
              ('Solving linear systems', 2, None, '___sec75'),
              ('Matrix row and column operations', 2, None, '___sec76'),
              ('Computing the rank of a matrix', 2, None, '___sec77'),
              ('Symbolic linear algebra', 2, None, '___sec78'),
              ('Plotting of scalar and vector fields',
               1,
               'plot:surf',
               'plot:surf'),
              ('Installation', 2, 'plot:surf:install', 'plot:surf:install'),
              ('Surface plots',
               2,
               'plot:surf:mesh_surf',
               'plot:surf:mesh_surf'),
              ('Grid for 2D scalar fields', 3, None, '___sec82'),
              ('Parameterized curve',
               2,
               'plot:surf:3Dcurve',
               'plot:surf:3Dcurve'),
              ('Contour lines',
               2,
               'plot:surf:contours',
               'plot:surf:contours'),
              ('The gradient vector field',
               2,
               'plot:surf:gradient',
               'plot:surf:gradient'),
              ('Matplotlib', 1, None, '___sec86'),
              ('Surface plots',
               2,
               'matplotlibsurfaceplots',
               'matplotlibsurfaceplots'),
              ('Contour plots',
               2,
               'matplotlibcontourplots',
               'matplotlibcontourplots'),
              ('Vector field plots',
               2,
               'plot:surf:mpl:quiver',
               'plot:surf:mpl:quiver'),
              ('Mayavi', 1, None, '___sec90'),
              ('Surface plots', 2, None, '___sec91'),
              ('Subplots', 3, None, '___sec92'),
              ('Contour plots', 2, None, '___sec93'),
              ('Vector field plots',
               2,
               'plot:surf:mayavi:quiver',
               'plot:surf:mayavi:quiver'),
              ('A 3D scalar field and its gradient field',
               2,
               None,
               '___sec95'),
              ('Animations', 2, None, '___sec96'),
              ('Summary', 1, None, '___sec97'),
              ('Chapter topics', 2, None, '___sec98'),
              ('Array computing', 3, None, '___sec99'),
              ('Plotting curves', 3, None, '___sec100'),
              ('Making movies', 3, None, '___sec101'),
              ('Terminology', 3, None, '___sec102'),
              ('Example: Animating a function',
               2,
               'sec:plot:summarizing',
               'sec:plot:summarizing'),
              ('Problem', 3, None, '___sec104'),
              ('Solution', 3, None, '___sec105'),
              ('Scaling', 3, None, '___sec106'),
              ('Exercises', 1, 'sec:plot:exer', 'sec:plot:exer'),
              ('Exercise 1: Fill lists with function values',
               2,
               'sec:plot:ex1',
               'sec:plot:ex1'),
              ('Exercise 2: Fill arrays; loop version',
               2,
               'sec:plot:ex2',
               'sec:plot:ex2'),
              ('Exercise 3: Fill arrays; vectorized version',
               2,
               'sec:plot:ex2b',
               'sec:plot:ex2b'),
              ('Exercise 4: Plot a function',
               2,
               'sec:plot:ex2c',
               'sec:plot:ex2c'),
              ('Exercise 5: Apply a function to a vector',
               2,
               'sec:plot:math:ex1',
               'sec:plot:math:ex1'),
              ('Exercise 6: Simulate by hand a vectorized expression',
               2,
               'sec:plot:ex3',
               'sec:plot:ex3'),
              ('Exercise 7: Demonstrate array slicing',
               2,
               'sec:plot:ex15d',
               'sec:plot:ex15d'),
              ('Exercise 8: Replace list operations by array computing',
               2,
               'sec:plot:ex33',
               'sec:plot:ex33'),
              ('Exercise 9: Plot a formula',
               2,
               'sec:plot:ex15',
               'sec:plot:ex15'),
              ('Exercise 10: Plot a formula for several parameters',
               2,
               'sec:plot:ex15b',
               'sec:plot:ex15b'),
              ('Exercise 11: Specify the extent of the axes in a plot',
               2,
               'sec:plot:ex15ba',
               'sec:plot:ex15ba'),
              ('Exercise 12: Plot exact and inexact Fahrenheit-Celsius conversion formulas',
               2,
               'sec:plot:ex15c',
               'sec:plot:ex15c'),
              ('Exercise 13: Plot the trajectory of a ball',
               2,
               'sec:plot:ex5',
               'sec:plot:ex5'),
              ('Exercise 14: Plot data in a two-column file',
               2,
               'sec:files:ex12',
               'sec:files:ex12'),
              ('Remarks', 3, None, '___sec122'),
              ('Exercise 15: Write function data to file',
               2,
               'sec:files:ex12e',
               'sec:files:ex12e'),
              ('Exercise 16: Plot data from a file',
               2,
               'sec:files:ex12c',
               'sec:files:ex12c'),
              ('Exercise 17: Write table to file',
               2,
               'sec:files:exer:write_table',
               'sec:files:exer:write_table'),
              ('Exercise 18: Fit a polynomial to data points',
               2,
               'sec:files:ex12c2',
               'sec:files:ex12c2'),
              ('Exercise 19: Fit a polynomial to experimental data',
               2,
               'sec:files:ex19',
               'sec:files:ex19'),
              ('Exercise 20: Read acceleration data and find velocities',
               2,
               'sec:files:ex22',
               'sec:files:ex22'),
              ('Exercise 21: Read acceleration data and plot velocities',
               2,
               'sec:files:ex23',
               'sec:files:ex23'),
              ("Exercise 22: Plot a trip's path and velocity from GPS coordinates",
               2,
               'sec:files:ex24',
               'sec:files:ex24'),
              ('Exercise 23: Vectorize the Midpoint rule for integration',
               2,
               'sec:class:exer:sum',
               'sec:class:exer:sum'),
              ('Remarks', 3, None, '___sec132'),
              ('Exercise 24: Vectorize a function for computing the area of a polygon',
               2,
               'sec:plot:exer:area:polygon:vec',
               'sec:plot:exer:area:polygon:vec'),
              ("Exercise 25: Implement Lagrange's interpolation formula",
               2,
               'sec:class:ex27a',
               'sec:class:ex27a'),
              ("Exercise 26: Plot Lagrange's interpolating polynomial",
               2,
               'sec:class:ex27b',
               'sec:class:ex27b'),
              ("Exercise 27: Investigate the behavior of Lagrange's interpolating polynomials",
               2,
               'sec:class:ex27c',
               'sec:class:ex27c'),
              ('Remarks', 3, None, '___sec137'),
              ('Exercise 28: Plot a wave packet',
               2,
               'sec:plot:ex5d',
               'sec:plot:ex5d'),
              ('Exercise 29: Judge a plot',
               2,
               'sec:plot:ex7',
               'sec:plot:ex7'),
              ('Exercise 30: Plot the viscosity of water',
               2,
               'sec:plot:ex13c',
               'sec:plot:ex13c'),
              ('Exercise 31: Explore a complicated function graphically',
               2,
               'sec:plot:ex16',
               'sec:plot:ex16'),
              ('Exercise 32: Plot Taylor polynomial approximations to $\\sin x$',
               2,
               'sec:plot:ex5b',
               'sec:plot:ex5b'),
              ('Exercise 33: Animate a wave packet',
               2,
               'sec:plot:ex5e',
               'sec:plot:ex5e'),
              ('Exercise 34: Animate a smoothed Heaviside function',
               2,
               'sec:plot:ex32',
               'sec:plot:ex32'),
              ('Exercise 35: Animate two-scale temperature variations',
               2,
               'sec:plot:ex18',
               'sec:plot:ex18'),
              ('Remarks', 3, None, '___sec146'),
              ('Exercise 36: Use non-uniformly distributed coordinates for visualization',
               2,
               'sec:plot:ex19',
               'sec:plot:ex19'),
              ('Exercise 37: Animate a sequence of approximations to $\\pi$',
               2,
               'sec:plot:ex31',
               'sec:plot:ex31'),
              ("Exercise 38: Animate a planet's orbit",
               2,
               'sec:plot:ex5g',
               'sec:plot:ex5g'),
              ('Exercise 39: Animate the evolution of Taylor polynomials',
               2,
               'sec:plot:ex17',
               'sec:plot:ex17'),
              ('Exercise 40: Plot the velocity profile for pipeflow',
               2,
               'sec:plot:ex4',
               'sec:plot:ex4'),
              ('Exercise 41: Plot sum-of-sines approximations to a function',
               2,
               'sec:plot:ex8',
               'sec:plot:ex8'),
              ('Exercise 42: Animate the evolution of a sum-of-sine approximation to a function',
               2,
               'sec:plot:ex8m',
               'sec:plot:ex8m'),
              ('Exercise 43: Plot functions from the command line',
               2,
               'sec:plot:ex14',
               'sec:plot:ex14'),
              ('Exercise 44: Improve command-line input',
               2,
               'sec:plot:ex14b',
               'sec:plot:ex14b'),
              ('Exercise 45: Demonstrate energy concepts from physics',
               2,
               'sec:plot:ex20',
               'sec:plot:ex20'),
              ('Exercise 46: Plot a w-like function',
               2,
               'sec:plot:math:ex9',
               'sec:plot:math:ex9'),
              ('Exercise 47: Plot a piecewise constant function',
               2,
               'sec:basic:exH4plot',
               'sec:basic:exH4plot'),
              ('Exercise 48: Vectorize a piecewise constant function',
               2,
               'sec:basic:exH4vecz1',
               'sec:basic:exH4vecz1'),
              ('Remarks', 3, None, '___sec160'),
              ('Exercise 49: Visualize approximations in the Midpoint integration rule',
               2,
               'sec:plot:ex:vizmidpoint',
               'sec:plot:ex:vizmidpoint'),
              ('Exercise 50: Visualize approximations in the Trapezoidal integration rule',
               2,
               'sec:plot:ex:viztrapezoidal',
               'sec:plot:ex:viztrapezoidal'),
              ('Exercise 51: Experience overflow in a function',
               2,
               'sec:plot:ex13',
               'sec:plot:ex13'),
              ('Remarks', 3, None, '___sec164'),
              ('Exercise 52: Apply a function to a rank 2 array',
               2,
               'sec:plot:math:ex2',
               'sec:plot:math:ex2'),
              ('Exercise 53: Explain why array computations fail',
               2,
               'sec:plot:ex11',
               'sec:plot:ex11'),
              ('Exercise 54: Verify linear algebra results',
               2,
               'plot:linalg:exer:verify',
               'plot:linalg:exer:verify'),
              ('References', 1, None, '___sec168')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="plot-bootstrap.html">Array computing and curve plotting</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._plot-bootstrap000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap001.html#___sec0" style="font-size: 80%;"><b>Vectors</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap001.html#___sec1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The vector concept</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap001.html#sec:plot:vectors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical operations on vectors</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap001.html#sec:plot:arraycomp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector arithmetics and vector functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap002.html#___sec4" style="font-size: 80%;"><b>Arrays in Python programs</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap002.html#sec:plot:listdata" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Using lists for collecting function data</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap002.html#sec:plot:array:basics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Basics of numerical Python arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap002.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing coordinates and function values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap002.html#sec:plot:vectorization" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#sec:plot:curveplots" style="font-size: 80%;"><b>Curve plotting</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#sec:plot:pylab" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;MATLAB-style plotting with Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A basic plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decorating the plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting multiple curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Placing several plots in one figure</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#sec:plot:pyplot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matplotlib; pyplot prefix</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#sec:plot:SciTools" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;SciTools and Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Importing SciTools and Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A basic plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decorating the plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting multiple curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changing backend</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Placing several plots in one figure</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other plotting alternatives</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#easyviz:movie" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Making animations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Animation in Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic animation in Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using FuncAnimation in Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#sec:plot:video" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Making videos</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Animated GIF file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MP4, Ogg, WebM, and Flash videos</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap003.html#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Curve plots in pure text</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap004.html#sec:plot:difficulties" style="font-size: 80%;"><b>Plotting difficulties</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap004.html#sec:plot:pwisefunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Piecewisely defined functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap004.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: The Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap004.html#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: A hat function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap004.html#sec:plot:sin1x" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rapidly varying functions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:if:vectorize" style="font-size: 80%;"><b>More advanced vectorization of functions</b></a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:StringFunction:vectorize" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of StringFunction objects</a></li>
     <!-- navigation toc: --> <li><a href="#sec:vec:Heaviside" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of the Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="#___sec41" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loop</a></li>
     <!-- navigation toc: --> <li><a href="#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatic vectorization</a></li>
     <!-- navigation toc: --> <li><a href="#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mixing boolean and floating-point calculations</a></li>
     <!-- navigation toc: --> <li><a href="#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Manual vectorization</a></li>
     <!-- navigation toc: --> <li><a href="#sec:vec:hatfunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of a hat function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:plot:numpy:more" style="font-size: 80%;"><b>More on numerical Python arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Copying arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:plot:numpy:inplace" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;In-place arithmetics</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Allocating arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:plot:generalized:index" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Generalized indexing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec51" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Testing for the array type</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Vectorizing a constant function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec53" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compact syntax for array generation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Shape manipulation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc" style="font-size: 80%;"><b>High-performance computing with arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: <code>axpy</code></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc:scalar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Scalar implementation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc:vec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorized implementation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc:vec:inplace" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Memory-saving implementation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc:vec:memory_profiler" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of memory usage</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap006.html#sec:hpc:vec:line_profiler" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of the CPU time</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#sec:plot:2Darrays" style="font-size: 80%;"><b>Higher-dimensional arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrices and arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#sec:plot:2D:arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-dimensional numerical Python arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#sec:plot:array2comp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#sec:plot:numpy:matrix" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrix objects</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec68" style="font-size: 80%;"><b>Some common linear algebra operations</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Inverse, determinant, and eigenvalues</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Products</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Norms</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Sum and extreme values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec73" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Indexing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec74" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Transpose and upper/lower triangular parts</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec75" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving linear systems</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrix row and column operations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing the rank of a matrix</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Symbolic linear algebra</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf" style="font-size: 80%;"><b>Plotting of scalar and vector fields</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:install" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Installation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:mesh_surf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grid for 2D scalar fields</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:3Dcurve" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Parameterized curve</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:contours" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour lines</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:gradient" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The gradient vector field</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec86" style="font-size: 80%;"><b>Matplotlib</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#matplotlibsurfaceplots" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#matplotlibcontourplots" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:mpl:quiver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector field plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec90" style="font-size: 80%;"><b>Mayavi</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subplots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec93" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#plot:surf:mayavi:quiver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector field plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec95" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A 3D scalar field and its gradient field</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap007.html#___sec96" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Animations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec97" style="font-size: 80%;"><b>Summary</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec98" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Chapter topics</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec99" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec100" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec101" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making movies</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec102" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Terminology</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#sec:plot:summarizing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Animating a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap008.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:exer" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Fill lists with function values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Fill arrays; loop version</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex2b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Fill arrays; vectorized version</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex2c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Plot a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:math:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Apply a function to a vector</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Simulate by hand a vectorized expression</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex15d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Demonstrate array slicing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Replace list operations by array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Plot a formula</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex15b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Plot a formula for several parameters</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex15ba" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 11: Specify the extent of the axes in a plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex15c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 12: Plot exact and inexact Fahrenheit-Celsius conversion formulas</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 13: Plot the trajectory of a ball</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 14: Plot data in a two-column file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec122" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex12e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 15: Write function data to file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex12c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 16: Plot data from a file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:exer:write_table" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 17: Write table to file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex12c2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 18: Fit a polynomial to data points</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 19: Fit a polynomial to experimental data</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 20: Read acceleration data and find velocities</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 21: Read acceleration data and plot velocities</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:files:ex24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 22: Plot a trip's path and velocity from GPS coordinates</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:class:exer:sum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 23: Vectorize the Midpoint rule for integration</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec132" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:exer:area:polygon:vec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 24: Vectorize a function for computing the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:class:ex27a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 25: Implement Lagrange's interpolation formula</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:class:ex27b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 26: Plot Lagrange's interpolating polynomial</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:class:ex27c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 27: Investigate the behavior of Lagrange's interpolating polynomials</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec137" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex5d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 28: Plot a wave packet</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 29: Judge a plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex13c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 30: Plot the viscosity of water</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 31: Explore a complicated function graphically</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex5b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 32: Plot Taylor polynomial approximations to \( \sin x \)</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex5e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 33: Animate a wave packet</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 34: Animate a smoothed Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 35: Animate two-scale temperature variations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 36: Use non-uniformly distributed coordinates for visualization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 37: Animate a sequence of approximations to \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex5g" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 38: Animate a planet's orbit</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 39: Animate the evolution of Taylor polynomials</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 40: Plot the velocity profile for pipeflow</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 41: Plot sum-of-sines approximations to a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex8m" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 42: Animate the evolution of a sum-of-sine approximation to a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 43: Plot functions from the command line</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex14b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 44: Improve command-line input</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 45: Demonstrate energy concepts from physics</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:math:ex9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 46: Plot a w-like function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:basic:exH4plot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 47: Plot a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:basic:exH4vecz1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 48: Vectorize a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec160" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex:vizmidpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 49: Visualize approximations in the Midpoint integration rule</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex:viztrapezoidal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 50: Visualize approximations in the Trapezoidal integration rule</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 51: Experience overflow in a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:math:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 52: Apply a function to a rank 2 array</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#sec:plot:ex11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 53: Explain why array computations fail</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#plot:linalg:exer:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 54: Verify linear algebra results</a></li>
     <!-- navigation toc: --> <li><a href="._plot-bootstrap009.html#___sec168" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0005"></a>
<!-- !split -->
<p style="font-size:80%">This chapter is taken from the book <a href="http://www.springer.com/gp/book/9783662498866">A Primer on Scientific Programming with Python</a> by H. P. Langtangen, 5th edition, Springer, 2016.</p>

<h1 id="sec:plot:if:vectorize" class="anchor">More advanced vectorization of functions</h1>

<p>
So far we have seen that vectorization of a Python function <code>f(x)</code>
implementing some mathematical function \( f(x) \) seems trivial: <code>f(x)</code>
works right away with an array argument <code>x</code> and, in that case, returns
an array where \( f \) is applied to each element in <code>x</code>.  When the
expression for \( f(x) \) is given in terms of a string and the
<code>StringFunction</code> tool is used to generate the corresponding Python
function <code>f(x)</code>, one extra step must be performed to vectorize the
Python function. This step is explained in the section <a href="#sec:plot:StringFunction:vectorize">Vectorization of StringFunction objects</a>.

<p>
The described vectorization works well as long as the expression
\( f(x) \) is a mathematical formula without any <code>if</code> test. As soon as we
have <code>if</code> tests (conditional mathematical expressions) the
vectorization becomes more challenging.  Some useful techniques are
explained through two examples in the sections <a href="#sec:vec:Heaviside">Vectorization of the Heaviside function</a> and
<a href="#sec:vec:hatfunc">Vectorization of a hat function</a>.  The described techniques are considered
advanced material and only necessary when the time spent on evaluating
a function at a very large set of points needs to be significantly
decreased.

<h2 id="sec:plot:StringFunction:vectorize" class="anchor">Vectorization of StringFunction objects</h2>

<p>
The <code>StringFunction</code> object from <code>scitools.std</code> can convert a formula,
available as a string, to a callable Python function (see the
document <a href="http://hplgit.github.io/primer.html/doc/pub/input" target="_self">User input and error handling</a>
<a href="._plot-bootstrap009.html#Langtangen_TCSE6_input">[3]</a>).  However, the function cannot work
with array arguments unless we explicitly tell the <code>StringFunction</code>
object to do so. The recipe is very simple. Say <code>f</code> is some
<code>StringFunction</code> object.  To allow array arguments we are required to
call <code>f.vectorize(globals())</code> once:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
x <span style="color: #666666">=</span> linspace(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">30</span>)
<span style="color: #408080; font-style: italic"># f(x) will in general not work</span>

f<span style="color: #666666">.</span>vectorize(<span style="color: #008000">globals</span>())
values <span style="color: #666666">=</span> f(x)            <span style="color: #408080; font-style: italic"># f works with array arguments</span>
</pre></div>
<p>
It is important that you import everything from <code>numpy</code> (or
<code>scitools.std</code>) <em>before</em> calling <code>f.vectorize</code>, exactly as shown.

<p>
You may take the <code>f.vectorize</code> call as a magic recipe.  Still, some
readers want to know what problem <code>f.vectorize</code> solves. Inside the
<code>StringFunction</code> module we need to have access to mathematical
functions for expressions like <code>sin(x)*exp(x)</code> to be evaluated. These
mathematical functions are by default taken from the <code>math</code> module and
hence they do not work with array arguments.  If the user, in the main
program, has imported mathematical functions that work with array
arguments, these functions are registered in a dictionary returned
from <code>globals()</code>. By the <code>f.vectorize</code> call we supply the
<code>StringFunction</code> module with the user's global namespace so that the
evaluation of the string expression can make use of the mathematical
functions for arrays from the user's program.  Unless you use
<code>np.sin(x)*np.cos(x)</code> etc. in the string formulas, make sure you do a
<code>from numpy import *</code> so that the function names are defined without
any prefix.

<p>
Even after calling <code>f.vectorize(globals())</code>, a <code>StringFunction</code> object
may face problems with vectorization. One example is a piecewise
constant function as specified by a string expression <code>'1 if x &gt; 2
else 0'</code>. The section <a href="#sec:vec:Heaviside">Vectorization of the Heaviside function</a> explains why <code>if</code> tests fail
for arrays and what the remedies are.

<h2 id="sec:vec:Heaviside" class="anchor">Vectorization of the Heaviside function</h2>

<p>
We consider the widely used Heaviside function defined by

$$
\begin{equation*}
H(x) = \left\lbrace\begin{array}{ll}
0, & x < 0\\ 
1, & x\geq 0
\end{array}\right.
\end{equation*}
$$

The most compact way if implementing this function is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>)
</pre></div>
<p>
Trying to call <code>H(x)</code> with an array argument <code>x</code>
fails:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H</span>(x): <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>)
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-10</span>, <span style="color: #666666">10</span>, <span style="color: #666666">5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> x
array([<span style="color: #666666">-10.</span>,  <span style="color: #666666">-5.</span>,   <span style="color: #666666">0.</span>,   <span style="color: #666666">5.</span>,  <span style="color: #666666">10.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> H(x)
<span style="color: #666666">...</span>
<span style="color: #D2413A; font-weight: bold">ValueError</span>: The truth value of an array <span style="color: #008000; font-weight: bold">with</span> more than
one element <span style="color: #AA22FF; font-weight: bold">is</span> ambiguous<span style="color: #666666">.</span> Use a<span style="color: #666666">.</span>any() <span style="color: #AA22FF; font-weight: bold">or</span> a<span style="color: #666666">.</span>all()
</pre></div>
<p>
The problem is related to the test <code>x &lt; 0</code>, which results
in an array of boolean values, while the <code>if</code> test needs a
single boolean value (essentially taking <code>bool(x &lt; 0)</code>):

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b
array([ <span style="color: #008000">True</span>,  <span style="color: #008000">True</span>, <span style="color: #008000">False</span>, <span style="color: #008000">False</span>, <span style="color: #008000">False</span>], dtype<span style="color: #666666">=</span><span style="color: #008000">bool</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">bool</span>(b)  <span style="color: #408080; font-style: italic"># evaluate b in a boolean context</span>
<span style="color: #666666">...</span>
<span style="color: #D2413A; font-weight: bold">ValueError</span>: The truth value of an array <span style="color: #008000; font-weight: bold">with</span> more than
one element <span style="color: #AA22FF; font-weight: bold">is</span> ambiguous<span style="color: #666666">.</span> Use a<span style="color: #666666">.</span>any() <span style="color: #AA22FF; font-weight: bold">or</span> a<span style="color: #666666">.</span>all()
<span style="color: #666666">&gt;&gt;&gt;</span> b<span style="color: #666666">.</span>any()  <span style="color: #408080; font-style: italic"># True if any element in b is True</span>
<span style="color: #008000">True</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b<span style="color: #666666">.</span>all()  <span style="color: #408080; font-style: italic"># True if all elements in b are True</span>
<span style="color: #008000">False</span>
</pre></div>
<p>
The <code>any</code> and <code>all</code> calls do not help us since we
want to take actions element by element depending on whether
<code>x[i] &lt; 0</code> or not.

<p>
There are four ways to find a remedy to our problems with the <code>if x &lt;
0</code> test: (i) we can write an explicit loop for computing the elements,
(ii) we can use a tool for automatically vectorize <code>H(x)</code>, (iii) we
can mix boolean and floating-point calculations, or (iv) we can
manually vectorize the <code>H(x)</code> function.  All four methods will be
illustrated next.

<h3 id="___sec41" class="anchor">Loop </h3>

<p>
The following function works well for arrays if we insert
a simple loop over the array elements (such that <code>H(x)</code> operates
on scalars only):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H_loop</span>(x):
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #008000">len</span>(x))
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">xrange</span>(<span style="color: #008000">len</span>(x)):
        r[i] <span style="color: #666666">=</span> H(x[i])
    <span style="color: #008000; font-weight: bold">return</span> r

<span style="color: #408080; font-style: italic"># Example:</span>
x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-5</span>, <span style="color: #666666">5</span>, <span style="color: #666666">6</span>)
y <span style="color: #666666">=</span> H_loop(x)
</pre></div>

<h3 id="___sec42" class="anchor">Automatic vectorization </h3>

<p>
Numerical Python contains a method for automatically vectorizing
a Python function <code>H(x)</code> that works with scalars
(pure numbers) as <code>x</code> argument:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
H_vec <span style="color: #666666">=</span> np<span style="color: #666666">.</span>vectorize(H)
</pre></div>
<p>
The <code>H_vec(x)</code> function will now work with vector/array arguments
<code>x</code>. Unfortunately, such automatically vectorized functions runs
at a fairly slow speed compared to the implementations below
(see the end of the section <a href="#sec:vec:hatfunc">Vectorization of a hat function</a> for specific timings).

<h3 id="___sec43" class="anchor">Mixing boolean and floating-point calculations </h3>

<p>
It appears that a very simple solution to vectorizing the <code>H(x)</code>
function is to implement it as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>
</pre></div>
<p>
The return value is now a <code>bool</code> object, not an <code>int</code> or <code>float</code> as we
would mathematically expect to be the proper type of the
result. However, the <code>bool</code> object works well in both scalar and
vectorized operations as long as we involve the returned <code>H(x)</code> in
some arithmetic expression. The <code>True</code> and <code>False</code> values are then
interpreted as 1 and 0. Here is a demonstration:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> H(x)
array([<span style="color: #008000">False</span>, <span style="color: #008000">False</span>,  <span style="color: #008000">True</span>,  <span style="color: #008000">True</span>,  <span style="color: #008000">True</span>], dtype<span style="color: #666666">=</span><span style="color: #008000">bool</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">1*</span>H(x)
array([<span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> H(x) <span style="color: #666666">-</span> <span style="color: #666666">2</span>
array([<span style="color: #666666">-2</span>, <span style="color: #666666">-2</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">-1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> <span style="color: #666666">0.2</span>   <span style="color: #408080; font-style: italic"># test scalar argument</span>
<span style="color: #666666">&gt;&gt;&gt;</span> H(x)
<span style="color: #008000">True</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">1*</span>H(x)
<span style="color: #666666">1</span>
<span style="color: #666666">&gt;&gt;&gt;</span> H(x) <span style="color: #666666">-</span> <span style="color: #666666">2</span>
<span style="color: #666666">-1</span>
</pre></div>
<p>
If returning a boolean value is considered undesirable, we can turn
the <code>bool</code> object into the proper type by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">H</span>(x):
    r <span style="color: #666666">=</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(x, (<span style="color: #008000">int</span>,<span style="color: #008000">float</span>)):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">int</span>(r)
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #008000">isinstance</span>(x, np<span style="color: #666666">.</span>ndarray):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>asarray(r, dtype<span style="color: #666666">=</span>np<span style="color: #666666">.</span>int)
</pre></div>

<h3 id="___sec44" class="anchor">Manual vectorization </h3>

<p>
By manual vectorization we normally mean translating the algorithm
into a set of calls to functions in the <code>numpy</code> package such that no
loops are visible in the Python code. The last version of the <code>H(x)</code>
is a manual vectorization, but now we shall look at a more general
technique when the result is not necessarily 0 or 1.  In general,
manual vectorization is non-trivial and requires knowledge of and
experience with the underlying library for array computations.
Fortunately, there is a simple <code>numpy</code> recipe for turning functions of
the form

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">if</span> condition:
        r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression1<span style="color: #666666">&gt;</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression2<span style="color: #666666">&gt;</span>
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
into vectorized form:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f_vectorized</span>(x):
    x1 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression1<span style="color: #666666">&gt;</span>
    x2 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression2<span style="color: #666666">&gt;</span>
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition, x1, x2)
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
The <code>np.where</code> function returns an array of the same length as
<code>condition</code>, whose % (for one-dimensional arrays <code>x1</code> and <code>x2</code>)
element no. <code>i</code> equals <code>x1[i]</code> if <code>condition[i]</code> is <code>True</code>, and
<code>x2[i]</code> otherwise.  With Python loops we can express this principle as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">my_where</span>(condition, x1, x2):
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #008000">len</span>(condition))   <span style="color: #408080; font-style: italic"># result</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">xrange</span>(condition):
        r[i] <span style="color: #666666">=</span> x1[i] <span style="color: #008000; font-weight: bold">if</span> condition[i] <span style="color: #008000; font-weight: bold">else</span> x2[i]
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
The <code>x1</code> and <code>x2</code> variables can be pure numbers too in the call
to <code>np.where</code>.

<p>
In our case we can use the <code>np.where</code> function as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Hv</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>where(x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>, <span style="color: #666666">0.0</span>, <span style="color: #666666">1.0</span>)
</pre></div>
<p>
Instead of using <code>np.where</code> we can apply <em>boolean indexing</em>.  The idea
is that an array <code>a</code> allows to be indexed by an array <code>b</code> of boolean
values: <code>a[b]</code>.  The result <code>a[b]</code> is a new array with all the
elements <code>a[i]</code> where <code>b[i]</code> is <code>True</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">0.</span> ,   <span style="color: #666666">2.5</span>,   <span style="color: #666666">5.</span> ,   <span style="color: #666666">7.5</span>,  <span style="color: #666666">10.</span> ])
<span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> a <span style="color: #666666">&gt;</span> <span style="color: #666666">5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> b
array([<span style="color: #008000">False</span>, <span style="color: #008000">False</span>, <span style="color: #008000">False</span>,  <span style="color: #008000">True</span>,  <span style="color: #008000">True</span>], dtype<span style="color: #666666">=</span><span style="color: #008000">bool</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a[b]
array([  <span style="color: #666666">7.5</span>,  <span style="color: #666666">10.</span> ])
</pre></div>
<p>
We can assign new values to the elements in <code>a</code> where <code>b</code> is <code>True</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a[b]
array([  <span style="color: #666666">7.5</span>,  <span style="color: #666666">10.</span> ])
<span style="color: #666666">&gt;&gt;&gt;</span> a[b] <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">-10</span>, <span style="color: #666666">-20</span>], dtype<span style="color: #666666">=</span>np<span style="color: #666666">.</span>float)
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">0.</span> ,   <span style="color: #666666">2.5</span>,   <span style="color: #666666">5.</span> , <span style="color: #666666">-10.</span> , <span style="color: #666666">-20.</span> ])
<span style="color: #666666">&gt;&gt;&gt;</span> a[b] <span style="color: #666666">=</span> <span style="color: #666666">-4</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([ <span style="color: #666666">0.</span> ,  <span style="color: #666666">2.5</span>,  <span style="color: #666666">5.</span> , <span style="color: #666666">-4.</span> , <span style="color: #666666">-4.</span> ])
</pre></div>
<p>
To implement the Heaviside function, we start with an array of zeros
and then assign 1 to the elements where <code>x &gt;= 0</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Hv</span>(x):
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #008000">len</span>(x), dtype<span style="color: #666666">=</span>np<span style="color: #666666">.</span>int)
    r[x <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span>] <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>

<h2 id="sec:vec:hatfunc" class="anchor">Vectorization of a hat function</h2>

<p>
We now turn the attention to the hat function \( N(x) \) defined by

$$
\begin{equation*}
N(x) = \left\lbrace\begin{array}{ll}
0, & x < 0\\ 
x, & 0\leq x < 1\\ 
2-x, & 1\leq x < 2\\ 
0, & x \geq 2
\end{array}\right.
\end{equation*}
$$

The corresponding Python implementation <code>N(x)</code> is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">N</span>(x):
    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.0</span>
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">1</span>:
        <span style="color: #008000; font-weight: bold">return</span> x
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">2</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2</span> <span style="color: #666666">-</span> x
    <span style="color: #008000; font-weight: bold">elif</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.0</span>
</pre></div>
<p>
Unfortunately, this <code>N(x)</code> function does not work with array arguments
<code>x</code>, because the boolean expressions, like <code>x &lt; 0</code>, are arrays and
they cannot yield a single <code>True</code> or <code>False</code> value for the <code>if</code> tests,
as explained in the section <a href="#sec:vec:Heaviside">Vectorization of the Heaviside function</a>.

<p>
The simplest remedy is to use <code>np.vectorize</code> from the section <a href="#sec:vec:Heaviside">Vectorization of the Heaviside function</a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>N_vec <span style="color: #666666">=</span> np<span style="color: #666666">.</span>vectorize(N)
</pre></div>
<p>
It is then important that <code>N(x)</code> returns <code>float</code> and not <code>int</code> values,
otherwise the vectorized version will produce <code>int</code> values and hence
be incorrect.

<p>
A manual rewrite, yielding a faster vectorized function, is more
demanding than for the Heaviside function because we now have multiple
branches in the <code>if</code> test.  One sketch is to replace

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">if</span> condition1:
   r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression1<span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition2:
   r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression2<span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">elif</span> condition3:
   r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression3<span style="color: #666666">&gt;</span>
<span style="color: #008000; font-weight: bold">else</span>:
   r <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression4<span style="color: #666666">&gt;</span>
</pre></div>
<p>
by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>x1 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression1<span style="color: #666666">&gt;</span>
x2 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression2<span style="color: #666666">&gt;</span>
x3 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression3<span style="color: #666666">&gt;</span>
x4 <span style="color: #666666">=</span> <span style="color: #666666">&lt;</span>expression4<span style="color: #666666">&gt;</span>
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition1, x1, x4)  <span style="color: #408080; font-style: italic"># initialize with &quot;else&quot; expr.</span>
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition2, x2, r)
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition3, x3, r)
</pre></div>
<p>
Alternatively, we can use boolean indexing. Assuming that
<code>&lt;expressionX&gt;</code> is some expression involving an array <code>x</code> and coded as
a Python function <code>fX(x)</code> (<code>X</code> is <code>1</code>, <code>2</code>, <code>3</code>, or <code>4</code>), we can write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>r <span style="color: #666666">=</span> f4(x)
r[condition1] <span style="color: #666666">=</span> f1(x[condition1])
r[condition2] <span style="color: #666666">=</span> f2(x[condition2])
r[condition3] <span style="color: #666666">=</span> f2(x[condition3])
</pre></div>
<p>
Specifically, when the function for scalar arguments <code>x</code> reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">N</span>(x):
    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.0</span>
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">1</span>:
        <span style="color: #008000; font-weight: bold">return</span> x
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #666666">1</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">2</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2</span> <span style="color: #666666">-</span> x
    <span style="color: #008000; font-weight: bold">elif</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.0</span>
</pre></div>
<p>
a vectorized attempt would be

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Nv</span>(x):
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>,      <span style="color: #666666">0.0</span>,  <span style="color: #666666">0.0</span>)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(<span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">1</span>, x,    r)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(<span style="color: #666666">1</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">2</span>, <span style="color: #666666">2-</span>x,  r)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(x <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>,     <span style="color: #666666">0.0</span>,  r)
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
The first and last line are not strictly necessary as we could just
start with a zero vector (making the insertion of zeros for the first
and last condition a redundant operation).

<p>
However, any condition like <code>0 &lt;= x &lt; 1</code>, which is equivalent to <code>0 &lt;=
x and x &lt; 1</code>, does not work because the <code>and</code> operator does not work
with array arguments. Fortunately, there is a simple solution to this
problem: the function <code>logical_and</code> in <code>numpy</code>.  A working <code>Nv</code>
function must apply <code>logical_and</code> instead in each condition:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Nv1</span>(x):
    condition1 <span style="color: #666666">=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>
    condition2 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logical_and(<span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x, x <span style="color: #666666">&lt;</span> <span style="color: #666666">1</span>)
    condition3 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logical_and(<span style="color: #666666">1</span> <span style="color: #666666">&lt;=</span> x, x <span style="color: #666666">&lt;</span> <span style="color: #666666">2</span>)
    condition4 <span style="color: #666666">=</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>

    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition1, <span style="color: #666666">0.0</span>, <span style="color: #666666">0.0</span>)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition2, x,   r)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition3, <span style="color: #666666">2-</span>x, r)
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>where(condition4, <span style="color: #666666">0.0</span>, r)
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
With boolean indexing we get the alternative form

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Nv2</span>(x):
    condition1 <span style="color: #666666">=</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>
    condition2 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logical_and(<span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x, x <span style="color: #666666">&lt;</span> <span style="color: #666666">1</span>)
    condition3 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logical_and(<span style="color: #666666">1</span> <span style="color: #666666">&lt;=</span> x, x <span style="color: #666666">&lt;</span> <span style="color: #666666">2</span>)
    condition4 <span style="color: #666666">=</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">2</span>

    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(<span style="color: #008000">len</span>(x))
    r[condition1] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    r[condition2] <span style="color: #666666">=</span> x[condition2]
    r[condition3] <span style="color: #666666">=</span> <span style="color: #666666">2-</span>x[condition3]
    r[condition4] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
Again, the first and last assignment to <code>r</code> can be omitted in this
special case where we start with a zero vector.

<p>
The file <a href="http://tinyurl.com/pwyasaa/plot/hat.py" target="_self"><tt>hat.py</tt></a>
implements four vectorized versions of the <code>N(x)</code>
function: <code>N_loop</code>, which is a plain loop calling up <code>N(x)</code> for each
<code>x[i]</code> element in the array <code>x</code>; <code>N_vec</code>, which is the result of
automatic vectorization via <code>np.vectorize</code>; the <code>Nv1</code> function shown
above, which uses the <code>np.where</code> constructions; and the <code>Nv2</code> function,
which uses boolean indexing. With a length of <code>x</code> of 1,000,000, the
results on my computer (MacBook Air 11'', 2 1.6GHz Intel CPU, running
Ubuntu 12.04 in a VMWare virtual machine) became 4.8 s for <code>N_loop</code>, 1
s <code>N_vec</code>, 0.3 s for <code>Nv1</code>, and 0.08 s for <code>Nv2</code>. Boolean indexing is
clearly the fastest method.

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._plot-bootstrap004.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._plot-bootstrap006.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

