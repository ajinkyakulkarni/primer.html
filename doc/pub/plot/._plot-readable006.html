<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Array computing and curve plotting">
<meta name="keywords" content="vectors,vector computing,scalar (math quantity),heterogeneous lists,Numerical Python,NumPy,array (datatype),array computing,vectorization,array slicing,subarrays,allocate,vectorization,scalar code,curve plotting,plotting,making graphs,backend (Easyviz),backend (Easyviz),remove files (in Python),delete files (in Python),boolean indexing,boolean indexing,in-place array arithmetics,check an object's type,shape (of an array),array shape,matrix,shape (of an array),array shape,eigenvalues,eigenvectors,inverse,determinant,rank of a matrix,least squares approximation,Trapezoidal rule for integration,Lagrange's interpolation formula,interpolation,Midpoint rule for integration,Trapezoidal rule for integration">

<title>Array computing and curve plotting</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}

body { font-size:20px;line-height:1.5--html_body_style=font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Vectors', 1, None, '___sec0'),
              ('The vector concept', 2, None, '___sec1'),
              ('Mathematical operations on vectors',
               2,
               'sec:plot:vectors',
               'sec:plot:vectors'),
              ('Vector arithmetics and vector functions',
               2,
               'sec:plot:arraycomp',
               'sec:plot:arraycomp'),
              ('Arrays in Python programs', 1, None, '___sec4'),
              ('Using lists for collecting function data',
               2,
               'sec:plot:listdata',
               'sec:plot:listdata'),
              ('Basics of numerical Python arrays',
               2,
               'sec:plot:array:basics',
               'sec:plot:array:basics'),
              ('Computing coordinates and function values',
               2,
               None,
               '___sec7'),
              ('Vectorization',
               2,
               'sec:plot:vectorization',
               'sec:plot:vectorization'),
              ('Curve plotting',
               1,
               'sec:plot:curveplots',
               'sec:plot:curveplots'),
              ('MATLAB-style plotting with Matplotlib',
               2,
               'sec:plot:pylab',
               'sec:plot:pylab'),
              ('A basic plot', 3, None, '___sec11'),
              ('Decorating the plot', 3, None, '___sec12'),
              ('Plotting multiple curves', 3, None, '___sec13'),
              ('Placing several plots in one figure', 3, None, '___sec14'),
              ('Matplotlib; pyplot prefix',
               2,
               'sec:plot:pyplot',
               'sec:plot:pyplot'),
              ('SciTools and Easyviz',
               2,
               'sec:plot:SciTools',
               'sec:plot:SciTools'),
              ('Importing SciTools and Easyviz', 3, None, '___sec17'),
              ('A basic plot', 3, None, '___sec18'),
              ('Decorating the plot', 3, None, '___sec19'),
              ('Plotting multiple curves', 3, None, '___sec20'),
              ('Changing backend', 3, None, '___sec21'),
              ('Placing several plots in one figure', 3, None, '___sec22'),
              ('Other plotting alternatives', 3, None, '___sec23'),
              ('Making animations', 2, 'easyviz:movie', 'easyviz:movie'),
              ('Example', 3, None, '___sec25'),
              ('Animation in Easyviz', 3, None, '___sec26'),
              ('Basic animation in Matplotlib', 3, None, '___sec27'),
              ('Using FuncAnimation in Matplotlib', 3, None, '___sec28'),
              ('Making videos', 2, 'sec:plot:video', 'sec:plot:video'),
              ('Animated GIF file', 3, None, '___sec30'),
              ('MP4, Ogg, WebM, and Flash videos', 3, None, '___sec31'),
              ('Curve plots in pure text', 2, None, '___sec32'),
              ('Plotting difficulties',
               1,
               'sec:plot:difficulties',
               'sec:plot:difficulties'),
              ('Piecewisely defined functions',
               2,
               'sec:plot:pwisefunc',
               'sec:plot:pwisefunc'),
              ('Example: The Heaviside function', 3, None, '___sec35'),
              ('Example: A hat function', 3, None, '___sec36'),
              ('Rapidly varying functions',
               2,
               'sec:plot:sin1x',
               'sec:plot:sin1x'),
              ('More advanced vectorization of functions',
               1,
               'sec:plot:if:vectorize',
               'sec:plot:if:vectorize'),
              ('Vectorization of StringFunction objects',
               2,
               'sec:plot:StringFunction:vectorize',
               'sec:plot:StringFunction:vectorize'),
              ('Vectorization of the Heaviside function',
               2,
               'sec:vec:Heaviside',
               'sec:vec:Heaviside'),
              ('Loop', 3, None, '___sec41'),
              ('Automatic vectorization', 3, None, '___sec42'),
              ('Mixing boolean and floating-point calculations',
               3,
               None,
               '___sec43'),
              ('Manual vectorization', 3, None, '___sec44'),
              ('Vectorization of a hat function',
               2,
               'sec:vec:hatfunc',
               'sec:vec:hatfunc'),
              ('More on numerical Python arrays',
               1,
               'sec:plot:numpy:more',
               'sec:plot:numpy:more'),
              ('Copying arrays', 2, None, '___sec47'),
              ('In-place arithmetics',
               2,
               'sec:plot:numpy:inplace',
               'sec:plot:numpy:inplace'),
              ('Allocating arrays', 2, None, '___sec49'),
              ('Generalized indexing',
               2,
               'sec:plot:generalized:index',
               'sec:plot:generalized:index'),
              ('Testing for the array type', 2, None, '___sec51'),
              ('Example: Vectorizing a constant function',
               3,
               None,
               '___sec52'),
              ('Compact syntax for array generation', 2, None, '___sec53'),
              ('Shape manipulation', 2, None, '___sec54'),
              ('High-performance computing with arrays',
               1,
               'sec:hpc',
               'sec:hpc'),
              ('Example: `axpy`', 3, None, '___sec56'),
              ('Scalar implementation',
               2,
               'sec:hpc:scalar',
               'sec:hpc:scalar'),
              ('Vectorized implementation', 2, 'sec:hpc:vec', 'sec:hpc:vec'),
              ('Memory-saving implementation',
               2,
               'sec:hpc:vec:inplace',
               'sec:hpc:vec:inplace'),
              ('Analysis of memory usage',
               2,
               'sec:hpc:vec:memory_profiler',
               'sec:hpc:vec:memory_profiler'),
              ('Analysis of the CPU time',
               2,
               'sec:hpc:vec:line_profiler',
               'sec:hpc:vec:line_profiler'),
              ('Higher-dimensional arrays',
               1,
               'sec:plot:2Darrays',
               'sec:plot:2Darrays'),
              ('Matrices and arrays', 2, None, '___sec63'),
              ('Two-dimensional numerical Python arrays',
               2,
               'sec:plot:2D:arrays',
               'sec:plot:2D:arrays'),
              ('Array computing',
               2,
               'sec:plot:array2comp',
               'sec:plot:array2comp'),
              ('Remark', 3, None, '___sec66'),
              ('Matrix objects',
               2,
               'sec:plot:numpy:matrix',
               'sec:plot:numpy:matrix'),
              ('Some common linear algebra operations', 1, None, '___sec68'),
              ('Inverse, determinant, and eigenvalues', 2, None, '___sec69'),
              ('Products', 2, None, '___sec70'),
              ('Norms', 2, None, '___sec71'),
              ('Sum and extreme values', 2, None, '___sec72'),
              ('Indexing', 2, None, '___sec73'),
              ('Transpose and upper/lower triangular parts',
               2,
               None,
               '___sec74'),
              ('Solving linear systems', 2, None, '___sec75'),
              ('Matrix row and column operations', 2, None, '___sec76'),
              ('Computing the rank of a matrix', 2, None, '___sec77'),
              ('Symbolic linear algebra', 2, None, '___sec78'),
              ('Plotting of scalar and vector fields',
               1,
               'plot:surf',
               'plot:surf'),
              ('Installation', 2, 'plot:surf:install', 'plot:surf:install'),
              ('Surface plots',
               2,
               'plot:surf:mesh_surf',
               'plot:surf:mesh_surf'),
              ('Grid for 2D scalar fields', 3, None, '___sec82'),
              ('Parameterized curve',
               2,
               'plot:surf:3Dcurve',
               'plot:surf:3Dcurve'),
              ('Contour lines',
               2,
               'plot:surf:contours',
               'plot:surf:contours'),
              ('The gradient vector field',
               2,
               'plot:surf:gradient',
               'plot:surf:gradient'),
              ('Matplotlib', 1, None, '___sec86'),
              ('Surface plots',
               2,
               'matplotlibsurfaceplots',
               'matplotlibsurfaceplots'),
              ('Contour plots',
               2,
               'matplotlibcontourplots',
               'matplotlibcontourplots'),
              ('Vector field plots',
               2,
               'plot:surf:mpl:quiver',
               'plot:surf:mpl:quiver'),
              ('Mayavi', 1, None, '___sec90'),
              ('Surface plots', 2, None, '___sec91'),
              ('Subplots', 3, None, '___sec92'),
              ('Contour plots', 2, None, '___sec93'),
              ('Vector field plots',
               2,
               'plot:surf:mayavi:quiver',
               'plot:surf:mayavi:quiver'),
              ('A 3D scalar field and its gradient field',
               2,
               None,
               '___sec95'),
              ('Animations', 2, None, '___sec96'),
              ('Summary', 1, None, '___sec97'),
              ('Chapter topics', 2, None, '___sec98'),
              ('Array computing', 3, None, '___sec99'),
              ('Plotting curves', 3, None, '___sec100'),
              ('Making movies', 3, None, '___sec101'),
              ('Terminology', 3, None, '___sec102'),
              ('Example: Animating a function',
               2,
               'sec:plot:summarizing',
               'sec:plot:summarizing'),
              ('Problem', 3, None, '___sec104'),
              ('Solution', 3, None, '___sec105'),
              ('Scaling', 3, None, '___sec106'),
              ('Exercises', 1, 'sec:plot:exer', 'sec:plot:exer'),
              ('Exercise 1: Fill lists with function values',
               2,
               'sec:plot:ex1',
               'sec:plot:ex1'),
              ('Exercise 2: Fill arrays; loop version',
               2,
               'sec:plot:ex2',
               'sec:plot:ex2'),
              ('Exercise 3: Fill arrays; vectorized version',
               2,
               'sec:plot:ex2b',
               'sec:plot:ex2b'),
              ('Exercise 4: Plot a function',
               2,
               'sec:plot:ex2c',
               'sec:plot:ex2c'),
              ('Exercise 5: Apply a function to a vector',
               2,
               'sec:plot:math:ex1',
               'sec:plot:math:ex1'),
              ('Exercise 6: Simulate by hand a vectorized expression',
               2,
               'sec:plot:ex3',
               'sec:plot:ex3'),
              ('Exercise 7: Demonstrate array slicing',
               2,
               'sec:plot:ex15d',
               'sec:plot:ex15d'),
              ('Exercise 8: Replace list operations by array computing',
               2,
               'sec:plot:ex33',
               'sec:plot:ex33'),
              ('Exercise 9: Plot a formula',
               2,
               'sec:plot:ex15',
               'sec:plot:ex15'),
              ('Exercise 10: Plot a formula for several parameters',
               2,
               'sec:plot:ex15b',
               'sec:plot:ex15b'),
              ('Exercise 11: Specify the extent of the axes in a plot',
               2,
               'sec:plot:ex15ba',
               'sec:plot:ex15ba'),
              ('Exercise 12: Plot exact and inexact Fahrenheit-Celsius conversion formulas',
               2,
               'sec:plot:ex15c',
               'sec:plot:ex15c'),
              ('Exercise 13: Plot the trajectory of a ball',
               2,
               'sec:plot:ex5',
               'sec:plot:ex5'),
              ('Exercise 14: Plot data in a two-column file',
               2,
               'sec:files:ex12',
               'sec:files:ex12'),
              ('Remarks', 3, None, '___sec122'),
              ('Exercise 15: Write function data to file',
               2,
               'sec:files:ex12e',
               'sec:files:ex12e'),
              ('Exercise 16: Plot data from a file',
               2,
               'sec:files:ex12c',
               'sec:files:ex12c'),
              ('Exercise 17: Write table to file',
               2,
               'sec:files:exer:write_table',
               'sec:files:exer:write_table'),
              ('Exercise 18: Fit a polynomial to data points',
               2,
               'sec:files:ex12c2',
               'sec:files:ex12c2'),
              ('Exercise 19: Fit a polynomial to experimental data',
               2,
               'sec:files:ex19',
               'sec:files:ex19'),
              ('Exercise 20: Read acceleration data and find velocities',
               2,
               'sec:files:ex22',
               'sec:files:ex22'),
              ('Exercise 21: Read acceleration data and plot velocities',
               2,
               'sec:files:ex23',
               'sec:files:ex23'),
              ("Exercise 22: Plot a trip's path and velocity from GPS coordinates",
               2,
               'sec:files:ex24',
               'sec:files:ex24'),
              ('Exercise 23: Vectorize the Midpoint rule for integration',
               2,
               'sec:class:exer:sum',
               'sec:class:exer:sum'),
              ('Remarks', 3, None, '___sec132'),
              ('Exercise 24: Vectorize a function for computing the area of a polygon',
               2,
               'sec:plot:exer:area:polygon:vec',
               'sec:plot:exer:area:polygon:vec'),
              ("Exercise 25: Implement Lagrange's interpolation formula",
               2,
               'sec:class:ex27a',
               'sec:class:ex27a'),
              ("Exercise 26: Plot Lagrange's interpolating polynomial",
               2,
               'sec:class:ex27b',
               'sec:class:ex27b'),
              ("Exercise 27: Investigate the behavior of Lagrange's interpolating polynomials",
               2,
               'sec:class:ex27c',
               'sec:class:ex27c'),
              ('Remarks', 3, None, '___sec137'),
              ('Exercise 28: Plot a wave packet',
               2,
               'sec:plot:ex5d',
               'sec:plot:ex5d'),
              ('Exercise 29: Judge a plot',
               2,
               'sec:plot:ex7',
               'sec:plot:ex7'),
              ('Exercise 30: Plot the viscosity of water',
               2,
               'sec:plot:ex13c',
               'sec:plot:ex13c'),
              ('Exercise 31: Explore a complicated function graphically',
               2,
               'sec:plot:ex16',
               'sec:plot:ex16'),
              ('Exercise 32: Plot Taylor polynomial approximations to $\\sin x$',
               2,
               'sec:plot:ex5b',
               'sec:plot:ex5b'),
              ('Exercise 33: Animate a wave packet',
               2,
               'sec:plot:ex5e',
               'sec:plot:ex5e'),
              ('Exercise 34: Animate a smoothed Heaviside function',
               2,
               'sec:plot:ex32',
               'sec:plot:ex32'),
              ('Exercise 35: Animate two-scale temperature variations',
               2,
               'sec:plot:ex18',
               'sec:plot:ex18'),
              ('Remarks', 3, None, '___sec146'),
              ('Exercise 36: Use non-uniformly distributed coordinates for visualization',
               2,
               'sec:plot:ex19',
               'sec:plot:ex19'),
              ('Exercise 37: Animate a sequence of approximations to $\\pi$',
               2,
               'sec:plot:ex31',
               'sec:plot:ex31'),
              ("Exercise 38: Animate a planet's orbit",
               2,
               'sec:plot:ex5g',
               'sec:plot:ex5g'),
              ('Exercise 39: Animate the evolution of Taylor polynomials',
               2,
               'sec:plot:ex17',
               'sec:plot:ex17'),
              ('Exercise 40: Plot the velocity profile for pipeflow',
               2,
               'sec:plot:ex4',
               'sec:plot:ex4'),
              ('Exercise 41: Plot sum-of-sines approximations to a function',
               2,
               'sec:plot:ex8',
               'sec:plot:ex8'),
              ('Exercise 42: Animate the evolution of a sum-of-sine approximation to a function',
               2,
               'sec:plot:ex8m',
               'sec:plot:ex8m'),
              ('Exercise 43: Plot functions from the command line',
               2,
               'sec:plot:ex14',
               'sec:plot:ex14'),
              ('Exercise 44: Improve command-line input',
               2,
               'sec:plot:ex14b',
               'sec:plot:ex14b'),
              ('Exercise 45: Demonstrate energy concepts from physics',
               2,
               'sec:plot:ex20',
               'sec:plot:ex20'),
              ('Exercise 46: Plot a w-like function',
               2,
               'sec:plot:math:ex9',
               'sec:plot:math:ex9'),
              ('Exercise 47: Plot a piecewise constant function',
               2,
               'sec:basic:exH4plot',
               'sec:basic:exH4plot'),
              ('Exercise 48: Vectorize a piecewise constant function',
               2,
               'sec:basic:exH4vecz1',
               'sec:basic:exH4vecz1'),
              ('Remarks', 3, None, '___sec160'),
              ('Exercise 49: Visualize approximations in the Midpoint integration rule',
               2,
               'sec:plot:ex:vizmidpoint',
               'sec:plot:ex:vizmidpoint'),
              ('Exercise 50: Visualize approximations in the Trapezoidal integration rule',
               2,
               'sec:plot:ex:viztrapezoidal',
               'sec:plot:ex:viztrapezoidal'),
              ('Exercise 51: Experience overflow in a function',
               2,
               'sec:plot:ex13',
               'sec:plot:ex13'),
              ('Remarks', 3, None, '___sec164'),
              ('Exercise 52: Apply a function to a rank 2 array',
               2,
               'sec:plot:math:ex2',
               'sec:plot:math:ex2'),
              ('Exercise 53: Explain why array computations fail',
               2,
               'sec:plot:ex11',
               'sec:plot:ex11'),
              ('Exercise 54: Verify linear algebra results',
               2,
               'plot:linalg:exer:verify',
               'plot:linalg:exer:verify'),
              ('References', 1, None, '___sec168')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="plot-readable.html">Array computing and curve plotting</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._plot-readable000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable001.html#___sec0" style="font-size: 80%;"><b>Vectors</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable001.html#___sec1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The vector concept</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable001.html#sec:plot:vectors" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical operations on vectors</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable001.html#sec:plot:arraycomp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector arithmetics and vector functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#___sec4" style="font-size: 80%;"><b>Arrays in Python programs</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#sec:plot:listdata" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Using lists for collecting function data</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#sec:plot:array:basics" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Basics of numerical Python arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing coordinates and function values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable002.html#sec:plot:vectorization" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:curveplots" style="font-size: 80%;"><b>Curve plotting</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:pylab" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;MATLAB-style plotting with Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A basic plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decorating the plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting multiple curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Placing several plots in one figure</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:pyplot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matplotlib; pyplot prefix</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:SciTools" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;SciTools and Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Importing SciTools and Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A basic plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decorating the plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting multiple curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changing backend</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Placing several plots in one figure</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other plotting alternatives</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#easyviz:movie" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Making animations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Animation in Easyviz</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec27" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Basic animation in Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Using FuncAnimation in Matplotlib</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#sec:plot:video" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Making videos</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Animated GIF file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MP4, Ogg, WebM, and Flash videos</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable003.html#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Curve plots in pure text</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable004.html#sec:plot:difficulties" style="font-size: 80%;"><b>Plotting difficulties</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable004.html#sec:plot:pwisefunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Piecewisely defined functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable004.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: The Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable004.html#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: A hat function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable004.html#sec:plot:sin1x" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Rapidly varying functions</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#sec:plot:if:vectorize" style="font-size: 80%;"><b>More advanced vectorization of functions</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#sec:plot:StringFunction:vectorize" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of StringFunction objects</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#sec:vec:Heaviside" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of the Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#___sec41" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loop</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#___sec42" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Automatic vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#___sec43" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mixing boolean and floating-point calculations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#___sec44" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Manual vectorization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable005.html#sec:vec:hatfunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorization of a hat function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:numpy:more" style="font-size: 80%;"><b>More on numerical Python arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec47" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Copying arrays</a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:numpy:inplace" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;In-place arithmetics</a></li>
     <!-- navigation toc: --> <li><a href="#___sec49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Allocating arrays</a></li>
     <!-- navigation toc: --> <li><a href="#sec:plot:generalized:index" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Generalized indexing</a></li>
     <!-- navigation toc: --> <li><a href="#___sec51" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Testing for the array type</a></li>
     <!-- navigation toc: --> <li><a href="#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Vectorizing a constant function</a></li>
     <!-- navigation toc: --> <li><a href="#___sec53" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Compact syntax for array generation</a></li>
     <!-- navigation toc: --> <li><a href="#___sec54" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Shape manipulation</a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc" style="font-size: 80%;"><b>High-performance computing with arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec56" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: <code>axpy</code></a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc:scalar" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Scalar implementation</a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc:vec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vectorized implementation</a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc:vec:inplace" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Memory-saving implementation</a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc:vec:memory_profiler" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of memory usage</a></li>
     <!-- navigation toc: --> <li><a href="#sec:hpc:vec:line_profiler" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Analysis of the CPU time</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#sec:plot:2Darrays" style="font-size: 80%;"><b>Higher-dimensional arrays</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec63" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrices and arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#sec:plot:2D:arrays" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Two-dimensional numerical Python arrays</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#sec:plot:array2comp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec66" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#sec:plot:numpy:matrix" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrix objects</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec68" style="font-size: 80%;"><b>Some common linear algebra operations</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec69" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Inverse, determinant, and eigenvalues</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec70" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Products</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec71" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Norms</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec72" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Sum and extreme values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec73" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Indexing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec74" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Transpose and upper/lower triangular parts</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec75" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Solving linear systems</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec76" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Matrix row and column operations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec77" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing the rank of a matrix</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec78" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Symbolic linear algebra</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf" style="font-size: 80%;"><b>Plotting of scalar and vector fields</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:install" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Installation</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:mesh_surf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec82" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Grid for 2D scalar fields</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:3Dcurve" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Parameterized curve</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:contours" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour lines</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:gradient" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The gradient vector field</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec86" style="font-size: 80%;"><b>Matplotlib</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#matplotlibsurfaceplots" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#matplotlibcontourplots" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:mpl:quiver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector field plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec90" style="font-size: 80%;"><b>Mayavi</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec91" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Surface plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec92" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subplots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec93" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Contour plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#plot:surf:mayavi:quiver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Vector field plots</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec95" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;A 3D scalar field and its gradient field</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable007.html#___sec96" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Animations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec97" style="font-size: 80%;"><b>Summary</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec98" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Chapter topics</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec99" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec100" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plotting curves</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec101" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Making movies</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec102" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Terminology</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#sec:plot:summarizing" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Animating a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec104" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec105" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable008.html#___sec106" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scaling</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:exer" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Fill lists with function values</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Fill arrays; loop version</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex2b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Fill arrays; vectorized version</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex2c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Plot a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:math:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Apply a function to a vector</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Simulate by hand a vectorized expression</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex15d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Demonstrate array slicing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Replace list operations by array computing</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Plot a formula</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex15b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Plot a formula for several parameters</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex15ba" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 11: Specify the extent of the axes in a plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex15c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 12: Plot exact and inexact Fahrenheit-Celsius conversion formulas</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 13: Plot the trajectory of a ball</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 14: Plot data in a two-column file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec122" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex12e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 15: Write function data to file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex12c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 16: Plot data from a file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:exer:write_table" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 17: Write table to file</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex12c2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 18: Fit a polynomial to data points</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 19: Fit a polynomial to experimental data</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 20: Read acceleration data and find velocities</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex23" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 21: Read acceleration data and plot velocities</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:files:ex24" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 22: Plot a trip's path and velocity from GPS coordinates</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:class:exer:sum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 23: Vectorize the Midpoint rule for integration</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec132" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:exer:area:polygon:vec" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 24: Vectorize a function for computing the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:class:ex27a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 25: Implement Lagrange's interpolation formula</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:class:ex27b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 26: Plot Lagrange's interpolating polynomial</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:class:ex27c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 27: Investigate the behavior of Lagrange's interpolating polynomials</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec137" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex5d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 28: Plot a wave packet</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 29: Judge a plot</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex13c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 30: Plot the viscosity of water</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 31: Explore a complicated function graphically</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex5b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 32: Plot Taylor polynomial approximations to \( \sin x \)</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex5e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 33: Animate a wave packet</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 34: Animate a smoothed Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 35: Animate two-scale temperature variations</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec146" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 36: Use non-uniformly distributed coordinates for visualization</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 37: Animate a sequence of approximations to \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex5g" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 38: Animate a planet's orbit</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 39: Animate the evolution of Taylor polynomials</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 40: Plot the velocity profile for pipeflow</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 41: Plot sum-of-sines approximations to a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex8m" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 42: Animate the evolution of a sum-of-sine approximation to a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 43: Plot functions from the command line</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex14b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 44: Improve command-line input</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 45: Demonstrate energy concepts from physics</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:math:ex9" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 46: Plot a w-like function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:basic:exH4plot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 47: Plot a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:basic:exH4vecz1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 48: Vectorize a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec160" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex:vizmidpoint" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 49: Visualize approximations in the Midpoint integration rule</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex:viztrapezoidal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 50: Visualize approximations in the Trapezoidal integration rule</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex13" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 51: Experience overflow in a function</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec164" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:math:ex2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 52: Apply a function to a rank 2 array</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#sec:plot:ex11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 53: Explain why array computations fail</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#plot:linalg:exer:verify" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 54: Verify linear algebra results</a></li>
     <!-- navigation toc: --> <li><a href="._plot-readable009.html#___sec168" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0006"></a>
<!-- !split -->
<p style="font-size:80%">This chapter is taken from the book <a href="http://www.springer.com/gp/book/9783662498866">A Primer on Scientific Programming with Python</a> by H. P. Langtangen, 5th edition, Springer, 2016.</p>

<h1 id="sec:plot:numpy:more" class="anchor">More on numerical Python arrays</h1>

<p>
This section lists some more advanced but useful operations with
Numerical Python arrays.

<h2 id="___sec47" class="anchor">Copying arrays </h2>

<p>
Let <code>x</code> be an array. The statement <code>a = x</code> makes <code>a</code> refer to the same
array as <code>x</code>. Changing <code>a</code> will then also affect <code>x</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3.5</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> x
<span style="color: #666666">&gt;&gt;&gt;</span> a[<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">3</span>  <span style="color: #408080; font-style: italic"># this changes x[-1] too!</span>
<span style="color: #666666">&gt;&gt;&gt;</span> x
array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>])
</pre></div>
<p>
Changing <code>a</code> without changing <code>x</code> requires <code>a</code> to be a copy of <code>x</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> x<span style="color: #666666">.</span>copy()
<span style="color: #666666">&gt;&gt;&gt;</span> a[<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> <span style="color: #666666">9</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">9.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> x
array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>])
</pre></div>

<h2 id="sec:plot:numpy:inplace" class="anchor">In-place arithmetics</h2>

<p>
Let <code>a</code> and <code>b</code> be two arrays of the same shape.  The expression <code>a +=
b</code> means <code>a = a + b</code>, but this is not the complete story. In the
statement <code>a = a + b</code>, the sum <code>a + b</code> is first computed, yielding a
new array, and then the name <code>a</code> is bound to this new array. The old
array <code>a</code> is lost unless there are other names assigned to this array.
In the statement <code>a += b</code>, elements of <code>b</code> are added directly into the
elements of <code>a</code> (in memory). There is no hidden intermediate array as
in <code>a = a + b</code>.  This implies that <code>a += b</code> is more efficient than <code>a
= a + b</code> since Python avoids making an extra array.  We say that the
operators <code>+=</code>, <code>*=</code>, and so on, perform <em>in-place</em> arithmetics in
arrays.

<p>
Consider the compound array expression

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> (<span style="color: #666666">3*</span>x<span style="color: #666666">**4</span> <span style="color: #666666">+</span> <span style="color: #666666">2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">4</span>)<span style="color: #666666">/</span>(x <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
</pre></div>
<p>
The computation actually goes as follows with seven hidden arrays for
storing intermediate results:

<ul>
  <li> <code>r1 = x**4</code></li>
  <li> <code>r2 = 3*r1</code></li>
  <li> <code>r3 = 2*x</code></li>
  <li> <code>r4 = r2 + r3</code></li>
  <li> <code>r5 = r4 + 4</code></li>
  <li> <code>r6 = x + 1</code></li>
  <li> <code>r7 = r5/r6</code></li>
  <li> <code>a = r7</code></li>
</ul>

With in-place arithmetics we can get away with creating three new
arrays, at a cost of a significantly less readable code:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> x<span style="color: #666666">.</span>copy()
a <span style="color: #666666">**=</span> <span style="color: #666666">4</span>
a <span style="color: #666666">*=</span> <span style="color: #666666">3</span>
a <span style="color: #666666">+=</span> <span style="color: #666666">2*</span>x
a <span style="color: #666666">+=</span> <span style="color: #666666">4</span>
a <span style="color: #666666">/=</span> x <span style="color: #666666">+</span> <span style="color: #666666">1</span>
</pre></div>
<p>
The three extra arrays in this series of statement arise from copying
<code>x</code>, and computing the right-hand sides <code>2*x</code> and <code>x+1</code>.

<p>
Quite often in computational science and engineering, a huge number of
arithmetics is performed on very large arrays, and then saving memory
and array allocation time by doing in-place arithmetics is important.

<p>
The mix of assignment and in-place arithmetics makes it easy to make
unintended changes of more than one array. For example, this code
changes <code>x</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> x
a <span style="color: #666666">+=</span> y
</pre></div>
<p>
since <code>a</code> refers to the same array as <code>x</code> and the change of
<code>a</code> is done in-place.

<h2 id="___sec49" class="anchor">Allocating arrays </h2>

<p>
We have already seen that the <code>np.zeros</code> function is handy for making
a new array <code>a</code> of a given size. Very often the size and the type of
array elements have to match another existing array <code>x</code>. We can then
either copy the original array, e.g.,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> x<span style="color: #666666">.</span>copy()
</pre></div>
<p>
and fill elements in <code>a</code> with the right new values, or we can
say

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(x<span style="color: #666666">.</span>shape, x<span style="color: #666666">.</span>dtype)
</pre></div>
<p>
The attribute <code>x.dtype</code> holds the array element type (<code>dtype</code> for
data type), and <code>x.shape</code> is a tuple with
the array dimensions. The variable <code>a.ndim</code> holds the number of
dimensions.

<p>
Sometimes we may want to ensure that an object is an array, and if
not, turn it into an array. The <code>np.asarray</code> function is useful in
such cases:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>asarray(a)
</pre></div>
<p>
Nothing is copied if <code>a</code> already is an array, but if <code>a</code> is a list
or tuple, a new array with a copy of the data is created.

<h2 id="sec:plot:generalized:index" class="anchor">Generalized indexing</h2>

<p>
The section <a href="._plot-readable002.html#sec:plot:array:basics">Basics of numerical Python arrays</a> shows how slices can be used to
extract and manipulate subarrays.  The slice <code>f:t:i</code> corresponds to
the index set <code>f, f+i, f+2*i, ...</code> up to, but not including, <code>t</code>.
Such an index set can be given explicitly too: <code>a[range(f,t,i)]</code>.
That is, the integer list from <code>range</code> can be used as a set of
indices.  In fact, any integer list or integer array can be used as
index:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">1</span>, <span style="color: #666666">8</span>, <span style="color: #666666">8</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([ <span style="color: #666666">1.</span>,  <span style="color: #666666">2.</span>,  <span style="color: #666666">3.</span>,  <span style="color: #666666">4.</span>,  <span style="color: #666666">5.</span>,  <span style="color: #666666">6.</span>,  <span style="color: #666666">7.</span>,  <span style="color: #666666">8.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> a[[<span style="color: #666666">1</span>,<span style="color: #666666">6</span>,<span style="color: #666666">7</span>]] <span style="color: #666666">=</span> <span style="color: #666666">10</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">1.</span>,  <span style="color: #666666">10.</span>,   <span style="color: #666666">3.</span>,   <span style="color: #666666">4.</span>,   <span style="color: #666666">5.</span>,   <span style="color: #666666">6.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">10.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> a[<span style="color: #008000">range</span>(<span style="color: #666666">2</span>,<span style="color: #666666">8</span>,<span style="color: #666666">3</span>)] <span style="color: #666666">=</span> <span style="color: #666666">-2</span>   <span style="color: #408080; font-style: italic"># same as a[2:8:3] = -2</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">1.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">-2.</span>,   <span style="color: #666666">4.</span>,   <span style="color: #666666">5.</span>,  <span style="color: #666666">-2.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">10.</span>])
</pre></div>
<p>
We can also use boolean arrays to generate an index set. The indices
in the set will correspond to the indices for which the boolean array
has <code>True</code> values. This functionality allows expressions like
<code>a[x&lt;m]</code>. Here are two examples, continuing the previous interactive
session:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a[a <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>]            <span style="color: #408080; font-style: italic"># pick out the negative elements of a</span>
array([<span style="color: #666666">-2.</span>, <span style="color: #666666">-2.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> a[a <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>] <span style="color: #666666">=</span> a<span style="color: #666666">.</span>max()
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">1.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">10.</span>,   <span style="color: #666666">4.</span>,   <span style="color: #666666">5.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">10.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># Replace elements where a is 10 by the first</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># elements from another array/list:</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a[a <span style="color: #666666">==</span> <span style="color: #666666">10</span>] <span style="color: #666666">=</span> [<span style="color: #666666">10</span>, <span style="color: #666666">20</span>, <span style="color: #666666">30</span>, <span style="color: #666666">40</span>, <span style="color: #666666">50</span>, <span style="color: #666666">60</span>, <span style="color: #666666">70</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([  <span style="color: #666666">1.</span>,  <span style="color: #666666">10.</span>,  <span style="color: #666666">20.</span>,   <span style="color: #666666">4.</span>,   <span style="color: #666666">5.</span>,  <span style="color: #666666">30.</span>,  <span style="color: #666666">40.</span>,  <span style="color: #666666">50.</span>])
</pre></div>
<p>
Generalized indexing using integer arrays or lists is important for
vectorized initialization of array elements.  The syntax for
generalized indexing of higher-dimensional arrays is slightly
different, see the section <a href="._plot-readable007.html#sec:plot:2D:arrays">Two-dimensional numerical Python arrays</a>.

<h2 id="___sec51" class="anchor">Testing for the array type </h2>

<p>
Inside an interactive Python shell you can easily check an object's type
using the <code>type</code>
In case of a Numerical Python array, the type name is <code>ndarray</code>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">3</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a
array([<span style="color: #666666">-1.</span>,  <span style="color: #666666">0.</span>,  <span style="color: #666666">1.</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">type</span>(a)
<span style="color: #666666">&lt;</span><span style="color: #008000">type</span> <span style="color: #BA2121">&#39;numpy.ndarray&#39;</span><span style="color: #666666">&gt;</span>
</pre></div>
<p>
Sometimes you need to test if a variable is an <code>ndarray</code> or a <code>float</code>
or <code>int</code>. The <code>isinstance</code> function can be used this purpose:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">isinstance</span>(a, np<span style="color: #666666">.</span>ndarray)
<span style="color: #008000">True</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">isinstance</span>(a, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>))  <span style="color: #408080; font-style: italic"># float or int?</span>
<span style="color: #008000">False</span>
</pre></div>
<p>
A typical use of <code>isinstance</code> and <code>type</code> to check on object's type is
shown next.

<h3 id="___sec52" class="anchor">Example: Vectorizing a constant function </h3>

<p>
Suppose we have a constant function,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2</span>
</pre></div>
<p>
This function accepts an array argument <code>x</code>, but will return a <code>float</code>
while a vectorized version of the function should return an array of
the same shape as <code>x</code> where each element has the value 2.  The
vectorized version can be realized as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">fv</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>zeros(x<span style="color: #666666">.</span>shape, x<span style="color: #666666">.</span>dtype) <span style="color: #666666">+</span> <span style="color: #666666">2</span>
</pre></div>
<p>
The optimal vectorized function would be one that works for both
a scalar and an array argument. We must then test on the argument type:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(x, (<span style="color: #008000">float</span>, <span style="color: #008000">int</span>)):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #008000">isinstance</span>(x, np<span style="color: #666666">.</span>ndarray):
        <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>zeros(x<span style="color: #666666">.</span>shape, x<span style="color: #666666">.</span>dtype) <span style="color: #666666">+</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #D2413A; font-weight: bold">TypeError</span>\ 
        (<span style="color: #BA2121">&#39;x must be int, float or ndarray, not </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">type</span>(x))
</pre></div>

<h2 id="___sec53" class="anchor">Compact syntax for array generation </h2>

<p>
There is a special compact syntax <code>r_[f:t:s]</code> for the <code>linspace</code>
function:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> r_[<span style="color: #666666">-5</span>:<span style="color: #666666">5</span>:<span style="color: #666666">11j</span>]  <span style="color: #408080; font-style: italic"># same as linspace(-5, 5, 11)</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> a
[<span style="color: #666666">-5.</span> <span style="color: #666666">-4.</span> <span style="color: #666666">-3.</span> <span style="color: #666666">-2.</span> <span style="color: #666666">-1.</span>  <span style="color: #666666">0.</span>  <span style="color: #666666">1.</span>  <span style="color: #666666">2.</span>  <span style="color: #666666">3.</span>  <span style="color: #666666">4.</span>  <span style="color: #666666">5.</span>]
</pre></div>
<p>
Here, <code>11j</code> means 11 coordinates (between -5 and 5, including the
upper limit 5). That is, the number of elements in the array is given
with the imaginary number syntax.

<h2 id="___sec54" class="anchor">Shape manipulation </h2>

<p>
The <code>shape</code> attribute in array objects holds the shape, i.e., the size
of each dimension. A function <code>size</code> returns the total number of
elements in an array.  Here are a few equivalent ways of changing the
shape of an array:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">6</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> a
[<span style="color: #666666">-1.</span>  <span style="color: #666666">-0.6</span> <span style="color: #666666">-0.2</span>  <span style="color: #666666">0.2</span>  <span style="color: #666666">0.6</span>  <span style="color: #666666">1.</span> ]
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>shape
(<span style="color: #666666">6</span>,)
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>size
<span style="color: #666666">6</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>shape <span style="color: #666666">=</span> (<span style="color: #666666">2</span>, <span style="color: #666666">3</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> a<span style="color: #666666">.</span>reshape(<span style="color: #666666">2</span>, <span style="color: #666666">3</span>)    <span style="color: #408080; font-style: italic"># alternative</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>shape
(<span style="color: #666666">2</span>, <span style="color: #666666">3</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> a
[[<span style="color: #666666">-1.</span>  <span style="color: #666666">-0.6</span> <span style="color: #666666">-0.2</span>]
 [ <span style="color: #666666">0.2</span>  <span style="color: #666666">0.6</span>  <span style="color: #666666">1.</span> ]]
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>size                 <span style="color: #408080; font-style: italic"># total no of elements</span>
<span style="color: #666666">6</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">len</span>(a)                 <span style="color: #408080; font-style: italic"># no of rows</span>
<span style="color: #666666">2</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>shape <span style="color: #666666">=</span> (a<span style="color: #666666">.</span>size,)    <span style="color: #408080; font-style: italic"># reset shape</span>
</pre></div>
<p>
Note that <code>len(a)</code> always returns the length of the first
dimension of an array.

<h1 id="sec:hpc" class="anchor">High-performance computing with arrays</h1>

<p>
Programs
with lots of array calculations may soon consume much time
and memory, so it may quickly become crucial to speed up calculations
and use as little memory as possible. The main technique for
speeding up array calculations is vectorization, i.e., avoiding explicit
loops in Python over array elements. To save memory usage, one
needs to understand when arrays get allocated and avoid this by
in-place array
arithmetics.

<h3 id="___sec56" class="anchor">Example: <code>axpy</code> </h3>

<p>
Our computational case study concerns the famous &quot;axpy&quot; operation:
\( r = ax + y \), where \( a \) is a number and \( x \) and \( y \) are arrays.
All implementations and the associated experimentation are
found in the file <a href="http://tinyurl.com/pwyasaa/plot/hpc_axpy.py" target="_self"><tt>hpc_axpy.py</tt></a>.

<h2 id="sec:hpc:scalar" class="anchor">Scalar implementation</h2>

<p>
A naive loop implementation of the &quot;axpy&quot; operation \( ax+y \) reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy_loop_newr</span>(a, x, y):
    r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(x)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(r<span style="color: #666666">.</span>size):
        r[i] <span style="color: #666666">=</span> a<span style="color: #666666">*</span>x[i] <span style="color: #666666">+</span> y[i]
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
Classical implementations overwrite \( y \) by \( ax + y \): \( y \leftarrow ax+y \),
but we shall make implementations where we either can overwrite \( y \) or
place \( ax+y \) in another array. The function above creates a new
array for the result.

<p>
Rather than allocating the array inside the function, we can put that
burden on the user and provide a result array <code>r</code> as input:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy_loop</span>(a, x, y, r):
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(r<span style="color: #666666">.</span>size):
        r[i] <span style="color: #666666">=</span> a<span style="color: #666666">*</span>x[i] <span style="color: #666666">+</span> y[i]
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
The advantage of this version is that we can either overwrite
\( y \) by \( ax+y \) or store
\( ax+y \) in a separate array:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># Classical axpy</span>
y <span style="color: #666666">=</span> axpy_loop(a, x, y, y)

<span style="color: #408080; font-style: italic"># Store axpy result in separate array</span>
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(x)
r <span style="color: #666666">=</span> axpy_loop(a, x, y, r)
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Python functions return output data.</b>
The call

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>r <span style="color: #666666">=</span> axpy_loop(a, x, y, r)
</pre></div>
<p>
can equally well be written

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>axpy_loop(a, x, y, r)
</pre></div>
<p>
This is the typical coding style in Fortran, C, or C++ (where <code>r</code> is then
transferred as a reference or pointer to the array data).
In Python, there is no need for the function <code>axpy_loop</code> to return <code>r</code>, because
the assignment to <code>r[i]</code> inside the loop changes all elements of the
<code>r</code>. The array <code>r</code> will therefore be modified after calling
<code>axpy_loop(a, x, y, r)</code> anyway. However, it is a good convention in Python
that <em>all input data to a function are arguments and all output data
are returned</em>. With

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span>r <span style="color: #666666">=</span> axpy_loop(a, x, y, r)
</pre></div>
<p>
we clearly see that <code>r</code> is both input and output.
</div>


<p>
<!-- The box above is too big because the verbatim code blocks with -->
<!-- the listing environment do something... -->

<h2 id="sec:hpc:vec" class="anchor">Vectorized implementation</h2>

<p>
The vectorized implementation of the &quot;axpy&quot; operation reads

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy1</span>(a, x, y):
    r <span style="color: #666666">=</span> a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> y
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
Note that the result is placed in a new array <code>r</code> arising from the
operation <code>a*x+y</code>.
The speed up of vectorization is significant, see
Figure <a href="#sec:hpc:axpy:fig:vec">11</a> (made by the function <code>effect_of_vec</code>
in the file <a href="http://tinyurl.com/pwyasaa/plot/hpc_axpy.py" target="_self"><tt>hpc_axpy.py</tt></a>).

<p>
<center> <!-- figure label: --> <div id="sec:hpc:axpy:fig:vec"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 11:  Improved efficiency of vectorizing the &quot;axpy&quot; operation as function of array length.  <!-- caption label: sec:hpc:axpy:fig:vec --> </p></center>
<p><img src="fig-plot/axpy_vec.png" align="bottom" width=400></p>
</center>

<p>
Temporary arrays are needed in the vectorized implementation.
One would expect that <code>a*x</code> must be calculated and stored in
a temporary array, call it <code>r1</code>, and then <code>r1 + y</code> must be
evaluated and stored in another allocated array <code>r</code>, which is returned.
It appears that <code>a*x + y</code> only needs the allocation of one array,
the one to be returned (we have investigated the memory consumption
in detail using the <code>memory_profiler</code> module). Anyway, repeated
calls to <code>axpy1</code> with large arrays lead to an allocation of a new
large array in each call.

<h2 id="sec:hpc:vec:inplace" class="anchor">Memory-saving implementation</h2>

<p>
Applications with large arrays should avoid unnecessary allocation
of temporary arrays and instead reuse pre-allocated arrays.
Suppose we have allocated an array for the result <code>r = ax + y</code> once
and for all. We can pass the <code>r</code> array to the computing function
as in the <code>axpy_loop</code> function above and use the memory in <code>r</code>
for intermediate calculation. In vectorized code, this requires
use of <em>in-place</em> array
arithmetics. For example, <code>u += v</code> adds each element in <code>v</code> into
<code>u</code>. The mathematically equivalent construction <code>u = u + v</code> would
first create an object from <code>u + v</code> and then assign the name <code>u</code>
to this object. Similarly, <code>u *= a</code> multiplies all elements in <code>u</code>
by the number <code>a</code>. Other in-place operators are <code>-=</code> for
elementwise subtraction,
<code>/=</code> for elementwise division, and <code>**=</code> for elementwise exponentiation.

<p>
In-place arithmetics for doing <code>r = a*x + y</code> in a pre-allocated
array <code>r</code> will first copy all elements of <code>x</code> into <code>r</code>, then
perform elementwise multiplication by <code>a</code>, and finally elementwise
addition of <code>y</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy2</span>(a, x, y, r):
    r[:] <span style="color: #666666">=</span> x
    r <span style="color: #666666">*=</span> a
    r <span style="color: #666666">+=</span> y
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
Note that <code>r[:] = x</code> inserts the elements of <code>x</code> into <code>r</code>.
A mathematically equivalent construction, <code>r = x.copy()</code>, allocates
a new object and fills it with the values of <code>x</code> before the name
<code>r</code> refers to this object. The array <code>r</code> supplied as argument to the
function is then lost, and the returned array is another object.

<p>
We can perform repeated calls to the <code>axpy2</code> function without any
extra memory allocation. This can be proved by a small code snippet
where we use <code>id(r)</code> to see the unique identity of the <code>r</code> array.
If this identity remains constant through calls, we always reuse
the pre-allocated <code>r</code> array:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros_like(x)
<span style="color: #008000; font-weight: bold">print</span> <span style="color: #008000">id</span>(r)
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">10</span>):
    r <span style="color: #666666">=</span> axpy2(a, x, y, r)
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #008000">id</span>(r)
</pre></div>
<p>
The output prints the same number, proving that it is physically the
same object we feed as <code>r</code> to <code>axpy2</code> that is also returned.

<p>
We can equally well drop returning <code>r</code> and utilize that the changes
made by in-place arithmetics is always reflected in the <code>r</code> array
we allocate outside the function:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy3</span>(a, x, y, r):
    r[:] <span style="color: #666666">=</span> x
    r <span style="color: #666666">*=</span> a
    r <span style="color: #666666">+=</span> y
</pre></div>
<p>
The call can now just be

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>axpy3(a, x, y, r)
</pre></div>
<p>
However, as emphasized in the section <a href="#sec:hpc:scalar">Scalar implementation</a>, in Python we
usually return the output data (because this is no extra cost, only
references to objects are physically transferred back to the calling code).

<h2 id="sec:hpc:vec:memory_profiler" class="anchor">Analysis of memory usage</h2>

<p>
The module <code>memory_profiler</code> is very useful for analyzing the memory
usage of every statement in a program. The module is installed
by

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; sudo pip install memory_profiler
</pre></div>
<p>
Each function we want to
analyze must have (the decorator) <code>@profile</code> at the line above, e.g.,

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #AA22FF">@profile</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">axpy1</span>(a, x, y:
    r <span style="color: #666666">=</span> a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> y
    <span style="color: #008000; font-weight: bold">return</span> r
</pre></div>
<p>
We can then run a program with name <code>axpy.py</code> by

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; python -m memory_profiler axpy.py
</pre></div>
<p>
The arrays must be quite large to see a significant increase in
memory usage. With 10,000,000 elements in each array we get
output like

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Line #    Mem usage    Increment   Line Contents
================================================
     1  251.977 MiB    0.000 MiB   @profile
     2                             def axpy1(a, x, y:
     3  328.273 MiB   76.297 MiB       r = a*x + y
     4  328.273 MiB    0.000 MiB       return r

Line #    Mem usage    Increment   Line Contents
================================================
     6  251.977 MiB    0.000 MiB   @profile
     7                             def axpy2(a, x, y, r):
     8  251.977 MiB    0.000 MiB       r[:] = x
     9  251.977 MiB    0.000 MiB       r *= a
    10  251.977 MiB    0.000 MiB       r += y
    11  251.977 MiB    0.000 MiB       return r
</pre></div>
<p>
This demonstrates the larger memory consumption of <code>axpy1</code> compared
with <code>axpy2</code>.

<h2 id="sec:hpc:vec:line_profiler" class="anchor">Analysis of the CPU time</h2>

<p>
The module <code>line_profiler</code> can time each line of a program.
Installation is easily done by <code>sudo pip install line_profiler</code>.
As for <code>module_profiler</code> described in the previous section,
also <code>line_profiler</code> requires each function to be analyzed to
have (the decorator) <code>@profile</code> at the line above the function.
The module is installed together with an analysis script
<code>kernprof</code> that we use to run the program:

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; kernprof -l -v axpy.py
</pre></div>
<p>
With an array length of 500,000 we get output like

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Total time: 0.014291 s
Function: axpy1 at line 1

Line #  Hits     Time  Per Hit   % Time  Line Contents
==============================================================
 1                                       @profile
 2                                       def axpy1(a, x, y):
 3     3        14283   4761.0     99.9      r = a*x + y
 4     3            8      2.7      0.1      return r

Total time: 0.004382 s
Function: axpy2 at line 6

Line #  Hits  Time  Per Hit   % Time  Line Contents
==============================================================
 6                                    @profile
 7                                    def axpy2(a, x, y, r):
 8     3      1981    660.3     45.2      r[:] = x
 9     3      1258    419.3     28.7      r *= a
10     3      1138    379.3     26.0      r += y
11     3         5      1.7      0.1      return r

Total time: 1.38674 s
Function: axpy_loop at line 26

Line #  Hits    Time Per Hit  % Time  Line Contents
==============================================================
26                                    @profile
27                                    def axpy_loop(a, x, y, r):
28   1500006  449747     0.3    32.4      for i in range(r.size):
29   1500003  936985     0.6    67.6          r[i] = a*x[i] + y[i]
30         3      10     3.3     0.0      return r
</pre></div>
<p>
We see that the administration of the for loop takes 1/3 of the
total cost of the loop.

<p>
Both <code>line_profiler</code> and <code>memory_profiler</code> are very useful tools
for spotting inefficient constructions in a code.

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._plot-readable005.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._plot-readable007.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

