<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Sequences and difference equations">
<meta name="keywords" content="sequence (mathematical),initial condition,difference equations,scaling,Trapezoidal rule for integration,Newton's method,difference equations nonlinear,nonlinear difference equations,Secant method,Midpoint rule for integration,remove files (in Python),delete files (in Python)">

<title>Sequences and difference equations</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' Mathematical models based on difference equations ',
               1,
               None,
               '___sec0'),
              (' Interest rates ',
               2,
               'sec:diffeq:irates',
               'sec:diffeq:irates'),
              (' The factorial as a difference equation ',
               2,
               None,
               '___sec2'),
              (' Fibonacci numbers ', 2, None, '___sec3'),
              (' Growth of a population ',
               2,
               'sec:diffeq:growth',
               'sec:diffeq:growth'),
              (' Logistic growth ',
               2,
               'sec:diffeq:logistic',
               'sec:diffeq:logistic'),
              (' Payback of a loan ',
               2,
               'sec:diffeq:loan:sec',
               'sec:diffeq:loan:sec'),
              (' The integral as a difference equation ',
               2,
               'sec:diffeq:integral',
               'sec:diffeq:integral'),
              (' Taylor series as a difference equation ',
               2,
               'sec:diffeq:Taylor:exp',
               'sec:diffeq:Taylor:exp'),
              (' Making a living from a fortune ', 2, None, '___sec9'),
              (" Newton's method ",
               2,
               'sec:diffeq:Newtonsmethod:sec',
               'sec:diffeq:Newtonsmethod:sec'),
              (' The inverse of a function ',
               2,
               'sec:diffeq:inversefunc',
               'sec:diffeq:inversefunc'),
              (' Programming with sound ',
               1,
               'sec:diffeq:sound',
               'sec:diffeq:sound'),
              (' Writing sound to file ', 2, None, '___sec13'),
              (' Reading sound from file ', 2, None, '___sec14'),
              (' Playing many notes ',
               2,
               'sec:diffeq:sound:create',
               'sec:diffeq:sound:create'),
              (' Music of a sequence ', 2, None, '___sec16'),
              (' Problem ', 3, None, '___sec17'),
              (' Solution ', 3, None, '___sec18'),
              (' Exercises ', 1, None, '___sec19'),
              (' Exercise 1: Determine the limit of a sequence ',
               2,
               'sec:diffeq:ex8a',
               'sec:diffeq:ex8a'),
              (' Exercise 2: Compute $\\pi$ via sequences ',
               2,
               'sec:diffeq:ex9',
               'sec:diffeq:ex9'),
              (' Exercise 3: Reduce memory usage of difference equations ',
               2,
               'sec:diffeq:ex7',
               'sec:diffeq:ex7'),
              (' Exercise 4: Compute the development of a loan ',
               2,
               'sec:diffeq:ex3',
               'sec:diffeq:ex3'),
              (' Exercise 5: Solve a system of difference equations ',
               2,
               'sec:diffeq:ex4',
               'sec:diffeq:ex4'),
              (' Exercise 6: Modify a model for fortune development ',
               2,
               'sec:diffeq:ex4c',
               'sec:diffeq:ex4c'),
              (' Exercise 7: Change index in a difference equation ',
               2,
               'sec:diffeq:ex1',
               'sec:diffeq:ex1'),
              (' Exercise 8: Construct time points from dates ',
               2,
               'sec:diffeq:ex2',
               'sec:diffeq:ex2'),
              (" Exercise 9: Visualize the convergence of Newton's method ",
               2,
               'sec:diffeq:ex13',
               'sec:diffeq:ex13'),
              (' Exercise 10: Implement the secant method ',
               2,
               'sec:diffeq:ex14b',
               'sec:diffeq:ex14b'),
              (' Exercise 11: Test different methods for root finding ',
               2,
               'sec:diffeq:ex14c',
               'sec:diffeq:ex14c'),
              (' Exercise 12: Make difference equations for the Midpoint rule ',
               2,
               'sec:diffeq:ex:midpoint:int',
               'sec:diffeq:ex:midpoint:int'),
              (' Exercise 13: Compute the arc length of a curve ',
               2,
               'sec:diffeq:ex:arclength',
               'sec:diffeq:ex:arclength'),
              (' Exercise 14: Find difference equations for computing $\\sin x$ ',
               2,
               'sec:diffeq:ex11b',
               'sec:diffeq:ex11b'),
              (' Exercise 15: Find difference equations for computing $\\cos x$ ',
               2,
               'sec:diffeq:ex15',
               'sec:diffeq:ex15'),
              (' Exercise 16: Make a guitar-like sound ',
               2,
               'sec:sound:ex1',
               'sec:sound:ex1'),
              (' Exercise 17: Damp the bass in a sound file ',
               2,
               'sec:sound:ex2',
               'sec:sound:ex2'),
              (' Exercise 18: Damp the treble in a sound file ',
               2,
               'sec:sound:ex3',
               'sec:sound:ex3'),
              (' Exercise 19: Demonstrate oscillatory solutions of (ref{sec:diffeq:logistic:eq2}) ',
               2,
               'sec:diffeq:ex16',
               'sec:diffeq:ex16'),
              (' Exercise 20: Automate computer experiments ',
               2,
               'sec:diffeq:ex17',
               'sec:diffeq:ex17'),
              (' Exercise 21: Generate an HTML report ',
               2,
               'sec:diffeq:ex18',
               'sec:diffeq:ex18'),
              (' Exercise 22: Use a class to archive and report experiments ',
               2,
               'sec:diffeq:ex19',
               'sec:diffeq:ex19'),
              (' Exercise 23: Explore logistic growth interactively ',
               2,
               'sec:diffeq:ex20',
               'sec:diffeq:ex20'),
              (' Exercise 24: Simulate the price of wheat ',
               2,
               'sec:diffeq:ex21',
               'sec:diffeq:ex21'),
              (' References ', 1, None, '___sec44')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="diffeq-readable.html">Sequences and difference equations</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._diffeq-readable001.html#___sec0" style="font-size: 80%;">Mathematical models based on difference equations</a></li>
     <!-- navigation toc: --> <li><a href="._diffeq-readable002.html#sec:diffeq:sound" style="font-size: 80%;">Programming with sound</a></li>
     <!-- navigation toc: --> <li><a href="._diffeq-readable003.html#___sec19" style="font-size: 80%;">Exercises</a></li>
     <!-- navigation toc: --> <li><a href="._diffeq-readable003.html#___sec44" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0000"></a>
<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>Sequences and difference equations</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>


<p>
<!-- institution(s) -->

<center>[1] <b>Center for Biomedical Computing, Simula Research Laboratory</b></center>
<center>[2] <b>Department of Informatics, University of Oslo</b></center>
<p>
<center><h4>Dec 11, 2014</h4></center> <!-- date -->

<h2>Table of contents</h2>

<p>
<a href="._diffeq-readable001.html#___sec0"> Mathematical models based on difference equations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:irates"> Interest rates </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#___sec2"> The factorial as a difference equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#___sec3"> Fibonacci numbers </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:growth"> Growth of a population </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:logistic"> Logistic growth </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:loan:sec"> Payback of a loan </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:integral"> The integral as a difference equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:Taylor:exp"> Taylor series as a difference equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#___sec9"> Making a living from a fortune </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:Newtonsmethod:sec"> Newton's method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable001.html#sec:diffeq:inversefunc"> The inverse of a function </a><br>
<a href="._diffeq-readable002.html#sec:diffeq:sound"> Programming with sound </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#___sec13"> Writing sound to file </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#___sec14"> Reading sound from file </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#sec:diffeq:sound:create"> Playing many notes </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#___sec16"> Music of a sequence </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#___sec17"> Problem </a><br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="._diffeq-readable002.html#___sec18"> Solution </a><br>
<a href="._diffeq-readable003.html#___sec19"> Exercises </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex8a"> Exercise 1: Determine the limit of a sequence </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex9"> Exercise 2: Compute \( \pi \) via sequences </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex7"> Exercise 3: Reduce memory usage of difference equations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex3"> Exercise 4: Compute the development of a loan </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex4"> Exercise 5: Solve a system of difference equations </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex4c"> Exercise 6: Modify a model for fortune development </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex1"> Exercise 7: Change index in a difference equation </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex2"> Exercise 8: Construct time points from dates </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex13"> Exercise 9: Visualize the convergence of Newton's method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex14b"> Exercise 10: Implement the secant method </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex14c"> Exercise 11: Test different methods for root finding </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex:midpoint:int"> Exercise 12: Make difference equations for the Midpoint rule </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex:arclength"> Exercise 13: Compute the arc length of a curve </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex11b"> Exercise 14: Find difference equations for computing \( \sin x \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex15"> Exercise 15: Find difference equations for computing \( \cos x \) </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:sound:ex1"> Exercise 16: Make a guitar-like sound </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:sound:ex2"> Exercise 17: Damp the bass in a sound file </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:sound:ex3"> Exercise 18: Damp the treble in a sound file </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex16"> Exercise 19: Demonstrate oscillatory solutions of <a href="._diffeq-readable001.html#mjx-eqn-10">(10)</a> </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex17"> Exercise 20: Automate computer experiments </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex18"> Exercise 21: Generate an HTML report </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex19"> Exercise 22: Use a class to archive and report experiments </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex20"> Exercise 23: Explore logistic growth interactively </a><br>
&nbsp; &nbsp; &nbsp; <a href="._diffeq-readable003.html#sec:diffeq:ex21"> Exercise 24: Simulate the price of wheat </a><br>
<a href="._diffeq-readable003.html#___sec44"> References </a><br>
</p>
<p>
<!-- Externaldocuments: ../formulas/main_formulas, ../looplist/main_looplist, ../funcif/main_funcif, ../input/main_input, ../plot/main_plot, ../files/main_files, ../class/main_class, ../random/main_random, ../oo/main_oo, ../discalc/main_discalc, ../ode1/main_ode1, ../boxspring/main_boxspring, ../ode2/main_ode2, ../debug/main_debug, ../cython/main_cython, ../tech/main_timing, ../tech/main_varargs, ../tech/main_runpy, ../tech/main_ostasks, ../tech/main_accesspy, ../tech/main_nose -->

<p>
<a name="ch:diffeq"></a>

<p>
From mathematics you probably know the concept of a
<em>sequence</em>, which is nothing but a collection of numbers
with a specific order. A general sequence is written as

$$
\begin{equation*} x_0,\ x_1,\ x_2,\ \ldots,\ x_n,\ldots, \end{equation*}
$$

One example is the sequence of all odd numbers:

$$
\begin{equation*} 1, 3, 5, 7, \ldots, 2n+1,\ldots \end{equation*}
$$

For this sequence we have an explicit formula for the \( n \)-th term:
\( 2n+1 \), and \( n \) takes on the values 0, 1, 2, \( \ldots \).
We can write this sequence more compactly as \( (x_n)_{n=0}^\infty \)
with \( x_n=2n+1 \).
Other examples of infinite sequences from mathematics are

$$
\begin{equation} 1,\ 4,\ 9,\ 16,\ 25,\ \ldots\quad (x_n)_{n=0}^\infty,\ x_n=(n+1)^2,
\end{equation}
$$


$$
\begin{equation} 1,\ \frac{1}{2},\ \frac{1}{3},\ \frac{1}{4},\ \ldots\quad (x_n)_{n=0}^\infty,\ 
x_n={1\over n+1}\tp
\end{equation}
$$


<p>
The former sequences are infinite, because they are generated from all
integers \( \geq 0 \) and there are infinitely many such integers.
Nevertheless, most sequences from real life applications are finite.
If you put an amount \( x_0 \) of money in a bank, you will get an interest
rate and therefore have an amount \( x_1 \) after one year, \( x_2 \) after
two years, and \( x_N \) after \( N \) years. This process results in a
finite sequence of amounts

$$
\begin{equation*} x_0, x_1, x_2,\ldots, x_N,\quad (x_n)_{n=0}^N\tp\end{equation*}
$$

Usually we are interested in quite small \( N \) values
(typically \( N\leq 20-30 \)). Anyway, the life of the bank is finite, so
the sequence definitely has an end.

<p>
For some sequences it is not so easy to set up a general formula
for the \( n \)-th term. Instead, it is easier to express a relation
between two or more consecutive elements. One example where we can
do both things is the sequence of odd numbers. This sequence can
alternatively be generated by the formula

$$
\begin{equation}
x_{n+1} = x_{n} + 2\tp
\tag{1}
\end{equation}
$$

To start the sequence, we need an <em>initial condition</em> where the
value of the first element is specified:

$$
\begin{equation*} x_0 = 1\tp\end{equation*}
$$

Relations like <a href="#mjx-eqn-1">(1)</a>
between consecutive elements in a sequence is called
recurrence relations or <em>difference equations</em>.
Solving a difference equation can be quite challenging in mathematics,
but it is almost trivial to solve it on a computer.
That is why difference equations are so well suited for computer programming,
and the present document is devoted to this topic.
Necessary background knowledge is programming with loops,
arrays, and command-line arguments and visualization of a function of
one variable.

<p>
The program examples regarding difference equations
are found in the folder <a href="http://tinyurl.com/pwyasaa/diffeq" target="_self"><tt>src/diffeq</tt></a>.
<!-- There are also some program examples involving sound, and these -->
<!-- are stored in <a href="http://tinyurl.com/pwyasaa/sound" target="_self"><tt>src/sound</tt></a> at the time of this writing. -->

<p>


<p><a href="._diffeq-readable001.html" class="btn btn-primary btn-lg">Read &raquo;</a></p>


</div> <!-- end jumbotron -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="next">
    <a href="._diffeq-readable001.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

