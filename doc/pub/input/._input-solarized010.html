<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="User input and error handling">
<meta name="keywords" content="command-line arguments,option-value pairs (command line),standard input,standard output,standard error,bytes,bits,exceptions,widgets,event loop,modules,test block (in module files),test function,nose tests,pytest tests,unit testing,search for module files,module folders,refactoring,binomial distribution,Bernoulli trials,Poisson distribution,Poisson process">

<title>User input and error handling</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Asking questions and reading answers',
               1,
               'sec:input:rawinput',
               'sec:input:rawinput'),
              ('Reading keyboard input',
               2,
               'sec:input:rawinput2',
               'sec:input:rawinput2'),
              ('Reading from the command line',
               1,
               'sec:input:sysargv',
               'sec:input:sysargv'),
              ('Providing input on the command line',
               2,
               'sec:input:cml',
               'sec:input:cml'),
              ('A variable number of command-line arguments',
               2,
               None,
               '___sec4'),
              ('More on command-line arguments', 2, None, '___sec5'),
              ('Turning user text into live objects', 1, None, '___sec6'),
              ('The magic eval function',
               2,
               'sec:input:eval',
               'sec:input:eval'),
              ('Applying eval to strings', 3, None, '___sec8'),
              ('Applying eval to user input', 3, None, '___sec9'),
              ('The magic exec function',
               2,
               'sec:input:exec',
               'sec:input:exec'),
              ('Turning string expressions into functions',
               2,
               'sec:input:StringFunction',
               'sec:input:StringFunction'),
              ('Option-value pairs on the command line',
               1,
               'sec:input:argparse',
               'sec:input:argparse'),
              ('Basic usage of the argparse module', 2, None, '___sec13'),
              ('Mathematical expressions as values', 2, None, '___sec14'),
              ('Reading data from file',
               1,
               'sec:files:reading',
               'sec:files:reading'),
              ('Reading a file line by line', 2, None, '___sec16'),
              ('Alternative ways of reading a file',
               2,
               'sec:files:reading:other',
               'sec:files:reading:other'),
              ('The modern with statement', 3, None, '___sec18'),
              ('The old while construction', 3, None, '___sec19'),
              ('Reading a file into a string', 3, None, '___sec20'),
              ('Reading a mixture of text and numbers',
               2,
               'sec:files:textnum',
               'sec:files:textnum'),
              ('Is it more to file reading?', 3, None, '___sec22'),
              ('Writing data to file',
               1,
               'sec:files:writing',
               'sec:files:writing'),
              ('Example: Writing a table to file', 2, None, '___sec24'),
              ('Problem', 3, None, '___sec25'),
              ('Solution', 3, None, '___sec26'),
              ('Standard input and output as file objects',
               2,
               None,
               '___sec27'),
              ('Redirecting standard input, output, and error',
               3,
               None,
               '___sec28'),
              ('Note', 3, None, '___sec29'),
              ('What is a file, really?',
               2,
               'sec:files:really',
               'sec:files:really'),
              ('Pure text files', 3, None, '___sec31'),
              ('Word processor files', 3, None, '___sec32'),
              ('Image files', 3, None, '___sec33'),
              ('Music files', 3, None, '___sec34'),
              ('PDF files', 3, None, '___sec35'),
              ('Remarks', 3, None, '___sec36'),
              ('Handling errors', 1, 'sec:input:except', 'sec:input:except'),
              ('Exception handling',
               2,
               'sec:input:except:handling',
               'sec:input:except:handling'),
              ('Testing for a specific exception', 3, None, '___sec39'),
              ('Examples on exception types', 3, None, '___sec40'),
              ('Digression', 3, None, '___sec41'),
              ('Raising exceptions', 2, None, '___sec42'),
              ('Example', 3, None, '___sec43'),
              ('A glimpse of graphical user interfaces',
               1,
               'sec:input:GUI',
               'sec:input:GUI'),
              ('Making modules', 1, 'sec:input:modules', 'sec:input:modules'),
              ('Example: Interest on bank deposits', 2, None, '___sec46'),
              ('Collecting functions in a module file',
               2,
               'sec:input:module:create',
               'sec:input:module:create'),
              ('Test block',
               2,
               'sec:input:module:testblock',
               'sec:input:module:testblock'),
              ('Example on a test block in a minimalistic module',
               3,
               None,
               '___sec49'),
              ('A test block in the `interest` module', 3, None, '___sec50'),
              ('Verification of the module code',
               2,
               'sec:input:modules:testfunc',
               'sec:input:modules:testfunc'),
              ('Getting input data',
               2,
               'sec:input:modules:inputdata',
               'sec:input:modules:inputdata'),
              ('Doc strings in modules', 2, None, '___sec53'),
              ('Using modules',
               2,
               'sec:input:modules:usage',
               'sec:input:modules:usage'),
              ('What gets imported by various import statements?',
               3,
               None,
               '___sec55'),
              ('How to make Python find a module file', 3, None, '___sec56'),
              ('How to make Python run the module file', 3, None, '___sec57'),
              ('Distributing modules',
               2,
               'sec:input:modules:setuppy',
               'sec:input:modules:setuppy'),
              ('Making software available on the Internet',
               2,
               None,
               '___sec59'),
              ('Making code for Python 2 and 3',
               1,
               'sec:input:py23',
               'sec:input:py23'),
              ('Basic differences between Python 2 and 3',
               2,
               None,
               '___sec61'),
              ('The print statement has changed', 3, None, '___sec62'),
              ('Integer division is not an issue in Python 3',
               3,
               None,
               '___sec63'),
              ('The `raw_input` function is named `input` in Python 3',
               3,
               None,
               '___sec64'),
              ('Turning Python 2 code into Python 3 code',
               2,
               None,
               '___sec65'),
              ('Summary', 1, 'sec:input:summary', 'sec:input:summary'),
              ('Chapter topics',
               2,
               'sec:input:summary:topics',
               'sec:input:summary:topics'),
              ('Question and answer input', 3, None, '___sec68'),
              ('Getting command-line arguments', 3, None, '___sec69'),
              ('Using option-value pairs', 3, None, '___sec70'),
              ('Generating code on the fly', 3, None, '___sec71'),
              ('Turning string formulas into Python functions',
               3,
               None,
               '___sec72'),
              ('File operations', 3, None, '___sec73'),
              ('Handling exceptions', 3, None, '___sec74'),
              ('Raising exceptions', 3, None, '___sec75'),
              ('Modules', 3, None, '___sec76'),
              ('Terminology', 3, None, '___sec77'),
              ('Example: Bisection root finding',
               2,
               'sec:input:summarizingex',
               'sec:input:summarizingex'),
              ('Problem', 3, None, '___sec79'),
              ('Solution', 3, None, '___sec80'),
              ('Verification', 3, None, '___sec81'),
              ('Making a function', 3, None, '___sec82'),
              ('Making a test function', 3, None, '___sec83'),
              ('Making a module', 3, None, '___sec84'),
              ('Defining a user interface', 3, None, '___sec85'),
              ('Using the module', 3, None, '___sec86'),
              ('Potential problems with the software', 3, None, '___sec87'),
              ('Distributing the bisection module to others',
               3,
               None,
               '___sec88'),
              ('Exercises', 1, None, '___sec89'),
              ('Exercise 1: Make an interactive program',
               2,
               'sec:input:ex24',
               'sec:input:ex24'),
              ('Exercise 2: Read a number from the command line',
               2,
               'sec:input:ex24b',
               'sec:input:ex24b'),
              ('Exercise 3: Read a number from a file',
               2,
               'sec:input:ex24bfile',
               'sec:input:ex24bfile'),
              ('Exercise 4: Read and write several numbers from and to file',
               2,
               'sec:input:ex24bfile2',
               'sec:input:ex24bfile2'),
              ('Exercise 5: Use exceptions to handle wrong input',
               2,
               'sec:input:ex24c',
               'sec:input:ex24c'),
              ('Exercise 6: Read input from the keyboard',
               2,
               'sec:input:ex25',
               'sec:input:ex25'),
              ('Exercise 7: Read input from the command line',
               2,
               'sec:input:ex26',
               'sec:input:ex26'),
              ('Exercise 8: Try MSWord or LibreOffice to write a program',
               2,
               'sec:files:ex7',
               'sec:files:ex7'),
              ('Exercise 9: Prompt the user for input to a formula',
               2,
               'sec:input:ex6',
               'sec:input:ex6'),
              ('Exercise 10: Read parameters in a formula from the command line',
               2,
               'sec:input:ex5',
               'sec:input:ex5'),
              ('Exercise 11: Use exceptions to handle wrong input',
               2,
               'sec:input:ex8b',
               'sec:input:ex8b'),
              ('Exercise 12: Test validity of input data',
               2,
               'sec:input:ex7',
               'sec:input:ex7'),
              ('Exercise 13: Raise an exception in case of wrong input',
               2,
               'sec:input:ex8',
               'sec:input:ex8'),
              ('Exercise 14: Evaluate a formula for data in a file',
               2,
               'sec:input:ex:ball:file',
               'sec:input:ex:ball:file'),
              ('Exercise 15: Write a function given its test function',
               2,
               'sec:input:ex:testffirst',
               'sec:input:ex:testffirst'),
              ('Exercise 16: Compute the distance it takes to stop a car',
               2,
               'sec:input:ex21',
               'sec:input:ex21'),
              ('Exercise 17: Look up calendar functionality',
               2,
               'sec:input:ex48',
               'sec:input:ex48'),
              ('Exercise 18: Use the StringFunction tool',
               2,
               'sec:input:ex28b',
               'sec:input:ex28b'),
              ('Exercise 19: Why we test for specific exception types',
               2,
               'sec:input:ex11',
               'sec:input:ex11'),
              ('Exercise 20: Make a complete module',
               2,
               'sec:input:ex27',
               'sec:input:ex27'),
              ('Exercise 21: Organize a previous program as a module',
               2,
               'sec:input:ex17',
               'sec:input:ex17'),
              ('Exercise 22: Read options and values from the command line',
               2,
               'sec:input:ex19',
               'sec:input:ex19'),
              ('Exercise 23: Check if mathematical identities hold',
               2,
               'sec:input:ex2',
               'sec:input:ex2'),
              ('Exercise 24: Compute probabilities with the binomial distribution',
               2,
               'sec:input:ex15',
               'sec:input:ex15'),
              ('Exercise 25: Compute probabilities with the Poisson distribution',
               2,
               'sec:input:ex16',
               'sec:input:ex16'),
              ('References', 1, None, '___sec115')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<a name="part0010"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._input-solarized009.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._input-solarized011.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->
<p style="font-size:80%">This chapter is taken from the book <a href="http://www.springer.com/gp/book/9783662498866">A Primer on Scientific Programming with Python</a> by H. P. Langtangen, 5th edition, Springer, 2016.</p>

<h1 id="sec:input:py23">Making code for Python 2 and 3</h1>

<p>
This book applies Python version 2.7, but there is a newer version of
Python called Python 3 (the current version is 3.5).
Unfortunately, Python 2 programs do not work with Python 3 and vice versa.
Newcomers to Python are normally guided to pick up version 3 rather than
version 2, since the former has many improvements and represents the
future of the language. However, for scientific computing, version 3
still lacks many useful libraries, and that is the reason why this book
applies Python version 2.7.

<h2 id="___sec61">Basic differences between Python 2 and 3 </h2>

<p>
So, what are the major differences between version 2 and 3? We cover
only the three differences that involve statements we have seen so
far in the book.

<h3 id="___sec62">The print statement has changed </h3>

<p>
Here are some examples on print statements in Python 2:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>a = 1
print a
print 'The value of a is', a
print 'The value of a is', a,  # comma prevents newline
b = 2
print 'and b=%g' % b
</code></pre>
<!-- end verbatim block -->
The print statement is not a statement anymore, but a function in
Python 3. The above code needs to be written as

<p>
<!-- begin verbatim block  pycod-->
<pre><code>a = 1
print(a)
print('The value of a is', a)
print('The value of a is', a, end=' ')  # end='' prevents newline
b = 2
print('and b=%g' % b)
</code></pre>
<!-- end verbatim block -->

<h3 id="___sec63">Integer division is not an issue in Python 3 </h3>

<p>
The expression <code>1/10</code> is <code>0</code> in Python 2, while in Python 3 it equals
<code>0.1</code>. Nevertheless, there are so many computer languages and tools
that interpret as <code>1/10</code> integer division, so rather than relying on
a language's interpretation of integer divided by integer as float
division, the programmer is strongly encouraged to turn one of
the operands explicitly to float, as in <code>1.0/10</code>.

<h3 id="___sec64">The <code>raw_input</code> function is named <code>input</code> in Python 3 </h3>

<p>
The Python 2 code

<p>
<!-- begin verbatim block  pycod-->
<pre><code>a = float(raw_input('Give a: '))
</code></pre>
<!-- end verbatim block -->
reads

<p>
<!-- begin verbatim block  pycod-->
<pre><code>a = float(input('Give a: '))
</code></pre>
<!-- end verbatim block -->
in Python 3.

<p>
Note that in Python 2 there is an <code>input</code> function which equals
<code>eval</code> applied to <code>raw_input</code>:

<p>
<!-- begin verbatim block  pycod-->
<pre><code>a = input('Give a: ')  # Python 2!
# Equivalent to
a = eval(raw_input('Give a: '))
</code></pre>
<!-- end verbatim block -->

<h2 id="___sec65">Turning Python 2 code into Python 3 code </h2>

<p>
Suppose you have written some Python 2 code according to this book and
want it to run under Python 3. We strongly recommend to create a <em>common
version</em> of your program such that it works under both Python 2 and 3.
This is quite easy if you use the <a href="http://python-future.org/" target="_self"><tt>future</tt></a>
package (it is easily
installed by <code>pip install future</code>).

<p>
The <code>future</code> package has a program <code>futurize</code> that can rewrite a
<code>.py</code> file such that it works under Python 2 and 3. Let us grab a
file <code>c2f_qa.py</code>,

<p>
<!-- begin verbatim block  pypro-->
<pre><code>C = raw_input('C=? ')
C = float(C)
F = 9.0/5*C + 32
print F
</code></pre>
<!-- end verbatim block -->
and convert it by

<p>
<!-- begin verbatim block  sys-->
<pre><code>Terminal&gt; futurize -w c2f_qa.py
</code></pre>
<!-- end verbatim block -->
Now <code>c2f_qa.py</code> has the content

<p>
<!-- begin verbatim block  pypro-->
<pre><code>from __future__ import print_function
from builtins import input
C = input('C=? ')
C = float(C)
F = 9.0/5*C + 32
print(F)
</code></pre>
<!-- end verbatim block -->
We notice that the <code>raw_input</code> call has been changed to <code>input</code> and that
the print statement is a call to the <code>print</code> function. A simple test
shows that the new file runs on both versions of Python:

<p>
<!-- begin verbatim block  sys-->
<pre><code>Terminal&gt; python2 c2f_qa.py
C=? 21
69.8
Terminal&gt; python3 py3/c2f_qa.py
C=? 21
69.80000000000001
</code></pre>
<!-- end verbatim block -->
(This test requires that you have Python 3 installed.)

<p>
Note that if we change the division <code>9.0/5</code> in the file to <code>9/5</code>,
<code>futurize</code> will not make a float division out of that expression
(i.e., the Python 2 meaning of the syntax is not changed).
If we want all syntax to be interpreted the Python 3 way, add the
<code>--all-imports</code> option:

<p>
<!-- begin verbatim block  sys-->
<pre><code>Terminal&gt; futurize -w --all-imports c2f_qa.py
</code></pre>
<!-- end verbatim block -->
The result is

<p>
<!-- begin verbatim block  pycod-->
<pre><code>from __future__ import unicode_literals
from __future__ import print_function
from __future__ import division
from __future__ import absolute_import
from future import standard_library
standard_library.install_aliases()
from builtins import input
from builtins import *
C = input('C=? ')
C = float(C)
F = 9/5*C + 32
print(F)
</code></pre>
<!-- end verbatim block -->
Now, <code>9/5</code> represents float division, and the program runs under both versions
of Python.

<p>
Usually, you do not want <code>futurize</code> to overwrite your original Python 2
program, but it is easy to let it generate the new version in a
subfolder instead:

<p>
<!-- begin verbatim block  sys-->
<pre><code>Terminal&gt; futurize -w -n -o py23 c2f_qa.py
</code></pre>
<!-- end verbatim block -->
The generated new version of <code>c2f_qa.py</code> is now in <code>py23/c2f_qa.py</code>.

<p>
Most of the programs in this book apply the command line for input, and
the programmer should fix all issues about integer division, so
running <code>futurize</code> on the programs you have seen so far will just change
the print statement. There are more challenging differences between
Python 2 and 3 when one applies more advanced objects and modules.

<p>
<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._input-solarized009.html">&laquo; Previous</a></div>
</td><td>
<div style="text-align: right;"><a href="._input-solarized011.html">Next &raquo;</a></div>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

