<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Functions and branching">
<meta name="keywords" content="function header,function body,body of a function,call a function,invoke a function,Online Python Tutor,keyword arguments,function arguments keyword,positional arguments,function arguments positional,named arguments,function arguments named,doc strings,main program,lambda functions,lambda functions,test function,unit testing,nose tests,pytest tests,mod function,Online Python Tutor,Trapezoidal rule for integration,Midpoint rule for integration,Fourier series,Heaviside function,sort (list)">

<title>Functions and branching</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px; /* fixed header height*/
  margin:-50px 0 0; /* negative fixed header height */
}

body { font-size:20px;line-height:1.5--html_body_style=font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Functions', 1, None, '___sec0'),
              ('Mathematical functions as Python functions',
               2,
               'sec:basic:func1',
               'sec:basic:func1'),
              ('Understanding the program flow',
               2,
               'sec:basic:pot',
               'sec:basic:pot'),
              ('Local and global variables',
               2,
               'sec:basic:localglobal',
               'sec:basic:localglobal'),
              ('Local variables are invisible outside functions',
               3,
               None,
               '___sec4'),
              ('Local variables hide global variables', 3, None, '___sec5'),
              ('Example', 3, None, '___sec6'),
              ('Changing global variables inside functions',
               3,
               None,
               '___sec7'),
              ('Multiple arguments',
               2,
               'sec:basic:multiple:args',
               'sec:basic:multiple:args'),
              ('Function argument or global variable?',
               2,
               'sec:basic:arg:or:global',
               'sec:basic:arg:or:global'),
              ('Beyond mathematical functions',
               2,
               'sec:basic:makelist',
               'sec:basic:makelist'),
              ('Remark 1', 3, None, '___sec11'),
              ('Remark 2', 3, None, '___sec12'),
              ('Multiple return values',
               2,
               'sec:basic:multiple:returns',
               'sec:basic:multiple:returns'),
              ('Computing sums', 2, 'sec:basic:sum', 'sec:basic:sum'),
              ('Functions with no return values',
               2,
               'sec:basic:None',
               'sec:basic:None'),
              ('Keyword arguments',
               2,
               'sec:basic:kwargs',
               'sec:basic:kwargs'),
              ('Example: Function with default parameters',
               3,
               None,
               '___sec17'),
              ('Example: Computing a sum with default tolerance',
               3,
               None,
               '___sec18'),
              ('Doc strings',
               2,
               'sec:basic:docstring',
               'sec:basic:docstring'),
              ('Functions as arguments to functions',
               2,
               'sec:basic:farg',
               'sec:basic:farg'),
              ('The behavior of the numerical derivative as $h\\rightarrow 0$',
               3,
               None,
               '___sec21'),
              ('The main program', 2, None, '___sec22'),
              ('Lambda functions',
               2,
               'sec:basic:lambdafunc',
               'sec:basic:lambdafunc'),
              ('Branching', 1, 'sec:input:if', 'sec:input:if'),
              ('If-else blocks', 2, None, '___sec25'),
              ('Inline if tests', 2, None, '___sec26'),
              ('Summary', 1, 'sec:funcif:summary', 'sec:funcif:summary'),
              ('Chapter topics', 2, None, '___sec28'),
              ('User-defined functions', 3, None, '___sec29'),
              ('Keyword arguments', 3, None, '___sec30'),
              ('If tests', 3, None, '___sec31'),
              ('Inline if tests', 3, None, '___sec32'),
              ('Terminology', 3, None, '___sec33'),
              ('Example: Numerical integration',
               2,
               'sec:funcif:summary:ex',
               'sec:funcif:summary:ex'),
              ('Problem', 3, None, '___sec35'),
              ('Solution', 3, None, '___sec36'),
              ('Verification', 3, None, '___sec37'),
              ('Unit tests and test functions', 3, None, '___sec38'),
              ('Checking the validity of function arguments',
               3,
               None,
               '___sec39'),
              ('Exercises', 1, None, '___sec40'),
              ('Exercise 1: Implement a simple mathematical function',
               2,
               'sec:basic:ex:exp',
               'sec:basic:ex:exp'),
              ('Exercise 2: Implement a simple mathematical function with a parameter',
               2,
               'sec:basic:ex:exp2',
               'sec:basic:ex:exp2'),
              ('Exercise 3: Explain how a program works',
               2,
               'sec:basic:ex48',
               'sec:basic:ex48'),
              ('Exercise 4: Write a Fahrenheit-Celsius conversion functions',
               2,
               'sec:basic:ex26b',
               'sec:basic:ex26b'),
              ('Exercise 5: Write a test function for Exercise ref{sec:basic:ex26b}',
               2,
               'sec:basic:ex26b2',
               'sec:basic:ex26b2'),
              ('Exercise 6: Given a test function, write the function',
               2,
               'sec:basic:ex:testfunc1',
               'sec:basic:ex:testfunc1'),
              ('Exercise 7: Evaluate a sum and write a test function',
               2,
               'sec:basic:ex29d',
               'sec:basic:ex29d'),
              ('Exercise 8: Write a function for solving $ax^2 + bx + c =0$',
               2,
               'sec:funcif:ex1',
               'sec:funcif:ex1'),
              ('Exercise 9: Implement the sum function',
               2,
               'sec:input:ex1',
               'sec:input:ex1'),
              ('Exercise 10: Compute a polynomial via a product',
               2,
               'sec:basic:ex32',
               'sec:basic:ex32'),
              ('Exercise 11: Integrate a function by the Trapezoidal rule',
               2,
               'sec:basic:ex38',
               'sec:basic:ex38'),
              ('Remarks', 3, None, '___sec52'),
              ('Exercise 12: Derive the general Midpoint integration rule',
               2,
               'sec:basic:ex39c',
               'sec:basic:ex39c'),
              ('Exercise 13: Make an adaptive Trapezoidal rule',
               2,
               'sec:basic:ex39d',
               'sec:basic:ex39d'),
              ('Remarks', 3, None, '___sec55'),
              ('Exercise 14: Simulate a program by hand',
               2,
               'sec:basic:ex:locglob',
               'sec:basic:ex:locglob'),
              ('Exercise 15: Debug a given test function',
               2,
               'sec:basic:ex:testfunc2',
               'sec:basic:ex:testfunc2'),
              ('Exercise 16: Compute the area of an arbitrary triangle',
               2,
               'sec:basic:ex25',
               'sec:basic:ex25'),
              ('Exercise 17: Compute the length of a path',
               2,
               'sec:basic:ex25b',
               'sec:basic:ex25b'),
              ('Exercise 18: Approximate $\\pi$',
               2,
               'sec:basic:ex25c',
               'sec:basic:ex25c'),
              ('Exercise 19: Compute the area of a polygon',
               2,
               'sec:funcif:exer:area:polygon',
               'sec:funcif:exer:area:polygon'),
              ('Exercise 20: Write functions',
               2,
               'sec:basic:ex42a',
               'sec:basic:ex42a'),
              ('Exercise 21: Approximate a function by a sum of sines',
               2,
               'sec:formula:ex10',
               'sec:formula:ex10'),
              ('Remarks', 3, None, '___sec64'),
              ('Exercise 22: Implement a Gaussian function',
               2,
               'sec:basic:ex33',
               'sec:basic:ex33'),
              ('Exercise 23: Wrap a formula in a function',
               2,
               'sec:basic:ex46',
               'sec:basic:ex46'),
              ('Exercise 24: Write a function for numerical differentiation',
               2,
               'sec:basic:ex38a',
               'sec:basic:ex38a'),
              ('Exercise 25: Implement the factorial function',
               2,
               'sec:basic:ex35',
               'sec:basic:ex35'),
              ('Exercise 26: Compute velocity and acceleration from 1D position data',
               2,
               'sec:basic:ex29q',
               'sec:basic:ex29q'),
              ('Exercise 27: Find the max and min values of a function',
               2,
               'sec:basic:ex29g',
               'sec:basic:ex29g'),
              ('Exercise 28: Find the max and min elements in a list',
               2,
               'sec:basic:ex29g2',
               'sec:basic:ex29g2'),
              ('Exercise 29: Implement the Heaviside function',
               2,
               'sec:basic:exH1',
               'sec:basic:exH1'),
              ('Exercise 30: Implement a smoothed Heaviside function',
               2,
               'sec:basic:exH2',
               'sec:basic:exH2'),
              ('Exercise 31: Implement an indicator function',
               2,
               'sec:basic:exH3',
               'sec:basic:exH3'),
              ('Exercise 32: Implement a piecewise constant function',
               2,
               'sec:basic:exH4',
               'sec:basic:exH4'),
              ('Exercise 33: Apply indicator functions',
               2,
               'sec:basic:exH4b',
               'sec:basic:exH4b'),
              ('Exercise 34: Test your understanding of branching',
               2,
               'sec:basic:ex49',
               'sec:basic:ex49'),
              ('Exercise 35: Simulate nested loops by hand',
               2,
               'sec:basic:ex40',
               'sec:basic:ex40'),
              ('Exercise 36: Rewrite a mathematical function',
               2,
               'sec:basic:ex29f',
               'sec:basic:ex29f'),
              ('Exercise 37: Make a table for approximations of $\\cos x$',
               2,
               'sec:basic:ex29e',
               'sec:basic:ex29e'),
              ('Exercise 38: Use None in keyword arguments',
               2,
               'sec:basic:ex31b',
               'sec:basic:ex31b'),
              ('Exercise 39: Write a sort function for a list of 4-tuples',
               2,
               'sec:basic:ex28',
               'sec:basic:ex28'),
              ('Exercise 40: Find prime numbers',
               2,
               'sec:basic:ex37',
               'sec:basic:ex37'),
              ('Exercise 41: Resolve a problem with a function',
               2,
               'sec:input:ex35',
               'sec:input:ex35'),
              ('Exercise 42: Determine the types of some objects',
               2,
               'sec:basic:ex20',
               'sec:basic:ex20'),
              ('Remarks', 3, None, '___sec86'),
              ('Exercise 43: Find an error in a program',
               2,
               'sec:basic:ex34',
               'sec:basic:ex34'),
              ('References', 1, None, '___sec88')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="funcif-readable.html">Functions and branching</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._funcif-readable000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec0" style="font-size: 80%;"><b>Functions</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:func1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical functions as Python functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:pot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Understanding the program flow</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:localglobal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Local and global variables</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local variables are invisible outside functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local variables hide global variables</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changing global variables inside functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:multiple:args" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Multiple arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:arg:or:global" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Function argument or global variable?</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:makelist" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Beyond mathematical functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark 1</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark 2</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:multiple:returns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Multiple return values</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:sum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing sums</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:None" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions with no return values</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:kwargs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Function with default parameters</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Computing a sum with default tolerance</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:docstring" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Doc strings</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:farg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions as arguments to functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The behavior of the numerical derivative as \( h\rightarrow 0 \)</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The main program</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable001.html#sec:basic:lambdafunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Lambda functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable002.html#sec:input:if" style="font-size: 80%;"><b>Branching</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable002.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If-else blocks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable002.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Inline if tests</a></li>
     <!-- navigation toc: --> <li><a href="#sec:funcif:summary" style="font-size: 80%;"><b>Summary</b></a></li>
     <!-- navigation toc: --> <li><a href="#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Chapter topics</a></li>
     <!-- navigation toc: --> <li><a href="#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User-defined functions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inline if tests</a></li>
     <!-- navigation toc: --> <li><a href="#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Terminology</a></li>
     <!-- navigation toc: --> <li><a href="#sec:funcif:summary:ex" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Numerical integration</a></li>
     <!-- navigation toc: --> <li><a href="#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem</a></li>
     <!-- navigation toc: --> <li><a href="#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit tests and test functions</a></li>
     <!-- navigation toc: --> <li><a href="#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checking the validity of function arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec40" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex:exp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Implement a simple mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex:exp2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Implement a simple mathematical function with a parameter</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Explain how a program works</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex26b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Write a Fahrenheit-Celsius conversion functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex26b2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Write a test function for Exercise ref{sec:basic:ex26b}</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex:testfunc1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Given a test function, write the function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Evaluate a sum and write a test function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:funcif:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Write a function for solving \( ax^2 + bx + c =0 \)</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:input:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Implement the sum function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Compute a polynomial via a product</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 11: Integrate a function by the Trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex39c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 12: Derive the general Midpoint integration rule</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex39d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 13: Make an adaptive Trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex:locglob" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 14: Simulate a program by hand</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex:testfunc2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 15: Debug a given test function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 16: Compute the area of an arbitrary triangle</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex25b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 17: Compute the length of a path</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex25c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 18: Approximate \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:funcif:exer:area:polygon" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 19: Compute the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex42a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 20: Write functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:formula:ex10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 21: Approximate a function by a sum of sines</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 22: Implement a Gaussian function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex46" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 23: Wrap a formula in a function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex38a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 24: Write a function for numerical differentiation</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 25: Implement the factorial function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29q" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 26: Compute velocity and acceleration from 1D position data</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29g" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 27: Find the max and min values of a function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29g2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 28: Find the max and min elements in a list</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:exH1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 29: Implement the Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:exH2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 30: Implement a smoothed Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:exH3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 31: Implement an indicator function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:exH4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 32: Implement a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:exH4b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 33: Apply indicator functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 34: Test your understanding of branching</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex40" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 35: Simulate nested loops by hand</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29f" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 36: Rewrite a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex29e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 37: Make a table for approximations of \( \cos x \)</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex31b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 38: Use None in keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 39: Write a sort function for a list of 4-tuples</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 40: Find prime numbers</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:input:ex35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 41: Resolve a problem with a function</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 42: Determine the types of some objects</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#sec:basic:ex34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 43: Find an error in a program</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-readable004.html#___sec88" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0003"></a>
<!-- !split -->
<p style="font-size:80%">This chapter is taken from the book <a href="http://www.springer.com/gp/book/9783662498866">A Primer on Scientific Programming with Python</a> by H. P. Langtangen, 5th edition, Springer, 2016.</p>

<h1 id="sec:funcif:summary" class="anchor">Summary</h1>

<h2 id="___sec28" class="anchor">Chapter topics </h2>

<h3 id="___sec29" class="anchor">User-defined functions </h3>

<p>
Functions are useful (i) when a set of commands are to be executed
several times, or (ii) to partition the program into smaller pieces to
gain better overview.
Function arguments are local variables inside the function whose values
are set when calling the function. Remember that when you write the
function, the values of the arguments are not known.
Here is an example of a function for polynomials of 2nd degree:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># function definition:</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">quadratic_polynomial</span>(x, a, b, c)
    value <span style="color: #666666">=</span> a<span style="color: #666666">*</span>x<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b<span style="color: #666666">*</span>x <span style="color: #666666">+</span> c
    derivative <span style="color: #666666">=</span> <span style="color: #666666">2*</span>a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b
    <span style="color: #008000; font-weight: bold">return</span> value, derivative

<span style="color: #408080; font-style: italic"># function call:</span>
x <span style="color: #666666">=</span> <span style="color: #666666">1</span>
p, dp <span style="color: #666666">=</span> quadratic_polynomial(x, <span style="color: #666666">2</span>, <span style="color: #666666">0.5</span>, <span style="color: #666666">1</span>)
p, dp <span style="color: #666666">=</span> quadratic_polynomial(x<span style="color: #666666">=</span>x, a<span style="color: #666666">=-4</span>, b<span style="color: #666666">=0.5</span>, c<span style="color: #666666">=0</span>)
</pre></div>
<p>
The sequence of the arguments is important, unless all arguments
are given as <code>name=value</code>.

<p>
Functions may have no arguments and/or no return value(s):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">print_date</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Print the current date in the format &#39;Jan 07, 2007&#39;.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">time</span>
    <span style="color: #008000; font-weight: bold">print</span> time<span style="color: #666666">.</span>strftime(<span style="color: #BA2121">&quot;%b </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">, %Y&quot;</span>)

<span style="color: #408080; font-style: italic"># call:</span>
print_date()
</pre></div>
<p>
A common error is to forget the parentheses: <code>print_date</code>
is the function object itself, while <code>print_date()</code> is a call
to the function.

<h3 id="___sec30" class="anchor">Keyword arguments </h3>

<p>
Function arguments with default values are called keyword arguments,
and they
help to document the meaning of arguments in
function calls. They also make it possible to specify just a subset of
the arguments in function calls.

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> exp, sin, pi

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x, A<span style="color: #666666">=1</span>, a<span style="color: #666666">=1</span>, w<span style="color: #666666">=</span>pi):
    <span style="color: #008000; font-weight: bold">return</span> A<span style="color: #666666">*</span>exp(<span style="color: #666666">-</span>a<span style="color: #666666">*</span>x)<span style="color: #666666">*</span>sin(w<span style="color: #666666">*</span>x)

f1 <span style="color: #666666">=</span> f(<span style="color: #666666">0</span>)
x2 <span style="color: #666666">=</span> <span style="color: #666666">0.1</span>
f2 <span style="color: #666666">=</span> f(x2, w<span style="color: #666666">=2*</span>pi)
f3 <span style="color: #666666">=</span> f(x2, w<span style="color: #666666">=4*</span>pi, A<span style="color: #666666">=10</span>, a<span style="color: #666666">=0.1</span>)
f4 <span style="color: #666666">=</span> f(w<span style="color: #666666">=4*</span>pi, A<span style="color: #666666">=10</span>, a<span style="color: #666666">=0.1</span>, x<span style="color: #666666">=</span>x2)
</pre></div>
<p>
The sequence of the keyword arguments can be arbitrary, and the keyword
arguments that are not listed in the call get their default values according
to the function definition. The non-keyword arguments are called
positional arguments, which is <code>x</code> in this example. Positional arguments
must be listed before the keyword arguments. However,
also a positional
argument can appear as <code>name=value</code> in the call (see the last line
above), and this syntax allows any positional argument to be listed anywhere in
the call.

<h3 id="___sec31" class="anchor">If tests </h3>

<p>
The <code>if-elif-else</code> tests are used
to <em>branch</em> the flow of statements.
That is, different sets of statements are executed depending on whether
some conditions are <code>True</code> or <code>False</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
        value <span style="color: #666666">=</span> <span style="color: #666666">-1</span>
    <span style="color: #008000; font-weight: bold">elif</span> x <span style="color: #666666">&gt;=</span> <span style="color: #666666">0</span> <span style="color: #AA22FF; font-weight: bold">and</span> x <span style="color: #666666">&lt;=</span> <span style="color: #666666">1</span>:
        value <span style="color: #666666">=</span> x
    <span style="color: #008000; font-weight: bold">else</span>:
        value <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">return</span> value
</pre></div>

<h3 id="___sec32" class="anchor">Inline if tests </h3>

<p>
Assigning a variable one value if a condition is <code>True</code> and another
value if <code>False</code>, is compactly done with an inline <code>if</code> test:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>sign <span style="color: #666666">=</span> <span style="color: #666666">-1</span> <span style="color: #008000; font-weight: bold">if</span> a <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #666666">1</span>
</pre></div>

<h3 id="___sec33" class="anchor">Terminology </h3>

<p>
The important computer science terms in this document are

<ul>
  <li> function</li>
  <li> method</li>
  <li> return statement</li>
  <li> positional arguments</li>
  <li> keyword arguments</li>
  <li> local and global variables</li>
  <li> doc strings</li>
  <li> <code>if</code> tests with <code>if</code>, <code>elif</code>, and <code>else</code> (branching)</li>
  <li> the <code>None</code> object</li>
  <li> test functions (for verification)</li>
</ul>

<h2 id="sec:funcif:summary:ex" class="anchor">Example: Numerical integration</h2>

<h3 id="___sec35" class="anchor">Problem </h3>

<p>
An integral

$$
\begin{equation*}
\int_a^b f(x)dx
\end{equation*}
$$

can be approximated by the so-called Simpson's rule:

$$
\begin{equation}
{b-a\over 3n}\left(
f(a) + f(b) + 4\sum_{i=1}^{n/2} f(a + (2i-1)h) +
2\sum_{i=1}^{n/2-1} f(a+2ih)\right)\tp
\tag{6}
\end{equation}
$$

Here, \( h=(b-a)/n \) and \( n \) must be an even integer.  The problem is to
make a function <code>Simpson(f, a, b, n=500)</code> that returns the right-hand
side formula of <a href="#mjx-eqn-6">(6)</a>.  To verify the
implementation, one can make use of the fact that Simpson's rule is
<em>exact</em> for all polynomials \( f(x) \) of degree \( \leq 2 \).  Apply the
<code>Simpson</code> function to the integral \( \frac{3}{2}\int_0^\pi\sin^3x dx \),
which has exact value 2, and investigate how the approximation error
varies with \( n \).

<h3 id="___sec36" class="anchor">Solution </h3>

<p>
The evaluation of the formula <a href="#mjx-eqn-6">(6)</a> in a
program is straightforward if we know how to implement summation
(\( \sum \)) and how to call \( f \). A Python recipe for calculating sums is
given in the section <a href="._funcif-readable001.html#sec:basic:sum">Computing sums</a>. Basically, \( \sum_{i=M}^Nq(i) \),
for some expression \( q(i) \) involving \( i \), is coded with the aid of a
<code>for</code> loop over \( i \) and an accumulation variable <code>s</code> for building up
the sum, one term at a time:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>s <span style="color: #666666">=</span> <span style="color: #666666">0</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(M, N<span style="color: #666666">+1</span>):
    s <span style="color: #666666">+=</span> q(i)
</pre></div>
<p>
The <code>Simpson</code> function can then be coded as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Simpson</span>(f, a, b, n<span style="color: #666666">=500</span>):
    h <span style="color: #666666">=</span> (b <span style="color: #666666">-</span> a)<span style="color: #666666">/</span><span style="color: #008000">float</span>(n)
    sum1 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n<span style="color: #666666">/2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>):
        sum1 <span style="color: #666666">+=</span> f(a <span style="color: #666666">+</span> (<span style="color: #666666">2*</span>i<span style="color: #666666">-1</span>)<span style="color: #666666">*</span>h)

    sum2 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n<span style="color: #666666">/2</span>):
        sum2 <span style="color: #666666">+=</span> f(a <span style="color: #666666">+</span> <span style="color: #666666">2*</span>i<span style="color: #666666">*</span>h)

    integral <span style="color: #666666">=</span> (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>(<span style="color: #666666">3*</span>n)<span style="color: #666666">*</span>(f(a) <span style="color: #666666">+</span> f(b) <span style="color: #666666">+</span> <span style="color: #666666">4*</span>sum1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>sum2)
    <span style="color: #008000; font-weight: bold">return</span> integral
</pre></div>
<p>
Note that <code>Simpson</code> can integrate any Python function <code>f</code> of
one variable. Specifically, we can implement

$$
\begin{equation*} h(x) = \frac{3}{2}
\sin^3 xdx\end{equation*}
$$

in a Python function

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> (<span style="color: #666666">3./2</span>)<span style="color: #666666">*</span>sin(x)<span style="color: #666666">**3</span>
</pre></div>
<p>
and call <code>Simpson</code> to compute \( \int_0^\pi h(x)dx \) for various
choices of \( n \), as requested:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> sin, pi

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">application</span>():
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Integral of 1.5*sin^3 from 0 to pi:&#39;</span>
    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #666666">2</span>, <span style="color: #666666">6</span>, <span style="color: #666666">12</span>, <span style="color: #666666">100</span>, <span style="color: #666666">500</span>:
        approx <span style="color: #666666">=</span> Simpson(h, <span style="color: #666666">0</span>, pi, n)
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;n=</span><span style="color: #BB6688; font-weight: bold">%3d</span><span style="color: #BA2121">, approx=</span><span style="color: #BB6688; font-weight: bold">%18.15f</span><span style="color: #BA2121">, error=</span><span style="color: #BB6688; font-weight: bold">%9.2E</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> \ 
              (n, approx, <span style="color: #666666">2-</span>approx)
</pre></div>
<p>
(We have put the statements inside a function, here called <code>application</code>,
mainly to group them, and not because <code>application</code> will be called
several times or with different arguments.)

<h3 id="___sec37" class="anchor">Verification </h3>

<p>
Calling <code>application()</code> leads to the output

<p>

<!-- code=text (!bc ccq) typeset with pygments style "default" -->
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Integral of 1.5*sin^3 from 0 to pi:
n=  2, approx= 3.141592653589793, error=-1.14E+00
n=  6, approx= 1.989171700583579, error= 1.08E-02
n= 12, approx= 1.999489233010781, error= 5.11E-04
n=100, approx= 1.999999902476350, error= 9.75E-08
n=500, approx= 1.999999999844138, error= 1.56E-10
</pre></div>
</blockquote><p>
We clearly see that the approximation improves as \( n \) increases.
However, every computation will give an answer that deviates from the
exact value 2. We cannot from this test alone know if the errors above
are those implied by the approximation only, or if there are
additional programming mistakes.

<p>
A much better way of verifying the implementation is therefore to look for
test cases where the numerical approximation formula is <em>exact</em>, such
that we know exactly what the result of the function should be.  Since
it is stated that the formula is exact for polynomials up to second
degree, we just test the <code>Simpson</code> function
on an &quot;arbitrary&quot; parabola, say

$$
\begin{equation*} \int_{3/2}^2 \left(3x^2 - 7x + 2.5\right)dx \tp\end{equation*}
$$

This integral equals \( G(2)-G(3/2) \), where \( G(x)=x^3 - 3.5x^2 + 2.5x \).

<p>
A fundamental problem arises if we compare the computed integral value
with the exact result using <code>==</code>, because rounding errors may lead to
small differences and hence a false equality test. Consider the simple
problem

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">0.1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.2</span> <span style="color: #666666">==</span> <span style="color: #666666">0.3</span>
<span style="color: #008000">False</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">0.1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.2</span>
<span style="color: #666666">0.30000000000000004</span>
</pre></div>
<p>
We see that <code>0.1 + 0.2</code> leads to a small error in the 17th decimal place.
We must therefore make comparisons with <em>tolerances</em>:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">abs</span>(<span style="color: #666666">0.3</span> <span style="color: #666666">-</span> (<span style="color: #666666">0.1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.2</span>)) <span style="color: #666666">&lt;</span> tol
<span style="color: #008000">True</span>
</pre></div>
<p>
In this particular example,

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">abs</span>(<span style="color: #666666">0.3</span> <span style="color: #666666">-</span> (<span style="color: #666666">0.1</span> <span style="color: #666666">+</span> <span style="color: #666666">0.2</span>))
<span style="color: #666666">5.551115123125783e-17</span>
</pre></div>
<p>
so a tolerance of \( 10^{-16} \) would work, but in algorithms with many more
arithmetic operations, rounding errors may accumulate so \( 10^{-15} \) or
\( 10^{-14} \) are more appropriate tolerances.

<p>
The following implementation of a test function applies
a tolerance in the test for equality:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">3*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">-</span> <span style="color: #666666">7*</span>x <span style="color: #666666">+</span> <span style="color: #666666">2.5</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">G</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**3</span> <span style="color: #666666">-</span> <span style="color: #666666">3.5*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">2.5*</span>x

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Simpson</span>():
    a <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
    b <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>
    n <span style="color: #666666">=</span> <span style="color: #666666">8</span>
    expact <span style="color: #666666">=</span> G(b) <span style="color: #666666">-</span> G(a)
    approx <span style="color: #666666">=</span> Simpson(g, a, b, n)
    success <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> approx) <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> success:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Error: wrong integral of quadratic function&#39;</span>
</pre></div>
<p>
The <code>g</code> and <code>G</code> functions are only of interest inside the
<code>test_Simpson</code> function. Many think the code becomes easier to read
and understand if <code>g</code> and <code>G</code> are moved inside <code>test_Simpson</code>, which
is indeed possible in Python:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Simpson</span>():
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(x):
        <span style="color: #408080; font-style: italic"># test function for exact integration by Simpson&#39;s rule</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">3*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">-</span> <span style="color: #666666">7*</span>x <span style="color: #666666">+</span> <span style="color: #666666">2.5</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">G</span>(x):
        <span style="color: #408080; font-style: italic"># integral of g(x)</span>
        <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**3</span> <span style="color: #666666">-</span> <span style="color: #666666">3.5*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">2.5*</span>x

    a <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
    b <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>
    n <span style="color: #666666">=</span> <span style="color: #666666">8</span>
    exact <span style="color: #666666">=</span> G(b) <span style="color: #666666">-</span> G(a)
    approx <span style="color: #666666">=</span> Simpson(g, a, b, n)
    success <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> approx) <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> success:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Error: cannot integrate a quadratic function exactly&#39;</span>
</pre></div>
<p>
We shall make it a habit to write functions like <code>test_Simpson</code> for
verifying implementations.

<h3 id="___sec38" class="anchor">Unit tests and test functions </h3>

<p>
When testing software for correctness, it is considered good practice to
break the software into units and test the behavior of each
unit. This is called <em>unit testing</em>. In scientific computing,
one unit is often a numerical algorithm, like Simpson's method.
The testing of a unit is performed with a dedicated test function.

<p>
We may take the test function shown above one step further and adopt the
conventions in the <a href="http://pytest.org" target="_self">pytest</a> and
<a href="https://nose.readthedocs.org" target="_self">nose</a>
testing frameworks for Python code.
These conventions say that the test function should

<ul>
 <li> have a name starting with <code>test_</code>;</li>
 <li> have no arguments;</li>
 <li> let a boolean variable, say <code>success</code>, be <code>True</code> if a test
   passes and be <code>False</code> if the test fails;</li>
 <li> store a message about what failed in some string, say <code>msg</code>;</li>
 <li> use the construction <code>assert success, msg</code>, which will
   abort the program and write out <code>msg</code> if <code>success</code> is <code>False</code>.</li>
</ul>

The pytest and nose test frameworks can search for all Python files in a folder
tree, run all <code>test_*()</code> functions, and report how many of the
tests that failed, if we adopt the conventions above.
Our pytest/nose-compatible test function then looks as follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Simpson</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Test exact integration of quadratic polynomials.&quot;&quot;&quot;</span>
    a <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
    b <span style="color: #666666">=</span> <span style="color: #666666">2.0</span>
    n <span style="color: #666666">=</span> <span style="color: #666666">8</span>
    g <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">3*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">-</span> <span style="color: #666666">7*</span>x <span style="color: #666666">+</span> <span style="color: #666666">2.5</span>       <span style="color: #408080; font-style: italic"># test integrand</span>
    G <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: x<span style="color: #666666">**3</span> <span style="color: #666666">-</span> <span style="color: #666666">3.5*</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">2.5*</span>x  <span style="color: #408080; font-style: italic"># integral of g</span>
    exact <span style="color: #666666">=</span> G(b) <span style="color: #666666">-</span> G(a)
    approx <span style="color: #666666">=</span> Simpson(g, a, b, n)
    success <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(exact <span style="color: #666666">-</span> approx) <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-14</span>
    msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;Simpson: </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, exact: </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (approx, exact)
    <span style="color: #008000; font-weight: bold">assert</span> success, msg
</pre></div>
<p>
Here we have also made the test function more compact by utilizing
lambda functions for <code>g</code> and <code>G</code> (see the section <a href="._funcif-readable001.html#sec:basic:lambdafunc">Lambda functions</a>).

<h3 id="___sec39" class="anchor">Checking the validity of function arguments </h3>

<p>
Another improvement is to increase the robustness of the function.
That is, to check that the input data, i.e., the arguments, are
acceptable. Here we may test if \( b>a \) and if \( n \) is an even
integer. For the latter test, we make use of the <em>mod</em> function:
mod(\( n \), \( d \)) gives the remainder when \( n \) is divided by \( d \) (both \( n \)
and \( d \) are integers).  Mathematically, if \( p \) is the largest integer
such that \( pd\leq n \), then mod(\( n \), \( d \)) is \( n-pd \).  For example,
mod(3, 2) is 1, mod(3, 1) is 0, mod (3, 3) is 0, and mod(18, 8) is
2. The point is that \( n \) divided by \( d \) is an integer when mod(\( n \),
\( d \)) is zero. In Python, the percentage sign is used for the mod
function:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #666666">18</span> <span style="color: #666666">%</span> <span style="color: #666666">8</span>
<span style="color: #666666">2</span>
</pre></div>
<p>
To test if <code>n</code> is an odd integer, we see if it can be divided
by 2 and yield an integer without any reminder: <code>n % 2 == 0</code>.

<p>
The improved <code>Simpson</code> function with validity tests on the provided
arguments, as well as a doc string (the section <a href="._funcif-readable001.html#sec:basic:docstring">Doc strings</a>),
can look like this:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Simpson</span>(f, a, b, n<span style="color: #666666">=500</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Return the approximation of the integral of f</span>
<span style="color: #BA2121; font-style: italic">    from a to b using Simpson&#39;s rule with n intervals.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">if</span> a <span style="color: #666666">&gt;</span> b:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Error: a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121"> &gt; b=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (a, b)
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">None</span>

    <span style="color: #408080; font-style: italic"># check that n is even:</span>
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #666666">%</span> <span style="color: #666666">2</span> <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Error: n=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> is not an even integer!&#39;</span> <span style="color: #666666">%</span> n
        n <span style="color: #666666">=</span> n<span style="color: #666666">+1</span>  <span style="color: #408080; font-style: italic"># make n even</span>

    h <span style="color: #666666">=</span> (b <span style="color: #666666">-</span> a)<span style="color: #666666">/</span><span style="color: #008000">float</span>(n)
    sum1 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n<span style="color: #666666">/2</span> <span style="color: #666666">+</span> <span style="color: #666666">1</span>):
        sum1 <span style="color: #666666">+=</span> f(a <span style="color: #666666">+</span> (<span style="color: #666666">2*</span>i<span style="color: #666666">-1</span>)<span style="color: #666666">*</span>h)

    sum2 <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n<span style="color: #666666">/2</span>):
        sum2 <span style="color: #666666">+=</span> f(a <span style="color: #666666">+</span> <span style="color: #666666">2*</span>i<span style="color: #666666">*</span>h)

    integral <span style="color: #666666">=</span> (b<span style="color: #666666">-</span>a)<span style="color: #666666">/</span>(<span style="color: #666666">3*</span>n)<span style="color: #666666">*</span>(f(a) <span style="color: #666666">+</span> f(b) <span style="color: #666666">+</span> <span style="color: #666666">4*</span>sum1 <span style="color: #666666">+</span> <span style="color: #666666">2*</span>sum2)
    <span style="color: #008000; font-weight: bold">return</span> integral
</pre></div>
<p>
The complete code is found in the file
<a href="http://tinyurl.com/pwyasaa/funcif/Simpson.py" target="_self"><tt>Simpson.py</tt></a>.

<p>
A very good exercise is to simulate the program flow by hand, starting
with the call to the <code>application</code> function.  The <a href="http://www.pythontutor.com/" target="_self">Online
Python Tutor</a> or a debugger (see
the
document <a href="http://hplgit.github.io/primer.html/doc/pub/debug" target="_self">Debugging in Python</a>
<a href="._funcif-readable004.html#Langtangen_TCSE6_debug">[1]</a>) are convenient tools for
controlling that your thinking is correct.

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._funcif-readable002.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._funcif-readable004.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

