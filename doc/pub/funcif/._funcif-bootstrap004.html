<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Functions and branching">
<meta name="keywords" content="function header,function body,body of a function,call a function,invoke a function,Online Python Tutor,keyword arguments,function arguments keyword,positional arguments,function arguments positional,named arguments,function arguments named,doc strings,main program,lambda functions,lambda functions,test function,unit testing,nose tests,pytest tests,mod function,Online Python Tutor,Trapezoidal rule for integration,Midpoint rule for integration,Fourier series,Heaviside function,sort (list)">

<title>Functions and branching</title>

<!-- Bootstrap style: bootstrap_simula -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_simula.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px; /* fixed header height*/
  margin:-50px 0 0; /* negative fixed header height */
}

body { font-size:20px;line-height:1.5; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Functions', 1, None, '___sec0'),
              ('Mathematical functions as Python functions',
               2,
               'sec:basic:func1',
               'sec:basic:func1'),
              ('Understanding the program flow',
               2,
               'sec:basic:pot',
               'sec:basic:pot'),
              ('Local and global variables',
               2,
               'sec:basic:localglobal',
               'sec:basic:localglobal'),
              ('Local variables are invisible outside functions',
               3,
               None,
               '___sec4'),
              ('Local variables hide global variables', 3, None, '___sec5'),
              ('Example', 3, None, '___sec6'),
              ('Changing global variables inside functions',
               3,
               None,
               '___sec7'),
              ('Multiple arguments',
               2,
               'sec:basic:multiple:args',
               'sec:basic:multiple:args'),
              ('Function argument or global variable?',
               2,
               'sec:basic:arg:or:global',
               'sec:basic:arg:or:global'),
              ('Beyond mathematical functions',
               2,
               'sec:basic:makelist',
               'sec:basic:makelist'),
              ('Remark 1', 3, None, '___sec11'),
              ('Remark 2', 3, None, '___sec12'),
              ('Multiple return values',
               2,
               'sec:basic:multiple:returns',
               'sec:basic:multiple:returns'),
              ('Computing sums', 2, 'sec:basic:sum', 'sec:basic:sum'),
              ('Functions with no return values',
               2,
               'sec:basic:None',
               'sec:basic:None'),
              ('Keyword arguments',
               2,
               'sec:basic:kwargs',
               'sec:basic:kwargs'),
              ('Example: Function with default parameters',
               3,
               None,
               '___sec17'),
              ('Example: Computing a sum with default tolerance',
               3,
               None,
               '___sec18'),
              ('Doc strings',
               2,
               'sec:basic:docstring',
               'sec:basic:docstring'),
              ('Functions as arguments to functions',
               2,
               'sec:basic:farg',
               'sec:basic:farg'),
              ('The behavior of the numerical derivative as $h\\rightarrow 0$',
               3,
               None,
               '___sec21'),
              ('The main program', 2, None, '___sec22'),
              ('Lambda functions',
               2,
               'sec:basic:lambdafunc',
               'sec:basic:lambdafunc'),
              ('Branching', 1, 'sec:input:if', 'sec:input:if'),
              ('If-else blocks', 2, None, '___sec25'),
              ('Inline if tests', 2, None, '___sec26'),
              ('Summary', 1, 'sec:funcif:summary', 'sec:funcif:summary'),
              ('Chapter topics', 2, None, '___sec28'),
              ('User-defined functions', 3, None, '___sec29'),
              ('Keyword arguments', 3, None, '___sec30'),
              ('If tests', 3, None, '___sec31'),
              ('Inline if tests', 3, None, '___sec32'),
              ('Terminology', 3, None, '___sec33'),
              ('Example: Numerical integration',
               2,
               'sec:funcif:summary:ex',
               'sec:funcif:summary:ex'),
              ('Problem', 3, None, '___sec35'),
              ('Solution', 3, None, '___sec36'),
              ('Verification', 3, None, '___sec37'),
              ('Unit tests and test functions', 3, None, '___sec38'),
              ('Checking the validity of function arguments',
               3,
               None,
               '___sec39'),
              ('Exercises', 1, None, '___sec40'),
              ('Exercise 1: Implement a simple mathematical function',
               2,
               'sec:basic:ex:exp',
               'sec:basic:ex:exp'),
              ('Exercise 2: Implement a simple mathematical function with a parameter',
               2,
               'sec:basic:ex:exp2',
               'sec:basic:ex:exp2'),
              ('Exercise 3: Explain how a program works',
               2,
               'sec:basic:ex48',
               'sec:basic:ex48'),
              ('Exercise 4: Write a Fahrenheit-Celsius conversion functions',
               2,
               'sec:basic:ex26b',
               'sec:basic:ex26b'),
              ('Exercise 5: Write a test function for Exercise ref{sec:basic:ex26b}',
               2,
               'sec:basic:ex26b2',
               'sec:basic:ex26b2'),
              ('Exercise 6: Given a test function, write the function',
               2,
               'sec:basic:ex:testfunc1',
               'sec:basic:ex:testfunc1'),
              ('Exercise 7: Evaluate a sum and write a test function',
               2,
               'sec:basic:ex29d',
               'sec:basic:ex29d'),
              ('Exercise 8: Write a function for solving $ax^2 + bx + c =0$',
               2,
               'sec:funcif:ex1',
               'sec:funcif:ex1'),
              ('Exercise 9: Implement the sum function',
               2,
               'sec:input:ex1',
               'sec:input:ex1'),
              ('Exercise 10: Compute a polynomial via a product',
               2,
               'sec:basic:ex32',
               'sec:basic:ex32'),
              ('Exercise 11: Integrate a function by the Trapezoidal rule',
               2,
               'sec:basic:ex38',
               'sec:basic:ex38'),
              ('Remarks', 3, None, '___sec52'),
              ('Exercise 12: Derive the general Midpoint integration rule',
               2,
               'sec:basic:ex39c',
               'sec:basic:ex39c'),
              ('Exercise 13: Make an adaptive Trapezoidal rule',
               2,
               'sec:basic:ex39d',
               'sec:basic:ex39d'),
              ('Remarks', 3, None, '___sec55'),
              ('Exercise 14: Simulate a program by hand',
               2,
               'sec:basic:ex:locglob',
               'sec:basic:ex:locglob'),
              ('Exercise 15: Debug a given test function',
               2,
               'sec:basic:ex:testfunc2',
               'sec:basic:ex:testfunc2'),
              ('Exercise 16: Compute the area of an arbitrary triangle',
               2,
               'sec:basic:ex25',
               'sec:basic:ex25'),
              ('Exercise 17: Compute the length of a path',
               2,
               'sec:basic:ex25b',
               'sec:basic:ex25b'),
              ('Exercise 18: Approximate $\\pi$',
               2,
               'sec:basic:ex25c',
               'sec:basic:ex25c'),
              ('Exercise 19: Compute the area of a polygon',
               2,
               'sec:funcif:exer:area:polygon',
               'sec:funcif:exer:area:polygon'),
              ('Exercise 20: Write functions',
               2,
               'sec:basic:ex42a',
               'sec:basic:ex42a'),
              ('Exercise 21: Approximate a function by a sum of sines',
               2,
               'sec:formula:ex10',
               'sec:formula:ex10'),
              ('Remarks', 3, None, '___sec64'),
              ('Exercise 22: Implement a Gaussian function',
               2,
               'sec:basic:ex33',
               'sec:basic:ex33'),
              ('Exercise 23: Wrap a formula in a function',
               2,
               'sec:basic:ex46',
               'sec:basic:ex46'),
              ('Exercise 24: Write a function for numerical differentiation',
               2,
               'sec:basic:ex38a',
               'sec:basic:ex38a'),
              ('Exercise 25: Implement the factorial function',
               2,
               'sec:basic:ex35',
               'sec:basic:ex35'),
              ('Exercise 26: Compute velocity and acceleration from 1D position data',
               2,
               'sec:basic:ex29q',
               'sec:basic:ex29q'),
              ('Exercise 27: Find the max and min values of a function',
               2,
               'sec:basic:ex29g',
               'sec:basic:ex29g'),
              ('Exercise 28: Find the max and min elements in a list',
               2,
               'sec:basic:ex29g2',
               'sec:basic:ex29g2'),
              ('Exercise 29: Implement the Heaviside function',
               2,
               'sec:basic:exH1',
               'sec:basic:exH1'),
              ('Exercise 30: Implement a smoothed Heaviside function',
               2,
               'sec:basic:exH2',
               'sec:basic:exH2'),
              ('Exercise 31: Implement an indicator function',
               2,
               'sec:basic:exH3',
               'sec:basic:exH3'),
              ('Exercise 32: Implement a piecewise constant function',
               2,
               'sec:basic:exH4',
               'sec:basic:exH4'),
              ('Exercise 33: Apply indicator functions',
               2,
               'sec:basic:exH4b',
               'sec:basic:exH4b'),
              ('Exercise 34: Test your understanding of branching',
               2,
               'sec:basic:ex49',
               'sec:basic:ex49'),
              ('Exercise 35: Simulate nested loops by hand',
               2,
               'sec:basic:ex40',
               'sec:basic:ex40'),
              ('Exercise 36: Rewrite a mathematical function',
               2,
               'sec:basic:ex29f',
               'sec:basic:ex29f'),
              ('Exercise 37: Make a table for approximations of $\\cos x$',
               2,
               'sec:basic:ex29e',
               'sec:basic:ex29e'),
              ('Exercise 38: Use None in keyword arguments',
               2,
               'sec:basic:ex31b',
               'sec:basic:ex31b'),
              ('Exercise 39: Write a sort function for a list of 4-tuples',
               2,
               'sec:basic:ex28',
               'sec:basic:ex28'),
              ('Exercise 40: Find prime numbers',
               2,
               'sec:basic:ex37',
               'sec:basic:ex37'),
              ('Exercise 41: Resolve a problem with a function',
               2,
               'sec:input:ex35',
               'sec:input:ex35'),
              ('Exercise 42: Determine the types of some objects',
               2,
               'sec:basic:ex20',
               'sec:basic:ex20'),
              ('Remarks', 3, None, '___sec86'),
              ('Exercise 43: Find an error in a program',
               2,
               'sec:basic:ex34',
               'sec:basic:ex34'),
              ('References', 1, None, '___sec88')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<!-- newcommands_keep.tex -->
$$
\newcommand{\tp}{\thinspace .}
$$




    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="funcif-bootstrap.html">Functions and branching</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap000.html#table_of_contents" style="font-size: 80%;"><b>Table of contents</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec0" style="font-size: 80%;"><b>Functions</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:func1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Mathematical functions as Python functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:pot" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Understanding the program flow</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:localglobal" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Local and global variables</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local variables are invisible outside functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Local variables hide global variables</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Changing global variables inside functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:multiple:args" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Multiple arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:arg:or:global" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Function argument or global variable?</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:makelist" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Beyond mathematical functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec11" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark 1</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remark 2</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:multiple:returns" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Multiple return values</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:sum" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Computing sums</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:None" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions with no return values</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:kwargs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Function with default parameters</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example: Computing a sum with default tolerance</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:docstring" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Doc strings</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:farg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Functions as arguments to functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec21" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The behavior of the numerical derivative as \( h\rightarrow 0 \)</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#___sec22" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;The main program</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap001.html#sec:basic:lambdafunc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Lambda functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap002.html#sec:input:if" style="font-size: 80%;"><b>Branching</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap002.html#___sec25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;If-else blocks</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap002.html#___sec26" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Inline if tests</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#sec:funcif:summary" style="font-size: 80%;"><b>Summary</b></a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Chapter topics</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec29" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;User-defined functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec30" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec31" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If tests</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Inline if tests</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Terminology</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#sec:funcif:summary:ex" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Example: Numerical integration</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec36" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Solution</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verification</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unit tests and test functions</a></li>
     <!-- navigation toc: --> <li><a href="._funcif-bootstrap003.html#___sec39" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checking the validity of function arguments</a></li>
     <!-- navigation toc: --> <li><a href="#___sec40" style="font-size: 80%;"><b>Exercises</b></a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex:exp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 1: Implement a simple mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex:exp2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 2: Implement a simple mathematical function with a parameter</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex48" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 3: Explain how a program works</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex26b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 4: Write a Fahrenheit-Celsius conversion functions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex26b2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 5: Write a test function for Exercise ref{sec:basic:ex26b}</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex:testfunc1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 6: Given a test function, write the function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 7: Evaluate a sum and write a test function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:funcif:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 8: Write a function for solving \( ax^2 + bx + c =0 \)</a></li>
     <!-- navigation toc: --> <li><a href="#sec:input:ex1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 9: Implement the sum function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex32" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 10: Compute a polynomial via a product</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex38" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 11: Integrate a function by the Trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="#___sec52" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex39c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 12: Derive the general Midpoint integration rule</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex39d" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 13: Make an adaptive Trapezoidal rule</a></li>
     <!-- navigation toc: --> <li><a href="#___sec55" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex:locglob" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 14: Simulate a program by hand</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex:testfunc2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 15: Debug a given test function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex25" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 16: Compute the area of an arbitrary triangle</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex25b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 17: Compute the length of a path</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex25c" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 18: Approximate \( \pi \)</a></li>
     <!-- navigation toc: --> <li><a href="#sec:funcif:exer:area:polygon" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 19: Compute the area of a polygon</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex42a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 20: Write functions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:formula:ex10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 21: Approximate a function by a sum of sines</a></li>
     <!-- navigation toc: --> <li><a href="#___sec64" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex33" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 22: Implement a Gaussian function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex46" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 23: Wrap a formula in a function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex38a" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 24: Write a function for numerical differentiation</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 25: Implement the factorial function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29q" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 26: Compute velocity and acceleration from 1D position data</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29g" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 27: Find the max and min values of a function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29g2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 28: Find the max and min elements in a list</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:exH1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 29: Implement the Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:exH2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 30: Implement a smoothed Heaviside function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:exH3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 31: Implement an indicator function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:exH4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 32: Implement a piecewise constant function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:exH4b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 33: Apply indicator functions</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex49" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 34: Test your understanding of branching</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex40" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 35: Simulate nested loops by hand</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29f" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 36: Rewrite a mathematical function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex29e" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 37: Make a table for approximations of \( \cos x \)</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex31b" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 38: Use None in keyword arguments</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex28" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 39: Write a sort function for a list of 4-tuples</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex37" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 40: Find prime numbers</a></li>
     <!-- navigation toc: --> <li><a href="#sec:input:ex35" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 41: Resolve a problem with a function</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex20" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 42: Determine the types of some objects</a></li>
     <!-- navigation toc: --> <li><a href="#___sec86" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Remarks</a></li>
     <!-- navigation toc: --> <li><a href="#sec:basic:ex34" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Exercise 43: Find an error in a program</a></li>
     <!-- navigation toc: --> <li><a href="#___sec88" style="font-size: 80%;"><b>References</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0004"></a>
<!-- !split -->
<p style="font-size:80%">This chapter is taken from the book <a href="http://www.springer.com/gp/book/9783662498866">A Primer on Scientific Programming with Python</a> by H. P. Langtangen, 5th edition, Springer, 2016.</p>

<h1 id="___sec40" class="anchor">Exercises </h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex:exp" class="anchor">Exercise 1: Implement a simple mathematical function</h2>

<p>
Implement the mathematical function

$$ g(t) = e^{-t}\sin(\pi t),$$

in a Python function <code>g(t)</code>. Print out \( g(0) \) and \( g(1) \).
Filename: <code>expsin</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex:exp2" class="anchor">Exercise 2: Implement a simple mathematical function with a parameter</h2>

<p>
Let us extend the function \( g(t) \) in <a href="#sec:basic:ex:exp">Exercise 1: Implement a simple mathematical function</a> to

$$ h(t) = e^{-at}\sin(\pi t),$$

where \( a \) is a parameter. How can the corresponding Python function
be implemented in this case?
Print out \( h(0) \) and \( h(1) \) for the case \( a=10 \).
Filename: <code>expsin_a</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex48" class="anchor">Exercise 3: Explain how a program works</h2>

<p>
Explain how the following program works:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add</span>(A, B):
    C <span style="color: #666666">=</span> A <span style="color: #666666">+</span> B
    <span style="color: #008000; font-weight: bold">return</span> C

a <span style="color: #666666">=</span> <span style="color: #666666">3</span>
b <span style="color: #666666">=</span> <span style="color: #666666">2</span>
<span style="color: #008000; font-weight: bold">print</span> add(a, b)
<span style="color: #008000; font-weight: bold">print</span> add(<span style="color: #666666">2*</span>a, b<span style="color: #666666">+1</span>)<span style="color: #666666">*3</span>
</pre></div>
<p>
Figure out what is being printed <em>without</em> running the program.
Filename: <code>explain_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex26b" class="anchor">Exercise 4: Write a Fahrenheit-Celsius conversion functions</h2>

<p>
The formula for converting Fahrenheit degrees to Celsius reads

$$
\begin{equation} C = \frac{5}{9}(F - 32)\tp
\tag{7}
\end{equation}
$$

Write a function <code>C(F)</code> that implements this formula.
Also write the inverse function <code>F(C)</code> for going from Celsius to
Fahrenheit degrees.
How can you test that the two functions work?

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_4_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_4_1">

<p>
<code>C(F(c))</code> should result in <code>c</code> and
<code>F(C(f))</code> should result in <code>f</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>f2c</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec45" class="anchor">Exercise 5: Write a test function for <a href="#sec:basic:ex26b">Exercise 4: Write a Fahrenheit-Celsius conversion functions</a> </h2>
<div id="sec:basic:ex26b2"></div>

<p>
Write a test function <code>test_F_C</code> that checks the computation of
<code>C(F(c))</code> and <code>F(C(f))</code>, involving the
<code>C(F)</code> and <code>F(C)</code> functions in <a href="#sec:basic:ex26b">Exercise 4: Write a Fahrenheit-Celsius conversion functions</a>.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_5_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_5_1">

<p>
Use a tolerance in the comparison. Let the test function follow the
conventions in the nose and pytest frameworks (see
the section ref{bioinf:count:verify} for a first intro
and the section ref{sec:nose} for more overview).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>test_f2c</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex:testfunc1" class="anchor">Exercise 6: Given a test function, write the function</h2>

<p>
Here is a test function:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_double</span>():
    <span style="color: #008000; font-weight: bold">assert</span> double(<span style="color: #666666">2</span>) <span style="color: #666666">==</span> <span style="color: #666666">4</span>
    <span style="color: #008000; font-weight: bold">assert</span> <span style="color: #008000">abs</span>(double(<span style="color: #666666">0.1</span>) <span style="color: #666666">-</span> <span style="color: #666666">0.2</span>) <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-15</span>
    <span style="color: #008000; font-weight: bold">assert</span> double([<span style="color: #666666">1</span>, <span style="color: #666666">2</span>]) <span style="color: #666666">==</span> [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>]
    <span style="color: #008000; font-weight: bold">assert</span> double((<span style="color: #666666">1</span>, <span style="color: #666666">2</span>)) <span style="color: #666666">==</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>)
    <span style="color: #008000; font-weight: bold">assert</span> double(<span style="color: #666666">3+4j</span>) <span style="color: #666666">==</span> <span style="color: #666666">6+8j</span>
    <span style="color: #008000; font-weight: bold">assert</span> double(<span style="color: #BA2121">&#39;hello&#39;</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;hellohello&#39;</span>
</pre></div>
<p>
Write the associated function to be tested (<code>double</code>) and run <code>test_double</code>.
Filename: <code>test_double</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29d" class="anchor">Exercise 7: Evaluate a sum and write a test function</h2>

<p>
<b>a)</b>
Write a Python function <code>sum_1k(M)</code> that returns the sum
\( s = \sum_{k=1}^M {1\over k} \).

<p>
<b>b)</b>
Compute \( s \) for the case \( M=3 \) by hand and write another function
<code>test_sum_1k()</code> that calls <code>sum_1k(3)</code> and checks that the
answer is correct.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_7_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_7_1">

<p>
We recommend that <code>test_sum_1k</code> follows the conventions of the pytest and nose
testing
frameworks.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
Filename: <code>sum_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:funcif:ex1" class="anchor">Exercise 8: Write a function for solving \( ax^2 + bx + c =0 \)</h2>

<p>
<b>a)</b>
Given a quadratic equation \( ax^2 + bx + c =0 \), write a function
<code>roots(a, b, c)</code> that returns the two roots of the equation.
The returned roots should be float-type objects when the roots are real,
otherwise complex-type objects.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_8_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_8_1">

<p>
You can test on the sign of the expression in the square root
and return standard <code>float</code> or <code>complex</code> Python objects accordingly.
Alternatively,
you can simply use <code>sqrt</code> from the <code>numpy.lib.scimath</code>
library.
This <code>sqrt</code> function returns an object of type <code>numpy.complex128</code> in case of
a negative argument (and hence a complex square root)
and an object of type <code>numpy.float64</code> otherwise.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>b)</b>
Construct two test cases with known solutions, one with real roots and
the other with complex roots. Implement the two test cases in two
test functions <code>test_roots_float</code> and <code>test_roots_complex</code>, where you
call the <code>roots</code> function and check the value of the
returned objects.

<p>
Filename: <code>roots_quadratic</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:input:ex1" class="anchor">Exercise 9: Implement the sum function</h2>

<p>
The standard Python function called <code>sum</code> takes a list as argument
and computes the sum of the elements in the list:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">sum</span>([<span style="color: #666666">1</span>,<span style="color: #666666">3</span>,<span style="color: #666666">5</span>,<span style="color: #666666">-5</span>])
<span style="color: #666666">4</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">sum</span>([[<span style="color: #666666">1</span>,<span style="color: #666666">2</span>], [<span style="color: #666666">4</span>,<span style="color: #666666">3</span>], [<span style="color: #666666">8</span>,<span style="color: #666666">1</span>]])
[<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">4</span>, <span style="color: #666666">3</span>, <span style="color: #666666">8</span>, <span style="color: #666666">1</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">sum</span>([<span style="color: #BA2121">&#39;Hello, &#39;</span>, <span style="color: #BA2121">&#39;World!&#39;</span>])
<span style="color: #BA2121">&#39;Hello, World!&#39;</span>
</pre></div>
<p>
Implement your own version of <code>sum</code>.
Filename: <code>mysum</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex32" class="anchor">Exercise 10: Compute a polynomial via a product</h2>

<p>
Given \( n+1 \) roots \( r_0,r_1,\ldots,r_{n} \) of a polynomial \( p(x) \) of degree
\( n+1 \), \( p(x) \) can be computed by

$$
\begin{equation}
p(x) = \prod_{i=0}^{n}(x-r_i) = (x-r_0)(x-r_1)\cdots (x-r_{n-1})(x-r_{n})
\tag{8}
\tp
\end{equation}
$$

Write a function <code>poly(x, roots)</code> that takes \( x \) and a list <code>roots</code>
of the roots as arguments and returns \( p(x) \).
Construct a test case for verifying the implementation.
Filename: <code>polyprod</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex38" class="anchor">Exercise 11: Integrate a function by the Trapezoidal rule</h2>

<p>
<b>a)</b>
An approximation to the integral of a function \( f(x) \) over an interval
\( [a,b] \) can be found by first approximating \( f(x) \) by the straight line
that goes through the end points \( (a,f(a)) \) and \( (b,f(b)) \), and then
finding the area under the straight line, which is the area of a
trapezoid.  The resulting formula becomes

$$
\begin{equation} \int_a^b f(x)dx \approx {b-a\over 2}(f(a) + f(b))\tp
\tag{9}
\end{equation}
$$

Write a function <code>trapezint1(f, a, b)</code> that returns this approximation
to the integral. The argument <code>f</code> is a Python implementation <code>f(x)</code> of
the mathematical function \( f(x) \).

<p>
<b>b)</b>
Use the approximation <a href="#mjx-eqn-9">(9)</a> to
compute the following integrals:
\( \int_0^\pi \cos x\, dx \),
\( \int_0^\pi \sin x\, dx \), and \( \int_0^{\pi/2} \sin x\, dx \),
In each case, write out the error, i.e., the difference between
the exact integral and the approximation <a href="#mjx-eqn-9">(9)</a>.
Make rough sketches of the trapezoid for each integral
in order to understand how the method behaves in the different cases.

<p>
<b>c)</b>
We can easily improve the formula <a href="#mjx-eqn-9">(9)</a> by
approximating the area under the function \( f(x) \) by two equal-sized
trapezoids.  Derive a formula for this approximation and implement it
in a function <code>trapezint2(f, a, b)</code>.  Run the examples from b)
and see how much better the new formula is. Make sketches of the two
trapezoids in each case.

<p>
<b>d)</b>
A further improvement of the approximate integration method from
c) is to divide the area under the
\( f(x) \) curve into \( n \) equal-sized trapezoids. Based on this idea,
derive the following formula for approximating the integral:

$$
\begin{equation}
\int_a^b f(x) dx \approx \sum_{i=1}^{n-1} \frac{1}{2}h\left(f(x_{i})+f(x_{i+1})
\right),
\tag{10}
\end{equation}
$$

where \( h \) is the width of the trapezoids, \( h = (b-a)/n \), and \( x_i=a +
ih \), \( i=0,\ldots,n \), are the coordinates of the sides of the
trapezoids.  The figure below visualizes the idea of the Trapezoidal
rule.

<p>
<br /><br /><center><p><img src="fig-funcif/viz_trapez.png" align="bottom" width=500></p></center><br /><br />

<p>
Implement <a href="#mjx-eqn-10">(10)</a> in a Python function
<code>trapezint(f, a, b, n)</code>. Run the examples from b) with \( n=10 \).

<p>
<b>e)</b>
Write a test function <code>test_trapezint()</code> for verifying the
implementation of the function <code>trapezint</code> in d).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_11_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_11_1">

<p>
Obviously, the Trapezoidal method integrates linear functions exactly
for any \( n \). Another more surprising result is that the method is also
exact for, e.g., \( \int_0^{2\pi} \cos x\, dx \) for any \( n \).
Use one of these cases for the test function <code>test_trapezint</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
Filename: <code>trapezint</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec52" class="anchor">Remarks </h3>

<p>
Formula <a href="#mjx-eqn-10">(10)</a> is not the most common way of
expressing the Trapezoidal integration rule.  The reason is that
\( f(x_{i+1}) \) is evaluated twice, first in term \( i \) and then as
\( f(x_{i}) \) in term \( i+1 \). The formula can be further developed to
avoid unnecessary evaluations of \( f(x_{i+1}) \), which results in the
standard form

$$
\begin{equation}
\int_a^b f(x)dx\approx \frac{1}{2}h(f(a)+ f(b)) + h\sum_{i=1}^{n-1}
f(x_i)\tp
\tag{11}
\end{equation}
$$

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex39c" class="anchor">Exercise 12: Derive the general Midpoint integration rule</h2>

<p>
The idea of the Midpoint rule for integration is to divide the area
under the curve \( f(x) \) into \( n \) equal-sized rectangles (instead of
trapezoids as in <a href="#sec:basic:ex38">Exercise 11: Integrate a function by the Trapezoidal rule</a>).
The height of the rectangle is determined by the value of \( f \) at
the midpoint of the rectangle.
The figure below illustrates the idea.

<p>
<br /><br /><center><p><img src="fig-funcif/viz_midpoint.png" align="bottom" width=500></p></center><br /><br />

<p>
Compute the area of each rectangle, sum them up, and arrive at the
formula for the Midpoint rule:

$$
\begin{equation}
\int_a^b f(x)dx \approx h\sum_{i=0}^{n-1} f(a + ih + \frac{1}{2}h),
\tag{12}
\end{equation}
$$

where \( h=(b-a)/n \) is the width of each rectangle. Implement this formula
in a Python function <code>midpointint(f, a, b, n)</code> and test
the function on the examples listed in <a href="#sec:basic:ex38">Exercise 11: Integrate a function by the Trapezoidal rule</a>b.
How do the errors in the Midpoint rule compare with those of
the Trapezoidal rule for \( n=1 \) and \( n=10 \)?
Filename: <code>midpointint</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex39d" class="anchor">Exercise 13: Make an adaptive Trapezoidal rule</h2>

<p>
A problem with the Trapezoidal integration rule
<a href="#mjx-eqn-10">(10)</a> in <a href="#sec:basic:ex38">Exercise 11: Integrate a function by the Trapezoidal rule</a> is to
decide how many trapezoids (\( n \)) to use in order to achieve a desired
accuracy. Let \( E \) be the error in the Trapezoidal method, i.e., the
difference between the exact integral and that produced by
<a href="#mjx-eqn-10">(10)</a>. We would like to prescribe a (small)
tolerance \( \epsilon \) and find an \( n \) such that \( E\leq\epsilon \).

<p>
Since the exact value \( \int_a^bf(x)dx \) is not available (that is why
we use a numerical method!), it is challenging to compute \( E \).
Nevertheless, it has been shown by mathematicians that

$$
\begin{equation}
E \leq \frac{1}{12}(b-a)h^2\max_{x\in [a,b]}\left\vert f''(x)\right\vert\tp
\tag{13}
\end{equation}
$$

The maximum of \( |f''(x)| \) can be computed (approximately) by evaluating
\( f''(x) \) at a large number of points in \( [a,b] \), taking the
absolute value \( |f''(x)| \), and finding the maximum value of these.
The double derivative can be computed by a finite difference formula:

$$ f''(x)\approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\tp$$

<!-- You can use the <code>diff2nd</code> function from the section <a href="._funcif-bootstrap001.html#sec:basic:farg">Functions as arguments to functions</a> -->
<!-- to compute \( f''(x) \). -->

<p>
With the computed estimate of \( \max |f''(x)| \) we can find \( h \) from
setting the right-hand side in <a href="#mjx-eqn-13">(13)</a> equal
to the desired tolerance:

$$
\begin{equation*} \frac{1}{12}(b-a)h^2\max_{x\in [a,b]}\left\vert f''(x)\right\vert
= \epsilon\tp
\end{equation*}
$$

Solving with respect to \( h \) gives

$$
\begin{equation}
h =  \sqrt{12\epsilon}\left(
(b-a)\max_{x\in [a,b]}\left\vert f''(x)\right\vert\right)^{-1/2}\tp
\tag{14}
\end{equation}
$$

With \( n=(b-a)/h \) we have the \( n \) that corresponds to the desired
accuracy \( \epsilon \).

<p>
<b>a)</b>
Make a Python function <code>adaptive_trapezint(f, a, b, eps=1E-5)</code>
for computing the integral \( \int_a^b f(x)dx \) with an error
less than or equal to \( \epsilon \) (<code>eps</code>).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_13_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_13_1">

<p>
Compute the \( n \) corresponding to \( \epsilon \) as explained above and
call <code>trapezint(f, a, b, n)</code> from <a href="#sec:basic:ex38">Exercise 11: Integrate a function by the Trapezoidal rule</a>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>b)</b>
Apply the function to compute the integrals from
<a href="#sec:basic:ex38">Exercise 11: Integrate a function by the Trapezoidal rule</a>b.
Write out the exact error and the estimated \( n \) for each case.

<p>
Filename: <code>adaptive_trapezint</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec55" class="anchor">Remarks </h3>

<p>
A numerical method that applies an expression for the error to
adapt the choice of the discretization parameter to a desired
error tolerance, is known as an <em>adaptive</em> numerical method.
The advantage of an adaptive method is that one can control
the approximation error, and there is no need for the user
to determine an appropriate number of intervals \( n \).

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex:locglob" class="anchor">Exercise 14: Simulate a program by hand</h2>

<p>
Simulate the following program by hand to explain what is printed.

<p>

<iframe width="950" height="500" frameborder="0"
        src="http://pythontutor.com/iframe-embed.html#code=def+a%28x%29%3A%0A++++q+%3D+2%0A++++x+%3D+3%2Ax%0A++++return+q+%2B+x%0A%0Adef+b%28x%29%3A%0A++++global+q%0A++++q+%2B%3D+x%0A++++return+q+%2B+x%0A%0Aq+%3D+0%0Ax+%3D+3%0Aprint+a%28x%29%2C+b%28x%29%2C+a%28x%29%2C+b%28x%29&curInstr=0&py=2&cumulative=false">
</iframe>
<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_14_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_14_1">

<p>
If you encounter problems with understanding function calls and local versus
global variables, paste the code into the
<a href="http://www.pythontutor.com/visualize.html" target="_self">Online Python Tutor</a> and
step through the code to get a better explanation of what happens.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>simulate_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex:testfunc2" class="anchor">Exercise 15: Debug a given test function</h2>

<p>
Given a Python function

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">triple</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x <span style="color: #666666">+</span> x<span style="color: #666666">*2</span>
</pre></div>
<p>
we want to test it with a proper test function. The following
function is written

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_triple</span>():
    <span style="color: #008000; font-weight: bold">assert</span> triple(<span style="color: #666666">3</span>) <span style="color: #666666">==</span> <span style="color: #666666">9</span>
    <span style="color: #008000; font-weight: bold">assert</span> triple(<span style="color: #666666">0.1</span>) <span style="color: #666666">==</span> <span style="color: #666666">0.3</span>
    <span style="color: #008000; font-weight: bold">assert</span> triple([<span style="color: #666666">1</span>, <span style="color: #666666">2</span>]) <span style="color: #666666">==</span> [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">1</span>, <span style="color: #666666">2</span>]
    <span style="color: #008000; font-weight: bold">assert</span> triple(<span style="color: #BA2121">&#39;hello &#39;</span>) <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;hello hello 2&#39;</span>
</pre></div>
<p>
What is wrong with the test function? Write a test function
where all boolean comparisons work well.
Filename: <code>test_triple</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex25" class="anchor">Exercise 16: Compute the area of an arbitrary triangle</h2>

<p>
An arbitrary triangle can be described by the coordinates of its
three vertices: \( (x_1,y_1) \), \( (x_2,y_2) \), \( (x_3, y_3) \), numbered in
a counterclockwise direction.
The area of the triangle is given by the formula

$$
\begin{equation}
A=\frac{1}{2}\left\vert x_2y_3 - x_3y_2 - x_1y_3 + x_3y_1 + x_1y_2 - x_2y_1\right\vert
\tp
\tag{15}
\end{equation}
$$

Write a function <code>triangle_area(vertices)</code> that returns the area of a triangle
whose vertices are specified by the argument <code>vertices</code>, which is
a nested list of the vertex coordinates. Make sure your
implementation passes the following test function, which also illustrates
how the <code>triangle_area</code> function works:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_triangle_area</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Verify the area of a triangle with vertex coordinates</span>
<span style="color: #BA2121; font-style: italic">    (0,0), (1,0), and (0,2).</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    v1 <span style="color: #666666">=</span> (<span style="color: #666666">0</span>,<span style="color: #666666">0</span>);  v2 <span style="color: #666666">=</span> (<span style="color: #666666">1</span>,<span style="color: #666666">0</span>);  v3 <span style="color: #666666">=</span> (<span style="color: #666666">0</span>,<span style="color: #666666">2</span>)
    vertices <span style="color: #666666">=</span> [v1, v2, v3]
    expected <span style="color: #666666">=</span> <span style="color: #666666">1</span>
    computed <span style="color: #666666">=</span> triangle_area(vertices)
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    success <span style="color: #666666">=</span> diff(expected <span style="color: #666666">-</span> computed) <span style="color: #666666">&lt;</span> tol
    msg <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;computed area=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121"> != </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121"> (expected)&#39;</span> <span style="color: #666666">%</span> \ 
          (computed, expected)
    <span style="color: #008000; font-weight: bold">assert</span> success, msg
</pre></div>
<p>
Filename: <code>area_triangle</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex25b" class="anchor">Exercise 17: Compute the length of a path</h2>

<p>
Some object is moving along a path in the plane. At \( n+1 \) points of time
we have recorded the corresponding \( (x,y) \) positions of the object:
\( (x_0,y_0) \), \( (x_1,y_2) \), \( \ldots \), \( (x_{n},y_{n}) \).
The total length \( L \) of the path from \( (x_0,y_0) \) to \( (x_{n},y_{n}) \)
is the sum of all the individual line segments (\( (x_{i-1},y_{i-1}) \)
to \( (x_{i},y_{i}) \), \( i=1,\ldots,n \)):

$$
\begin{equation}
L = \sum_{i=1}^{n} \sqrt{ (x_i-x_{i-1})^2 + (y_i - y_{i-1})^2}\tp
\tag{16}
\end{equation}
$$

<p>
<b>a)</b>
Make a Python function <code>pathlength(x, y)</code> for computing \( L \) according to
the formula. The arguments <code>x</code> and <code>y</code> hold all the
\( x_0,\ldots,x_{n} \) and \( y_0,\ldots,y_{n} \) coordinates, respectively.

<p>
<b>b)</b>
Write a test function <code>test_pathlength()</code> where you check that
<code>pathlength</code> returns the correct length in a test problem.

<p>
Filename: <code>pathlength</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex25c" class="anchor">Exercise 18: Approximate \( \pi \)</h2>

<p>
The value of \( \pi \) equals the circumference of a circle with radius \( 1/2 \).
Suppose we approximate the circumference by a polygon through \( n+1 \)
points on the circle. The length of this polygon can be found
using the <code>pathlength</code> function from
<a href="#sec:basic:ex25b">Exercise 17: Compute the length of a path</a>.
Compute \( n+1 \) points \( (x_i,y_i) \) along a circle with radius \( 1/2 \)
according to the formulas

$$
\begin{equation*}
x_i=\frac{1}{2}\cos (2\pi i /n),\quad
y_i=\frac{1}{2}\sin (2\pi i/n), \quad
i=0,\ldots,n\tp
\end{equation*}
$$

Call the <code>pathlength</code> function and write out the error in the
approximation of \( \pi \) for \( n=2^k \), \( k=2,3,\ldots,10 \).
Filename: <code>pi_approx</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:funcif:exer:area:polygon" class="anchor">Exercise 19: Compute the area of a polygon</h2>

<p>
One of the most important mathematical problems through all times has been
to find the area of a polygon. For example, real estate areas often
had the shape of polygons, and the tax was proportional to the area.
Suppose we have some polygon with
vertices (&quot;corners&quot;) specified by the coordinates
\( (x_1,y_1) \), \( (x_2,y_2) \),
\( \ldots \), \( (x_n, y_n) \), numbered either in a clockwise or
counter clockwise fashion around the polygon.
The area \( A \) of the polygon can amazingly be computed by just knowing the
boundary coordinates:
<!-- (see <a href="http://en.wikipedia.org/wiki/Shoelace_formula" target="_self">Wikipedia</a> for explanation): -->

$$
\begin{align}
A = \frac{1}{2}| & (x_1y_2+x_2y_3 + \cdots + x_{n-1}y_n + x_ny_1) -\nonumber\\ 
& (y_1x_2 + y_2x_3 + \cdots + y_{n-1}x_n + y_nx_1)|\thinspace .
\tag{17}
\end{align}
$$

Write a function <code>polygon_area(x, y)</code> that takes two coordinate lists
with the
vertices as arguments and returns the area.

<p>
Test the function on a triangle, a quadrilateral, and a pentagon where
you can calculate the area by alternative methods for comparison.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_19_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_19_1">

<p>
Since Python lists and arrays has 0 as their first index, it is wise to
rewrite the mathematical formula in terms of vertex coordinates numbered
as \( x_0,x_1,\ldots,x_{n-1} \) and \( y_0, y_1,\ldots,y_{n-1} \) before you
start programming.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>polygon_area</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex42a" class="anchor">Exercise 20: Write functions</h2>

<p>
Three functions, <code>hw1</code>, <code>hw2</code>, and <code>hw3</code>, work as follows:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> hw1()
Hello, World!
<span style="color: #666666">&gt;&gt;&gt;</span> hw2()
Hello, World!
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> hw3(<span style="color: #BA2121">&#39;Hello, &#39;</span>, <span style="color: #BA2121">&#39;World!&#39;</span>)
Hello, World!
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> hw3(<span style="color: #BA2121">&#39;Python &#39;</span>, <span style="color: #BA2121">&#39;function&#39;</span>)
Python function
</pre></div>
<p>
Write the three functions.
Filename: <code>hw_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:formula:ex10" class="anchor">Exercise 21: Approximate a function by a sum of sines</h2>

<p>
We consider the piecewise constant function

$$
\begin{equation}
\tag{18}
f(t) = \left\lbrace\begin{array}{ll}
1, & 0 < t < T/2,\\ 
0, & t = T/2,\\ 
-1, & T/2 < t < T
\end{array}\right.
\end{equation}
$$

Sketch this function on a piece of paper. One can approximate \( f(t) \)
by the sum

$$
\begin{equation}
S(t;n) = {4\over\pi}\sum_{i=1}^n {1\over 2i-1}
\sin\left( {2(2i-1)\pi t\over T}\right)\tp
\tag{19}
\end{equation}
$$

It can be shown that \( S(t;n)\rightarrow f(t) \) as \( n\rightarrow\infty \).

<p>
<b>a)</b>
Write a Python function <code>S(t, n, T)</code> for returning the value of \( S(t;n) \).

<p>
<b>b)</b>
Write a Python function <code>f(t, T)</code> for computing \( f(t) \).

<p>
<b>c)</b>
Write out tabular information showing how the error \( f(t) - S(t;n) \)
varies with \( n \) and \( t \) for the cases where
\( n=1,3,5,10,30,100 \) and \( t=\alpha T \), with \( T=2\pi \), and
\( \alpha =0.01, 0.25, 0.49 \). Use the table to comment on how the quality
of the approximation depends on \( \alpha \) and \( n \).

<p>
Filename: <code>sinesum1</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec64" class="anchor">Remarks </h3>

<p>
A sum of sine and/or cosine functions,
as in <a href="#mjx-eqn-19">(19)</a>, is called a <em>Fourier series</em>.
Approximating a function by a Fourier
series is a very important technique in science and technology.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex33" class="anchor">Exercise 22: Implement a Gaussian function</h2>

<p>
Make a Python function <code>gauss(x, m=0, s=1)</code> for computing
the Gaussian function

$$
\begin{equation*}
f(x) =
{1\over\sqrt{2\pi }\, s}
\exp{\left[-\frac{1}{2}\left({x-m\over s}\right)^2\right]}\tp
\end{equation*}
$$

Write out a nicely formatted table of \( x \) and \( f(x) \) values for \( n \)
uniformly spaced \( x \) values in \( [m-5s, m+5s] \). (Choose \( m \), \( s \), and
\( n \) as you like.)
Filename: <code>gaussian2</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex46" class="anchor">Exercise 23: Wrap a formula in a function</h2>

<p>
Implement the formula for cooking
an egg, see the exercise &quot;How to cook the perfect egg&quot; in the document
<a href="http://hplgit.github.io/primer.html/doc/pub/formulas" target="_self">Programming with formulas</a>,
in a Python function with three arguments:
<code>egg(M, To=20, Ty=70)</code>. The parameters \( \rho \), \( K \), \( c \), and \( T_w \) can
be set as local (constant) variables inside the function. Let \( t \) be
returned from the function.  Compute \( t \) for a soft and hard boiled
egg, of a small (\( M=47 \) g) and large (\( M=67 \) g) size, taken from the
fridge (\( T_o=4 \) C) and from a hot room (\( T_o=25 \) C).
Filename: <code>egg_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex38a" class="anchor">Exercise 24: Write a function for numerical differentiation</h2>

<p>
The formula

$$
\begin{equation} f'(x)\approx {f(x+h)-f(x-h)\over 2h} \tag{20}\end{equation}
$$

can be used to find an approximate derivative of a mathematical
function \( f(x) \) if \( h \) is small.

<p>
<b>a)</b>
Write a function <code>diff(f, x, h=1E-5)</code> that returns the approximation
<a href="#mjx-eqn-20">(20)</a>
of the derivative of a mathematical function represented by a Python
function <code>f(x)</code>.

<p>
<b>b)</b>
Write a function <code>test_diff()</code> that verifies the implementation
of the function <code>diff</code>. As test case, one can use the fact that
<a href="#mjx-eqn-20">(20)</a> is exact for quadratic functions (at least
for not so small \( h \) values that rounding errors in
<a href="#mjx-eqn-20">(20)</a> become significant - you have to
experiment with finding a suitable tolerance and \( h \)).
Follow the conventions of the pytest and nose testing
frameworks.

<p>
<b>c)</b>
Apply <a href="#mjx-eqn-20">(20)</a> to differentiate

<ul>
 <li> \( f(x)=e^x \) at \( x=0 \),</li>
 <li> \( f(x)=e^{-2x^2} \) at \( x=0 \),</li>
 <li> \( f(x)=\cos x \) at \( x=2\pi \),</li>
 <li> \( f(x)=\ln x \) at \( x=1 \).</li>
</ul>

Use \( h=0.01 \). In each case, write out the error,
i.e., the difference between the exact derivative and the result of
<a href="#mjx-eqn-20">(20)</a>. Collect these four examples in a function
<code>application()</code>.

<p>
Filename: <code>centered_diff</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex35" class="anchor">Exercise 25: Implement the factorial function</h2>

<p>
The factorial of \( n \) is written as \( n! \) and defined as

$$
\begin{equation}
n! = n(n-1)(n-2)\cdots 2\cdot 1,
\tag{21}
\end{equation}
$$

with the special cases

$$
\begin{equation}
1! = 1,\quad 0! = 1\tp
\tag{22}
\end{equation}
$$

For example, \( 4! = 4\cdot 3\cdot 2\cdot 1 = 24 \), and \( 2! = 2\cdot 1 = 2 \).
Write a Python function <code>fact(n)</code> that returns \( n! \).
(Do not simply call the ready-made function
<code>math.factorial(n)</code> - that is considered cheating in this context!)

<p>
Make sure your <code>fact</code> function passes the test in the following
test function:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_fact</span>():
    <span style="color: #408080; font-style: italic"># Check an arbitrary case</span>
    n <span style="color: #666666">=</span> <span style="color: #666666">4</span>
    expected <span style="color: #666666">=</span> <span style="color: #666666">4*3*2*1</span>
    computed <span style="color: #666666">=</span> fact(n)
    <span style="color: #008000; font-weight: bold">assert</span> computed <span style="color: #666666">==</span> expected
    <span style="color: #408080; font-style: italic"># Check the special cases</span>
    <span style="color: #008000; font-weight: bold">assert</span> fact(<span style="color: #666666">0</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">assert</span> fact(<span style="color: #666666">1</span>) <span style="color: #666666">==</span> <span style="color: #666666">1</span>
</pre></div>
<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_25_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_25_1">

<p>
Return 1 immediately if \( x \) is 1 or 0, otherwise use a loop to compute \( n! \).

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>fact</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29q" class="anchor">Exercise 26: Compute velocity and acceleration from 1D position data</h2>

<p>
Suppose we have recorded GPS coordinates \( x_0,\ldots,x_n \) at times
\( t_0,\ldots,t_n \) while running or driving along a straight road.  We
want to compute the velocity \( v_i \) and acceleration \( a_i \) from these
position coordinates. Using finite difference approximations, one
can establish the formulas

$$
\begin{align}
v_i &\approx \frac{x_{i+1}-x_{i-1}}{t_{i+1}-t_{i-1}},
\tag{23}\\ 
a_i &\approx
2(t_{i+1}-t_{i-1})^{-1}\left(\frac{x_{i+1}-x_{i}}{t_{i+1}-t_i} -
\frac{x_{i}-x_{i-1}}{t_{i}-t_{i-1}}\right),
\tag{24}
\end{align}
$$

for \( i=1,\ldots,n-1 \) (\( v_i \) and \( a_i \)
correspond to the velocity and acceleration at point \( x_i \) at
time \( t_i \), respectively).

<p>
<b>a)</b>
Write a Python function <code>kinematics(i, x, t)</code> for computing \( v_i \)
and \( a_i \), given the arrays <code>x</code> and <code>t</code> of position and time coordinates
(\( x_0,\ldots,x_n \) and \( t_0,\ldots,t_n \)).

<p>
<b>b)</b>
Write a Python function <code>test_kinematics()</code> for testing the
implementation in the case of constant velocity \( V \).
Set \( t_0=0 \), \( t_1=0.5 \), \( t_2=1.5 \), and \( t_3=2.2 \),
and \( x_i = Vt_i \). Call the <code>kinematics</code> function for the legal \( i \) values.

<p>
Filename: <code>kinematics1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29g" class="anchor">Exercise 27: Find the max and min values of a function</h2>

<p>
The maximum and minimum values of a mathematical function \( f(x) \)
on \( [a,b] \) can be found by computing \( f \) at a large number (\( n \)) of
points and selecting the maximum and minimum values at these points.
Write a Python function <code>maxmin(f, a, b, n=1000)</code> that returns
the maximum and minimum value of a function <code>f(x)</code>. Also write a
test function for verifying the implementation for
\( f(x) = \cos x \), \( x\in [-\pi/2, 2\pi] \).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_27_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_27_1">

<p>
The \( x \) points where the mathematical function is to be evaluated
can be uniformly distributed: \( x_i = a + ih \), \( i=0,\ldots,n-1 \),
\( h = (b-a)/(n-1) \).  The Python functions <code>max(y)</code> and <code>min(y)</code>
return the maximum and minimum values in the list <code>y</code>, respectively.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>maxmin_f</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29g2" class="anchor">Exercise 28: Find the max and min elements in a list</h2>

<p>
Given a list <code>a</code>, the <code>max</code> function in Python's standard
library computes the largest element in <code>a</code>: <code>max(a)</code>.
Similarly, <code>min(a)</code> returns the smallest element in <code>a</code>.
Write your own <code>max</code> and <code>min</code> functions.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_28_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_28_1">

<p>
Initialize a variable <code>max_elem</code>
by the first element in the list, then visit all the remaining elements
(<code>a[1:]</code>), compare each element to <code>max_elem</code>, and if
greater, set <code>max_elem</code> equal to that element.
Use a similar technique to compute the minimum element.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>maxmin_list</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:exH1" class="anchor">Exercise 29: Implement the Heaviside function</h2>

<p>
The following <em>step function</em> is known as the
<em>Heaviside function</em> and is
widely used in mathematics:

$$
\begin{equation}
H(x) = \left\lbrace\begin{array}{ll}
0, & x < 0\\ 
1, & x\geq 0
\end{array}\right.
\tag{25}
\end{equation}
$$

<p>
<b>a)</b>
Implement \( H(x) \) in a Python function <code>H(x)</code>.

<p>
<b>b)</b>
Make a Python function <code>test_H()</code> for testing the implementation of <code>H(x)</code>.
Compute \( H(-10) \), \( H(-10^{-15}) \), \( H(0) \), \( H(10^{-15}) \),
\( H(10) \) and test that the answers are correct.

<p>
Filename: <code>Heaviside</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:exH2" class="anchor">Exercise 30: Implement a smoothed Heaviside function</h2>

<p>
The Heaviside function <a href="#mjx-eqn-25">(25)</a> listed in
<a href="#sec:basic:exH1">Exercise 29: Implement the Heaviside function</a> is discontinuous. It is in many
numerical applications advantageous to work with a smooth version of
the Heaviside function where the function itself and its first
derivative are continuous. One such smoothed Heaviside function
is

$$
\begin{equation}
H_{\epsilon}(x) = \left\lbrace
\begin{array}{ll}
0, &  x < -\epsilon,\\ 
\frac{1}{2} + {x\over 2\epsilon} + {1\over 2\pi}\sin\left(\pi x\over\epsilon\right), & -\epsilon \leq x \leq \epsilon\\ 
1, & x > \epsilon
\end{array}\right.
\tag{26}
\end{equation}
$$

<p>
<b>a)</b>
Implement \( H_{\epsilon}(x) \) in a Python function <code>H_eps(x, eps=0.01)</code>.

<p>
<b>b)</b>
Make a Python function <code>test_H_eps()</code> for testing the implementation
of <code>H_eps</code>. Check the values of some \( x < -\epsilon \), \( x=-\epsilon \),
\( x=0 \), \( x=\epsilon \), and some \( x>\epsilon \).

<p>
Filename: <code>smoothed_Heaviside</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:exH3" class="anchor">Exercise 31: Implement an indicator function</h2>

<p>
In many applications there is need for an indicator function, which is
1 over some interval and 0 elsewhere. More precisely, we define

$$
\begin{equation}
I(x;L,R) = \left\lbrace\begin{array}{ll}
1, & x\in [L,R],\\ 
0, & \hbox{elsewhere}
\end{array}\right.
\tag{27}
\end{equation}
$$

<p>
<b>a)</b>
Make two Python implementations of such an indicator function,
one with a direct test if \( x\in [L,R] \) and one that expresses
the indicator function in terms of Heaviside functions
<a href="#mjx-eqn-25">(25)</a>:

$$
\begin{equation} I(x;L,R) = H(x-L)H(R-x)
\tag{28}
\tp
\end{equation}
$$

<p>
<b>b)</b>
Make a test function for verifying the implementation of the
functions in a). Check that correct values are returned for
some \( x < L \), \( x=L \), \( x=(L+R)/2 \), \( x=R \), and some \( x>R \).

<p>
Filename: <code>indicator_func</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:exH4" class="anchor">Exercise 32: Implement a piecewise constant function</h2>

<p>
Piecewise constant functions have a lot of important applications
when modeling physical phenomena by mathematics. A piecewise
constant function can be defined as

$$
\begin{equation}
f(x) = \left\lbrace\begin{array}{ll}
v_0, & x\in [x_0, x_1),\\ 
v_1, & x\in [x_1, x_2),\\ 
\vdots &\\ 
v_i & x\in [x_i, x_{i+1}),\\ 
\vdots &\\ 
v_n & x\in [x_n, x_{n+1}]
\end{array}\right.
\tag{29}
\end{equation}
$$

That is, we have a union of non-overlapping intervals covering the
domain \( [x_0,x_{n+1}] \), and \( f(x) \) is constant in each interval.
One example is the function that is -1 on \( [0,1] \), 0 on \( [1,1.5] \),
and 4 on \( [1.5,2] \), where we with the notation in
<a href="#mjx-eqn-29">(29)</a> have \( x_0=0, x_1=1, x_2=1.5, x_3=2 \)
and \( v_0=-1, v_1=0, v_3=4 \).

<p>
<b>a)</b>
Make a Python function <code>piecewise(x, data)</code> for evaluating a piecewise
constant mathematical function as in <a href="#mjx-eqn-29">(29)</a>
at the point <code>x</code>. The <code>data</code> object is a list of pairs \( (v_i,x_i) \) for
\( i=0,\ldots,n \). For example, <code>data</code> is <code>[(0, -1), (1, 0), (1.5, 4)]</code>
in the example listed above. Since \( x_{n+1} \) is not a part of the
<code>data</code> object, we have no means for detecting whether <code>x</code> is to the
right of the last interval \( [x_n, x_{n+1}] \), i.e., we must assume that
the user of the <code>piecewise</code> function sends in an \( x\leq x_{n+1} \).

<p>
<b>b)</b>
Design suitable test cases for the function <code>piecewise</code> and
implement them in a test function <code>test_piecewise()</code>.

<p>
Filename: <code>piecewise_constant1</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:exH4b" class="anchor">Exercise 33: Apply indicator functions</h2>

<p>
Implement
piecewise constant functions, as defined in <a href="#sec:basic:exH4">Exercise 32: Implement a piecewise constant function</a>,
by observing that

$$
\begin{equation}
f(x) = \sum_{i=0}^n v_i I(x; x_{i}, x_{i+1}),
\tag{30}
\end{equation}
$$

where \( I(x; x_{i}, x_{i+1}) \) is the indicator function
from <a href="#sec:basic:exH3">Exercise 31: Implement an indicator function</a>.
Filename: <code>piecewise_constant2</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex49" class="anchor">Exercise 34: Test your understanding of branching</h2>

<p>
Consider the following code:

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">where1</span>(x, y):
    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;quadrant I or IV&#39;</span>
    <span style="color: #008000; font-weight: bold">if</span> y <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;quadrant I or II&#39;</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">where2</span>(x, y):
    <span style="color: #008000; font-weight: bold">if</span> x <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;quadrant I or IV&#39;</span>
    <span style="color: #008000; font-weight: bold">elif</span> y <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;quadrant II&#39;</span>

<span style="color: #008000; font-weight: bold">for</span> x, y <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>), (<span style="color: #666666">1</span>, <span style="color: #666666">1</span>):
    where1(x,y)
    where2(x,y)
</pre></div>
<p>
What is printed?
Filename: <code>simulate_branching</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex40" class="anchor">Exercise 35: Simulate nested loops by hand</h2>

<p>
Go through the code below by hand, statement by statement, and calculate the
numbers that will be printed.

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>n <span style="color: #666666">=</span> <span style="color: #666666">3</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">-1</span>, n):
    <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
        <span style="color: #008000; font-weight: bold">print</span> i

<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #666666">13</span>, <span style="color: #666666">2*</span>n):
    <span style="color: #008000; font-weight: bold">for</span> j <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n):
        <span style="color: #008000; font-weight: bold">print</span> i, j

<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n<span style="color: #666666">+1</span>):
    <span style="color: #008000; font-weight: bold">for</span> j <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(i):
        <span style="color: #008000; font-weight: bold">if</span> j:
            <span style="color: #008000; font-weight: bold">print</span> i, j

<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #666666">13</span>, <span style="color: #666666">2*</span>n):
    <span style="color: #008000; font-weight: bold">for</span> j <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, i, <span style="color: #666666">2</span>):
        <span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">2</span>, j, <span style="color: #666666">1</span>):
            b <span style="color: #666666">=</span> i <span style="color: #666666">&gt;</span> j <span style="color: #666666">&gt;</span> k
            <span style="color: #008000; font-weight: bold">if</span> b:
                <span style="color: #008000; font-weight: bold">print</span> i, j, k
</pre></div>
<p>
You may use a debugger,
or the <a href="http://www.pythontutor.com/" target="_self">Online Python Tutor</a>,
see the section <a href="._funcif-bootstrap001.html#sec:basic:pot">Understanding the program flow</a>,
to control what happens when you step through the code.
Filename: <code>simulate_nested_loops</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29f" class="anchor">Exercise 36: Rewrite a mathematical function</h2>

<p>
We consider the \( L(x;n) \) sum as defined in the section <a href="._funcif-bootstrap001.html#sec:basic:sum">Computing sums</a>
and the corresponding function <code>L3(x, epsilon)</code> function from the section <a href="._funcif-bootstrap001.html#sec:basic:kwargs">Keyword arguments</a>.  The sum \( L(x;n) \) can be written as

$$
\begin{equation*} L(x;n) = \sum_{i=1}^n c_i, \quad c_i = {1\over i}\left( {x\over 1+x}\right)^{i}\tp\end{equation*}
$$

<p>
<b>a)</b>
Derive a relation between \( c_{i} \) and \( c_{i-1} \),

$$
\begin{equation*} c_{i} = ac_{i-1},\end{equation*}
$$

where \( a \) is an expression involving \( i \) and \( x \).

<p>
<b>b)</b>
The relation \( c_{i}=ac_{i-1} \)
means that we can start with <code>term</code> as \( c_1 \), and then
in each pass  of the loop implementing the sum \( \sum_i c_i \) we
can compute the next term \( c_i \) in the sum as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>term <span style="color: #666666">=</span> a<span style="color: #666666">*</span>term
</pre></div>
<p>
Write a new version of the <code>L3</code> function, called <code>L3_ci(x, epsilon)</code>,
that makes use of this alternative computation of the terms in the sum.

<p>
<b>c)</b>
Write a Python function <code>test_L3_ci()</code> that verifies the implementation
of <code>L3_ci</code> by comparing with the original <code>L3</code> function.

<p>
Filename: <code>L3_recursive</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex29e" class="anchor">Exercise 37: Make a table for approximations of \( \cos x \)</h2>

<p>
The function \( \cos (x) \) can be approximated by the sum

$$
\begin{equation}
C(x;n) = \sum_{j=0}^n c_j,
\tag{31}
\end{equation}
$$

where

$$
\begin{equation*} c_j = -c_{j-1}{x^2\over 2j(2j-1)},\quad j=1,2,\ldots, n,\end{equation*}
$$

and \( c_0=1 \).

<p>
<b>a)</b>
Make a Python function for computing \( C(x;n) \).

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_37_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_37_1">

<p>
Represent \( c_j \) by a variable <code>term</code>, make updates <code>term = -term*...</code>
inside a <code>for</code> loop, and accumulate the <code>term</code> variable in a variable
for the sum.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->

<p>
<b>b)</b>
Make a function for writing out a table of the errors in
the approximation
\( C(x;n) \) of \( \cos (x) \) for some \( x \) and \( n \) values given as
arguments to the function. Let the \( x \) values run downward in the
rows and the \( n \) values to the right in the columns.
For example, a table for \( x=4\pi,6\pi,8\pi,10\pi \) and \( n=5, 25, 50, 100, 200 \)
can look like

<p>

<!-- code=text (!bc ccq) typeset with pygments style "default" -->
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>     x          5         25         50        100        200
   12.5664   1.61e+04   1.87e-11   1.74e-12   1.74e-12   1.74e-12
   18.8496   1.22e+06   2.28e-02   7.12e-11   7.12e-11   7.12e-11
   25.1327   2.41e+07   6.58e+04  -4.87e-07  -4.87e-07  -4.87e-07
   31.4159   2.36e+08   6.52e+09   1.65e-04   1.65e-04   1.65e-04
</pre></div>
</blockquote><p>
Observe how the error increases with \( x \) and decreases with \( n \).

<p>
Filename: <code>cos_sum</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex31b" class="anchor">Exercise 38: Use None in keyword arguments</h2>

<p>
Consider the functions <code>L2(x, n)</code> and <code>L3(x, epsilon)</code> from the sections <a href="._funcif-bootstrap001.html#sec:basic:sum">Computing sums</a> and
<a href="._funcif-bootstrap001.html#sec:basic:kwargs">Keyword arguments</a>, whose program code is found in the file
<a href="http://tinyurl.com/pwyasaa/funcif/lnsum.py" target="_self"><tt>lnsum.py</tt></a>.

<p>
Make a more flexible function <code>L4</code> where we can either specify a
tolerance <code>epsilon</code> <em>or</em> a number of terms <code>n</code> in the sum. Moreover,
we can also choose whether we want the sum to be returned or the sum
and the number of terms:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>value, n <span style="color: #666666">=</span> L4(x, epsilon<span style="color: #666666">=1E-8</span>, return_n<span style="color: #666666">=</span><span style="color: #008000">True</span>)
value <span style="color: #666666">=</span> L4(x, n<span style="color: #666666">=100</span>)
</pre></div>
<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_38_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_38_1">

<p>
The starting point for all this flexibility is to have some keyword
arguments initialized to an &quot;undefined&quot; value, called <code>None</code>, which can be
recognized inside the function:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">L3</span>(x, n<span style="color: #666666">=</span><span style="color: #008000">None</span>, epsilon<span style="color: #666666">=</span><span style="color: #008000">None</span>, return_n<span style="color: #666666">=</span><span style="color: #008000">False</span>):
    <span style="color: #008000; font-weight: bold">if</span> n <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">if</span> epsilon <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #666666">...</span>
</pre></div>
<p>
One can also apply <code>if n != None</code>, but the <code>is</code> operator is most common.

<p>
Print error messages for incompatible values when <code>n</code> <em>and</em>
<code>epsilon</code> are <code>None</code> or both are given by the user.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>L4</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex28" class="anchor">Exercise 39: Write a sort function for a list of 4-tuples</h2>

<p>
<!-- <a href="http://www.astrosociety.org/education/publications/tnl/05/05.html" target="_self"><tt>http://www.astrosociety.org/education/publications/tnl/05/05.html</tt></a> -->

<p>
Below is a list of the nearest stars and some of their properties.
The list elements are 4-tuples containing the name of the star, the
distance from the sun in light years, the apparent brightness, and the
luminosity.  The apparent brightness is how bright the stars look in
our sky compared to the brightness of Sirius A. The luminosity, or the
true brightness, is how bright the stars would look if all were at the
same distance compared to the Sun.  The list data are found in the
file <a href="http://tinyurl.com/pwyasaa/funcif/stars.txt" target="_self"><tt>stars.txt</tt></a>, which looks as
follows:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> [
(<span style="color: #BA2121">&#39;Alpha Centauri A&#39;</span>,    <span style="color: #666666">4.3</span>,  <span style="color: #666666">0.26</span>,      <span style="color: #666666">1.56</span>),
(<span style="color: #BA2121">&#39;Alpha Centauri B&#39;</span>,    <span style="color: #666666">4.3</span>,  <span style="color: #666666">0.077</span>,     <span style="color: #666666">0.45</span>),
(<span style="color: #BA2121">&#39;Alpha Centauri C&#39;</span>,    <span style="color: #666666">4.2</span>,  <span style="color: #666666">0.00001</span>,   <span style="color: #666666">0.00006</span>),
(<span style="color: #BA2121">&quot;Barnard&#39;s Star&quot;</span>,      <span style="color: #666666">6.0</span>,  <span style="color: #666666">0.00004</span>,   <span style="color: #666666">0.0005</span>),
(<span style="color: #BA2121">&#39;Wolf 359&#39;</span>,            <span style="color: #666666">7.7</span>,  <span style="color: #666666">0.000001</span>,  <span style="color: #666666">0.00002</span>),
(<span style="color: #BA2121">&#39;BD +36 degrees 2147&#39;</span>, <span style="color: #666666">8.2</span>,  <span style="color: #666666">0.0003</span>,    <span style="color: #666666">0.006</span>),
(<span style="color: #BA2121">&#39;Luyten 726-8 A&#39;</span>,      <span style="color: #666666">8.4</span>,  <span style="color: #666666">0.000003</span>,  <span style="color: #666666">0.00006</span>),
(<span style="color: #BA2121">&#39;Luyten 726-8 B&#39;</span>,      <span style="color: #666666">8.4</span>,  <span style="color: #666666">0.000002</span>,  <span style="color: #666666">0.00004</span>),
(<span style="color: #BA2121">&#39;Sirius A&#39;</span>,            <span style="color: #666666">8.6</span>,  <span style="color: #666666">1.00</span>,      <span style="color: #666666">23.6</span>),
(<span style="color: #BA2121">&#39;Sirius B&#39;</span>,            <span style="color: #666666">8.6</span>,  <span style="color: #666666">0.001</span>,     <span style="color: #666666">0.003</span>),
(<span style="color: #BA2121">&#39;Ross 154&#39;</span>,            <span style="color: #666666">9.4</span>,  <span style="color: #666666">0.00002</span>,   <span style="color: #666666">0.0005</span>),
]
</pre></div>
<p>
The purpose of this exercise is to sort this list with respect to
distance, apparent brightness, and luminosity.  Write a program that
initializes the <code>data</code> list as above and writes out three sorted
tables: star name versus distance, star name versus apparent
brightness, and star name versus luminosity.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_39_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_39_1">

<p>
To sort a list <code>data</code>, one can call <code>sorted(data)</code>, as in

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">for</span> item <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">sorted</span>(data):
    <span style="color: #666666">...</span>
</pre></div>
<p>
However, in the present case each element is a 4-tuple, and the
default sorting of such 4-tuples results in a list with the stars
appearing in alphabetic order.  This is not what you want. Instead, we
need to sort with respect to the 2nd, 3rd, or 4th element of each
4-tuple. If such a tailored sort mechanism is necessary, we can
provide our own sort function as an argument to <code>sorted</code>. There
are two alternative ways of doing this.

<p>
<b>A comparison function.</b>

<p>
A sort user-provided
sort function <code>mysort(a, b)</code> must take two
arguments <code>a</code> and <code>b</code> and return \( -1 \) if <code>a</code> should become
before <code>b</code> in the sorted sequence, 1 if <code>b</code> should become before <code>a</code>,
and 0 if they are equal.  In the present case, <code>a</code> and <code>b</code> are
4-tuples, so we need to make the comparison between the right elements
in <code>a</code> and <code>b</code>.  For example, to sort with respect to luminosity we
can write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mysort</span>(a, b):
    <span style="color: #008000; font-weight: bold">if</span> a[<span style="color: #666666">3</span>] <span style="color: #666666">&lt;</span> b[<span style="color: #666666">3</span>]:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">-1</span>
    <span style="color: #008000; font-weight: bold">elif</span> a[<span style="color: #666666">3</span>] <span style="color: #666666">&gt;</span> b[<span style="color: #666666">3</span>]:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">1</span>
    <span style="color: #008000; font-weight: bold">else</span>:
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>
</pre></div>
<p>
The relevant call using this tailored sort function is

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">sorted</span>(data, <span style="color: #008000">cmp</span><span style="color: #666666">=</span>mysort)
</pre></div>
<p>
<b>A key function.</b>
A quicker construction is to provide a <code>key</code> argument to <code>sorted</code>
for filtering out the relevant part of an object to be sorted.
Here, we want to sort 4-tuples, but use only one of the elements,
say the one with index 3, for comparison. Writing

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">sorted</span>(data, key<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> obj: obj[<span style="color: #666666">3</span>])
</pre></div>
<p>
will send all objects (4-tuples) through the <code>key</code> function whose
return value
is used for the sorting.
A lambda construction (see the section <a href="._funcif-bootstrap001.html#sec:basic:lambdafunc">Lambda functions</a>)
is used to write the filtering function inline.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>sorted_stars_data</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex37" class="anchor">Exercise 40: Find prime numbers</h2>

<p>
The <em>Sieve of Eratosthenes</em> is an algorithm for finding all prime
numbers less than or equal to a number \( N \). Read about this algorithm
on Wikipedia and implement it in a Python program.
Filename: <code>find_primes</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:input:ex35" class="anchor">Exercise 41: Resolve a problem with a function</h2>

<p>
Consider the following interactive session:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">0</span> <span style="color: #666666">&lt;=</span> x <span style="color: #666666">&lt;=</span> <span style="color: #666666">2</span>:
<span style="color: #666666">...</span>         <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**2</span>
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #666666">2</span> <span style="color: #666666">&lt;</span> x <span style="color: #666666">&lt;=</span> <span style="color: #666666">4</span>:
<span style="color: #666666">...</span>         <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">4</span>
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">elif</span> x <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
<span style="color: #666666">...</span>         <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> f(<span style="color: #666666">2</span>)
<span style="color: #666666">4</span>
<span style="color: #666666">&gt;&gt;&gt;</span> f(<span style="color: #666666">5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> f(<span style="color: #666666">10</span>)
</pre></div>
<p>
Why do we not get any output when calling <code>f(5)</code> and <code>f(10)</code>?

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_41_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_41_1">

<p>
Save the <code>f</code> value in a variable <code>r</code> and do <code>print r</code>.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>fix_branching</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex20" class="anchor">Exercise 42: Determine the types of some objects</h2>

<p>
Consider the following calls to
the <code>makelist</code> function from the section <a href="._funcif-bootstrap001.html#sec:basic:makelist">Beyond mathematical functions</a>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>l1 <span style="color: #666666">=</span> makelist(<span style="color: #666666">0</span>, <span style="color: #666666">100</span>, <span style="color: #666666">1</span>)
l2 <span style="color: #666666">=</span> makelist(<span style="color: #666666">0</span>, <span style="color: #666666">100</span>, <span style="color: #666666">1.0</span>)
l3 <span style="color: #666666">=</span> makelist(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0.1</span>)
l4 <span style="color: #666666">=</span> makelist(<span style="color: #666666">10</span>, <span style="color: #666666">20</span>, <span style="color: #666666">20</span>)
l5 <span style="color: #666666">=</span> makelist([<span style="color: #666666">1</span>,<span style="color: #666666">2</span>], [<span style="color: #666666">3</span>,<span style="color: #666666">4</span>], [<span style="color: #666666">5</span>])
l6 <span style="color: #666666">=</span> makelist((<span style="color: #666666">1</span>,<span style="color: #666666">-1</span>,<span style="color: #666666">1</span>), (<span style="color: #BA2121">&#39;myfile.dat&#39;</span>, <span style="color: #BA2121">&#39;yourfile.dat&#39;</span>))
l7 <span style="color: #666666">=</span> makelist(<span style="color: #BA2121">&#39;myfile.dat&#39;</span>, <span style="color: #BA2121">&#39;yourfile.dat&#39;</span>, <span style="color: #BA2121">&#39;herfile.dat&#39;</span>)
</pre></div>
<p>
Simulate each call by hand to determine what type of objects that
become elements in the returned list and what the contents of <code>value</code>
is after one pass in the loop.

<p>
<!-- --- begin hint in exercise --- -->

<p>
<a class="glyphicon glyphicon-hand-right showdetails" data-toggle="collapse"
 data-target="#exer_42_1" style="font-size: 80%;"></a>
<b>Hint.</b>
<div class="collapse-group">
<p><div class="collapse" id="exer_42_1">

<p>
Note that some of the calls will lead to infinite loops
if you really perform the above <code>makelist</code> calls on a computer.

<p>
You can go to the <a href="http://www.pythontutor.com/" target="_self">Online Python Tutor</a>, paste in the <code>makelist</code> function and
the session above, and step through the program to see what actually
happens.

<p>
</div></p>
</div>
</p>

<p>
<!-- --- end hint in exercise --- -->
Filename: <code>find_object_type</code>.

<p>
<!-- Closing remarks for this Exercise -->

<h3 id="___sec86" class="anchor">Remarks </h3>

<p>
This exercise demonstrates that we can write a function and have in mind
certain types of arguments, here typically <code>int</code> and <code>float</code>
objects. However, the function can be used with other (originally unintended)
arguments, such as lists and strings
in the present case, leading to strange and
irrelevant behavior (the problem here lies in the boolean expression
<code>value &lt;= stop</code> which is meaningless for some of the arguments).

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="sec:basic:ex34" class="anchor">Exercise 43: Find an error in a program</h2>

<p>
For the formula

$$
\begin{equation*} f(x)= e^{rx}\sin(mx) + e^{sx}\sin(nx)\end{equation*}
$$

we have made the program

<p>

<iframe width="950" height="500" frameborder="0"
        src="http://pythontutor.com/iframe-embed.html#code=def+f%28x%2C+m%2C+n%2C+r%2C+s%29%3A%0A++++return+expsin%28x%2C+r%2C+m%29+%2B+expsin%28x%2C+s%2C+n%29%0A%0Ax+%3D+2.5%0Aprint+f%28x%2C+0.1%2C+0.2%2C+1%2C+1%29%0A%0Afrom+math+import+exp%2C+sin%0A%0Adef+expsin%28x%2C+p%2C+q%29%3A%0A++++return+exp%28p%2Ax%29%2Asin%28q%2Ax%29&curInstr=0&py=2&cumulative=false">
</iframe>
<p>
Running this code results in

<p>

<!-- code=text (!bc ccq) typeset with pygments style "default" -->
<blockquote>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>NameError: global name &#39;expsin&#39; is not defined
</pre></div>
</blockquote><p>
What is the problem? Simulate the program flow by hand, use the
debugger to step from line to line, or use the Online Python Tutor.
Correct the program.
Filename: <code>find_error_undef</code>.

<p>
<!-- --- end exercise --- -->

<h1 id="___sec88" class="anchor">References </h1>

<p>
<!-- begin bibliography -->

<ol>
 <li> <div id="Langtangen_TCSE6_debug"></div> <b>H. P. Langtangen</b>. 
    Debugging in Python,
    \emphhttp://hplgit.github.io/primer.html/doc/pub/debug,
    <a href="http://hplgit.github.io/primer.html/doc/pub/debug" target="_self"><tt>http://hplgit.github.io/primer.html/doc/pub/debug</tt></a>.</li>
 <li> <div id="TCSE3"></div> <b>H. P. Langtangen</b>. 
    <em>Python Scripting for Computational Science</em>,
    3rd edition,
    <em>Texts in Computational Science and Engineering</em>,
    Springer,
    2009.</li>
</ol>

<!-- end bibliography -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._funcif-bootstrap003.html">&larr; Prev</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

